<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Trade Report - Professional Market Analysis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        html, body {
            font-family: 'Times New Roman', serif;
            font-size: 12pt;
            line-height: 1.5;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
            width: 100%;
            min-width: 100%;
            box-sizing: border-box;
        }
        .container {
            width: 100vw;
            min-width: 100%;
            margin: 0;
            background: white;
            padding: 40px;
            border-radius: 0;
            box-shadow: none;
            box-sizing: border-box;
        }
        h1 {
            color: #2c3e50;
            font-weight: bold;
            font-size: 18pt;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        h2 {
            color: #34495e;
            font-weight: bold;
            font-size: 16pt;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 30px;
            margin-bottom: 20px;
        }
        h3 {
            color: #2c3e50;
            font-weight: bold;
            font-size: 14pt;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        h4 {
            color: #7f8c8d;
            font-weight: bold;
            font-size: 12pt;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        ul, ol {
            margin-bottom: 15px;
            padding-left: 30px;
            line-height: 1.5;
        }
        li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        /* Professional bullet points */
        ul li {
            list-style-type: disc;
            margin-left: 20px;
        }
        ul ul li {
            list-style-type: circle;
        }
        ul ul ul li {
            list-style-type: square;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #e8f4f8;
        }
        .highlight {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
        }
        .summary-box {
            background-color: #d4edda;
            padding: 20px;
            border-left: 4px solid #28a745;
            margin: 20px 0;
            border-radius: 4px;
        }
        .warning-box {
            background-color: #f8d7da;
            padding: 15px;
            border-left: 4px solid #dc3545;
            margin: 20px 0;
            border-radius: 4px;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ecf0f1;
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
        }
        /* Professional Report Header */
        .report-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 1rem 0;
        }
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .header-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            font-size: 1.25rem;
            color: #1f2937;
        }
        .header-brand .brand-icon {
            font-size: 1.5rem;
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header-actions {
            display: flex;
            gap: 0.75rem;
        }
        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .action-btn:active {
            transform: translateY(0);
        }
        .action-btn.print {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        .action-btn.pdf {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        /* Hide download button on mobile devices */
        @media (max-width: 768px) {
            .action-btn.pdf {
                display: none !important;
            }
        }
        .action-btn.save {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }
        .action-btn.home {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        .btn-icon {
            font-size: 1rem;
        }
        .btn-text {
            font-size: 0.875rem;
        }
        
        /* Report Title Section */
        .report-title-section {
            text-align: center;
            margin-bottom: 2rem;
            padding-top: 6rem;
        }
        .title-underline {
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, #2563eb, #7c3aed);
            margin: 1rem auto 0;
            border-radius: 2px;
        }
        
        /* Enhanced Summary Box */
        .summary-box {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border: 1px solid #bae6fd;
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .summary-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #0369a1;
            font-size: 1.125rem;
        }
        .summary-icon {
            font-size: 1.25rem;
        }
        .summary-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        .summary-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        .item-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .item-value {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
        }
                 @media print {
             body { 
                 background-color: white !important; 
                 color: black !important;
                 font-size: 12pt;
                 line-height: 1.4;
                 margin: 0 !important;
                 padding: 0 !important;
                 width: 100% !important;
             }
             .container { 
                 box-shadow: none !important; 
                 background: white !important;
                 padding: 20px !important;
                 margin: 0 !important;
                 width: 100% !important;
                 min-width: 100% !important;
                 max-width: none !important;
                 box-sizing: border-box !important;
                 height: auto !important;
                 min-height: 100vh !important;
             }
             .report-header { display: none !important; }
             .action-buttons { display: none !important; }
             h1, h2, h3, h4 { 
                 color: black !important; 
                 page-break-after: avoid;
                 page-break-inside: avoid;
             }
             table { 
                 page-break-inside: avoid; 
                 border-collapse: collapse !important;
             }
             .summary-box, .highlight, .warning-box {
                 background: #f8f9fa !important;
                 border: 1px solid #ddd !important;
                 color: black !important;
                 page-break-inside: avoid;
             }
             p, li {
                 page-break-inside: avoid;
                 orphans: 3;
                 widows: 3;
             }
             .footer {
                 page-break-inside: avoid;
             }
         }
        /* ===== MOBILE RESPONSIVE DESIGN ===== */
        @media (max-width: 1200px) {
            .header-content {
                padding: 0 1.5rem;
            }
            .container {
                padding: 30px;
            }
        }
        
        @media (max-width: 768px) {
            /* Mobile Header */
            .report-header {
                padding: 0.75rem 0;
            }
            .header-content {
                padding: 0 1rem;
                flex-direction: column;
                gap: 0.75rem;
                align-items: center;
            }
            .header-brand {
                font-size: 1.125rem;
            }
            .header-actions {
                width: 100%;
                justify-content: center;
                gap: 0.5rem;
                flex-wrap: wrap;
            }
            .action-btn {
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
                flex: 1;
                max-width: 120px;
                display: flex;
                align-items: center;
                gap: 0.375rem;
            }
            .btn-text {
                font-size: 0.8125rem;
                display: inline !important;
            }
            
            /* Mobile Container */
            .container {
                padding: 20px 15px;
                margin-top: 120px; /* Account for taller mobile header */
            }
            
            /* Mobile Typography */
            h1 {
                font-size: 1.75rem;
                margin-bottom: 20px;
            }
            h2 {
                font-size: 1.375rem;
                margin-top: 25px;
                margin-bottom: 15px;
            }
            h3 {
                font-size: 1.125rem;
                margin-top: 20px;
                margin-bottom: 12px;
            }
            h4 {
                font-size: 1rem;
                margin-top: 15px;
                margin-bottom: 8px;
            }
            p {
                font-size: 0.9375rem;
                line-height: 1.6;
                margin-bottom: 12px;
            }
            
            /* Mobile Tables */
            table {
                font-size: 0.875rem;
                margin: 15px 0;
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }
            th, td {
                padding: 8px 6px;
                min-width: 80px;
            }
            th {
                font-size: 0.8125rem;
            }
            
            /* Mobile Lists */
            ul, ol {
                padding-left: 20px;
                margin-bottom: 12px;
            }
            li {
                font-size: 0.9375rem;
                margin-bottom: 6px;
                line-height: 1.5;
            }
            
            /* Mobile Boxes */
            .summary-box, .highlight, .warning-box {
                padding: 15px;
                margin: 15px 0;
                border-radius: 8px;
            }
            .summary-content {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            .summary-item {
                padding: 8px 0;
            }
            .item-label {
                font-size: 0.8125rem;
            }
            .item-value {
                font-size: 0.9375rem;
            }
            
            /* Mobile Code Blocks */
            .code-block {
                padding: 12px;
                font-size: 0.8125rem;
                margin: 12px 0;
                border-radius: 6px;
            }
            
            /* Mobile Footer */
            .footer {
                margin-top: 30px;
                padding-top: 15px;
                font-size: 0.8125rem;
            }
        }
        
        @media (max-width: 480px) {
            /* Extra Small Mobile */
            .container {
                padding: 15px 10px;
                margin-top: 140px;
            }
            
            .header-content {
                padding: 0 0.75rem;
            }
            .header-brand {
                font-size: 1rem;
            }
            .action-btn {
                padding: 0.375rem 0.5rem;
                font-size: 0.6875rem;
                max-width: 100px;
                display: flex;
                align-items: center;
                gap: 0.25rem;
            }
            .btn-text {
                font-size: 0.75rem;
                display: inline !important;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            h2 {
                font-size: 1.25rem;
            }
            h3 {
                font-size: 1.0625rem;
            }
            
            table {
                font-size: 0.8125rem;
            }
            th, td {
                padding: 6px 4px;
                min-width: 70px;
            }
            
            .summary-box, .highlight, .warning-box {
                padding: 12px;
                margin: 12px 0;
            }
            
            .code-block {
                padding: 10px;
                font-size: 0.75rem;
            }
        }
        
        /* Mobile Print Optimizations */
        @media print and (max-width: 768px) {
            .container {
                padding: 15px !important;
                margin: 0 !important;
                width: 100% !important;
            }
            h1, h2, h3, h4 {
                page-break-after: avoid;
                font-size: 1.2em;
            }
            table {
                font-size: 0.8em;
                page-break-inside: avoid;
            }
            .summary-box, .highlight, .warning-box {
                page-break-inside: avoid;
                margin: 10px 0;
            }
        }
        @media screen {
            body {
                margin: 0;
                padding: 0;
            }
        }
        
        /* Saved Reports Section Styles */
        .saved-reports-section {
            padding: 2rem 0;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 400px;
        }
        
        .saved-reports-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin: 0 auto;
            max-width: 1200px;
        }
        
        .saved-reports-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .saved-reports-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .title-icon {
            font-size: 1.5rem;
        }
        
        .saved-reports-subtitle {
            color: #64748b;
            font-size: 1rem;
            margin: 0;
        }
        
        .saved-reports-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .saved-report-item {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .saved-report-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #3b82f6;
        }
        
        .saved-report-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        }
        
        .report-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .report-item-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
            line-height: 1.4;
        }
        
        .report-item-date {
            font-size: 0.875rem;
            color: #64748b;
            white-space: nowrap;
        }
        
        .report-item-details {
            margin-bottom: 1rem;
        }
        
        .report-detail-row {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        
        .report-detail-label {
            font-weight: 500;
            color: #475569;
            min-width: 80px;
            margin-right: 0.5rem;
        }
        
        .report-detail-value {
            color: #1e293b;
            flex: 1;
        }
        
        .report-item-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .report-action-btn {
            flex: 1;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.375rem;
        }
        
        .report-action-btn.primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        
        .report-action-btn.primary:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-1px);
        }
        
        .report-action-btn.secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }
        
        .report-action-btn.secondary:hover {
            background: #e2e8f0;
            border-color: #cbd5e1;
        }
        
        .no-reports-message {
            text-align: center;
            padding: 3rem 2rem;
            color: #64748b;
        }
        
        .no-reports-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .no-reports-message h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #475569;
            margin-bottom: 0.5rem;
        }
        
        .no-reports-message p {
            font-size: 1rem;
            margin: 0;
        }
        
        .saved-reports-toggle {
            background: none;
            border: none;
            color: inherit;
            font-size: inherit;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .saved-reports-toggle:hover {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }
        
        .saved-reports-toggle.active {
            background: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }
        
        .nav-icon {
            font-size: 1rem;
        }
        
        /* Mobile Responsive for Saved Reports */
        @media (max-width: 768px) {
            .saved-reports-list {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .saved-report-item {
                padding: 1rem;
            }
            
            .report-item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .report-item-actions {
                flex-direction: column;
            }
            
            .saved-reports-card {
                padding: 1.5rem;
                margin: 0 1rem;
            }
            
        .saved-reports-title {
            font-size: 1.5rem;
        }
    }
    
    /* Loading and Error States */
    .loading-reports {
        text-align: center;
        padding: 2rem;
        color: #64748b;
        font-size: 1rem;
    }
    
        .error-message {
        text-align: center;
        padding: 2rem;
        color: #dc2626;
        font-size: 1rem;
        }

        /* Custom styles for Bootstrap modal enhancements */
        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .modal-header .btn-close {
            filter: invert(1);
        }

        .sortable {
            cursor: pointer;
            user-select: none;
        }

        .sortable:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .sort-indicator {
            margin-left: 8px;
            opacity: 0.5;
            transition: all 0.2s ease;
        }

        .sortable.asc .sort-indicator {
            opacity: 1;
            transform: rotate(180deg);
        }

        .sortable.desc .sort-indicator {
            opacity: 1;
        }

        /* Custom Navbar Styles */
        .navbar {
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 0.75rem 0;
        }

        .navbar-brand {
            font-size: 1.5rem;
            color: #333 !important;
        }

        .navbar-brand .brand-logo-img {
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .navbar-nav .btn {
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s ease;
            padding: 0.5rem 1rem;
        }

        .navbar-nav .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .navbar-nav .btn-outline-primary:hover {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }

        .navbar-nav .btn-outline-secondary:hover {
            background-color: #6c757d;
            border-color: #6c757d;
        }

        .navbar-nav .btn-outline-danger:hover {
            background-color: #dc3545;
            border-color: #dc3545;
        }

        /* Responsive navbar */
        @media (max-width: 768px) {
            .navbar-brand {
                font-size: 1.25rem;
            }
            
            .navbar-nav .btn {
                margin-bottom: 0.5rem;
                width: 100%;
            }
            
            .navbar-nav {
                margin-top: 1rem;
            }
        }

        /* Scrollable Table Styles */
        .table-responsive {
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .table-responsive::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .table-responsive::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .table-responsive::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        .table-responsive::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .sticky-top {
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .table th {
            white-space: nowrap;
            font-weight: 600;
        }

        .table td {
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <!-- Professional Report Header -->
    <header class="report-header">
        <div class="header-content">
            <div class="header-brand">
                <img src="/static/logo_trade_on_chain.png" alt="AI Trade Report" class="brand-logo" style="height: 32px; width: auto; margin-right: 12px;">
                <img src="/static/logo2.png" alt="AI Trade Report" class="brand-logo" style="height: 32px; width: auto; margin-right: 12px;">
                <span class="brand-text">AI Trade Report</span>
            </div>
            <div class="header-actions">
                <button class="action-btn save" onclick="saveReport()">
                    <span class="btn-icon">üíæ</span>
                    <span class="btn-text">Save</span>
                </button>
                <button class="action-btn home" onclick="returnToMain()">
                    <span class="btn-icon">üè†</span>
                    <span class="btn-text">Home</span>
                </button>
                <button class="action-btn print" onclick="window.print()">
                    <span class="btn-icon">üñ®Ô∏è</span>
                    <span class="btn-text">Print</span>
                </button>
                <button class="action-btn pdf" onclick="downloadPDF()">
                    <span class="btn-icon">üìÑ</span>
                    <span class="btn-text">Download PDF</span>
                </button>
            </div>
        </div>
    </header>
    
    <div class="container" id="report-content">
        <div class="report-title-section">
            <h1>AI Trade Report</h1>
            <div class="title-underline"></div>
        </div>
        <div class="summary-box">
            <div class="summary-header">
                <span class="summary-icon">üìã</span>
                <span class="summary-title">Report Overview</span>
            </div>
            <div class="summary-content">
                <div class="summary-item">
                    <span class="item-label">Generated by:</span>
                    <span class="item-value">AI-Powered Market Research</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">Date:</span>
                    <span class="item-value">28 September 2025</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">Report Type:</span>
                    <span class="item-value">Comprehensive Market Analysis</span>
                </div>
            </div>
        </div>
        <p>Title: Strategic Market Analysis Report for LIVE FISH under the brand fish</p>
        <p>Analysis Date: 28 September 2025</p>
        <p>Font: Times New Roman, 12pt | Line spacing: 1.5 | Margins: 1 inch | Page numbers: Bottom center</p>
        <br>
        <p>Executive Summary</p>
        <ul>
            <li>Scope: This report assesses expansion opportunities for LIVE FISH under the brand fish across selected European and non-European markets with a total available budget of 10000. Given the limited budget and the operational complexity of live fish logistics, the strategy prioritizes market validation, regulatory readiness, partner screening, and pilot distribution rather than scale deployment.</li>
            <li>Headline insights: Europe presents comparatively lower regulatory uncertainty and more reliable cold chain infrastructure for live aquatic products, especially in Western Europe and the UK. Non-European markets such as the Gulf Cooperation Council and select East Asian hubs offer high willingness to pay and established live seafood channels but require stringent veterinary, biosecurity, and airline-cargo handling compliance. Due to the small budget, focus on low-cost market discovery, import broker alignment, and targeted B2B pilots is recommended. Where recent, verifiable market-size data for ‚Äúlive fish‚Äù specifically is not publicly accessible from allowed sources, this report provides clearly labeled estimates and limits scope to actionable steps and compliance frameworks supported by cited regulations.</li>
        </ul>
        <p>Market Overview</p>
        <ul>
            <li>Market definition: Live fish for human consumption and premium retail and HoReCa channels, excluding ornamental fish. Product scope includes high-survivability species suited for air or short-haul road transport.</li>
            <li>Demand drivers: Freshness premium, live seafood gastronomy, premium retail counters, Asian cuisine growth in Europe, and experiential dining.</li>
            <li>Supply constraints: Mortality risk in transit, water quality control, animal welfare and veterinary import rules, airline handling capacity, weekend clearance limitations, and retailer biosecurity policies.</li>
            <li>Data limitations: Disaggregated ‚Äúlive fish‚Äù market size data is not directly published by Eurostat or OECD at sufficient granularity for all target markets. Where needed, TAM/SAM/SOM are framed as estimates based on import value of HS-03 live fish categories from UN Comtrade and WTO where accessible, noting that 2024 to 2025 data may not yet be complete.</li>
        </ul>
        <p>Target Market Analysis</p>
        <p>Note: Figures below are estimates derived from publicly reported HS-03 live fish import values where available and analogous market benchmarks. Ranges indicate uncertainty bands due to product mix and incomplete 2024 to 2025 reporting. These are directional for screening and should be validated during pilots.</p>
        <br>
        <table>
            <tr>
                <td>Country or Region</td>
                <td>TAM Live Fish Imports CIF (Estimate)</td>
                <td>SAM Premium HoReCa and High-end Retail (Estimate)</td>
                <td>SOM Year 1 With 10000 Budget (Estimate)</td>
            </tr>
            <tr>
                <th>-------------------</th>
                <th>--------------------------------------</th>
                <th>---------------------------------------------------</th>
                <th>------------------------------------------</th>
            </tr>
            <tr>
                <td>Germany</td>
                <td>90 to 150 EUR M</td>
                <td>20 to 35 EUR M</td>
                <td>0.02 to 0.08 EUR M</td>
            </tr>
            <tr>
                <td>France</td>
                <td>120 to 200 EUR M</td>
                <td>30 to 50 EUR M</td>
                <td>0.03 to 0.10 EUR M</td>
            </tr>
            <tr>
                <td>UK</td>
                <td>140 to 220 EUR M</td>
                <td>35 to 55 EUR M</td>
                <td>0.03 to 0.12 EUR M</td>
            </tr>
            <tr>
                <td>Italy</td>
                <td>70 to 120 EUR M</td>
                <td>15 to 30 EUR M</td>
                <td>0.02 to 0.06 EUR M</td>
            </tr>
            <tr>
                <td>Spain</td>
                <td>80 to 130 EUR M</td>
                <td>18 to 32 EUR M</td>
                <td>0.02 to 0.06 EUR M</td>
            </tr>
            <tr>
                <td>Netherlands</td>
                <td>60 to 100 EUR M</td>
                <td>10 to 18 EUR M</td>
                <td>0.01 to 0.04 EUR M</td>
            </tr>
            <tr>
                <td>Poland</td>
                <td>20 to 40 EUR M</td>
                <td>4 to 9 EUR M</td>
                <td>0.005 to 0.02 EUR M</td>
            </tr>
            <tr>
                <td>GCC hubs (UAE, Qatar)</td>
                <td>180 to 260 EUR M</td>
                <td>45 to 80 EUR M</td>
                <td>0.04 to 0.15 EUR M</td>
            </tr>
            <tr>
                <td>Singapore</td>
                <td>60 to 90 EUR M</td>
                <td>20 to 35 EUR M</td>
                <td>0.02 to 0.08 EUR M</td>
            </tr>
            <tr>
                <td>Hong Kong SAR</td>
                <td>250 to 400 EUR M</td>
                <td>80 to 140 EUR M</td>
                <td>0.05 to 0.20 EUR M</td>
            </tr>
            <tr>
                <td>USA</td>
                <td>200 to 320 EUR M</td>
                <td>60 to 110 EUR M</td>
                <td>0.03 to 0.12 EUR M</td>
            </tr>
        </table>
        <p>Estimate reasoning:</p>
        <ul>
            <li>TAM: Directional ranges based on HS-03 ‚ÄúLive fish‚Äù imports from UN Comtrade and WTO trade profiles, known live seafood flows into key premium markets, and historical patterns where reported. Precise, recent market-by-market breakouts require retrieval of the latest Comtrade data extracts and should be validated prior to financial commitments.</li>
            <li>SAM: Share of TAM accessible to premium retail counters and HoReCa with live tanks, excluding commodity segments and low-margin wholesale.</li>
            <li>SOM Year 1: Constrained by 10000 total budget, with realistic conversion limited to relationship-building, trials with 3 to 10 accounts, and minimal above-the-line spend. Revenue realization assumes 2 to 6 pilot accounts, modest volumes, and cautious mortality assumptions.</li>
        </ul>
        <p>Competitive Landscape</p>
        <p>Observations supported by import pathways and distribution structures:</p>
        <ul>
            <li>Europe: Competition is fragmented across specialized importers and live seafood distributors in major wholesale markets such as Rungis International Market in France, Billingsgate in the UK, Mercabarna in Spain, and Rijn-Maas delta hubs. Market power is held by importers with bonded cold rooms, live tank systems, and weekend customs clearance capabilities. Global airline-linked seafood forwarders service live shipments through hubs in Paris CDG, London Heathrow, Amsterdam Schiphol, Frankfurt, and Madrid.</li>
            <li>Non-Europe: Hong Kong SAR and Singapore have dense networks of live seafood traders and premium Cantonese restaurants. GCC markets rely on air freight with fast clearance and cold chain operators linked to Dubai and Doha cargo terminals. The USA market is regionally served through coastal gateways with specialized live seafood handlers.</li>
            <li>Competitive implication: Differentiation requires reliability, survival rates, welfare compliance, and traceability. A brand-forward strategy alone is insufficient without demonstrable logistics excellence and veterinary compliance documentation.</li>
        </ul>
        <p>Regulatory Environment</p>
        <ul>
            <li>European Union</li>
            <li>Food safety and hygiene: Regulation (EC) No 852/2004 on food hygiene and Regulation (EC) No 853/2004 for food of animal origin set structural and process requirements for handling live aquatic animals for human consumption.</li>
            <li>Animal health: Regulation (EU) 2016/429 Animal Health Law and implementing acts for aquatic animal diseases. Health certificates are required for listed species and zones. Official border control checks are conducted per Regulation (EU) 2017/625.</li>
            <li>Import controls: Border Control Posts with Common Health Entry Document for Animals. TRACES NT system for pre-notification.</li>
            <li>Welfare in transport: Council Regulation (EC) No 1/2005 requirements adapted to aquatic animals, including water quality, stocking densities, and journey time.</li>
            <li>Data protection: GDPR applies to any consumer data capture in direct-to-consumer pilots.</li>
            <li>CE marking: Not applicable to food or live animals. Applies to equipment only, if selling tanks or devices.</li>
            <li>UK: Post-Brexit import regime mirrors EU with UK IPAFFS pre-notification, UK Border Control Posts, and Great Britain health certification rules published by UK authorities.</li>
            <li>Non-EU</li>
            <li>USA: USDA APHIS and FDA jurisdiction depending on species and use, with state-level health and invasive species restrictions. Prior Notice to FDA for food imports.</li>
            <li>GCC: Gulf Standardization Organization food and veterinary certificates, with country-specific approvals. Live fish imports require veterinary health certificates and rapid clearance coordination.</li>
            <li>Singapore: Singapore Food Agency import permits and veterinary health certification for live fish. Pre-import licensing for specified species.</li>
            <li>Hong Kong SAR: Centre for Food Safety import controls, health certification for designated species, and requirements for live fish transportation and holding facilities.</li>
        <p>Note: Operators must consult the latest official portals for species-specific certificates and any disease-zone restrictions prior to shipment.</p>
        </ul>
        <p>Consumer Analysis</p>
        <ul>
            <li>Europe: Premium consumers and Asian dining segments value live seafood freshness. Demand concentrates in metropolitan areas with established live tanks in restaurants and select high-end retailers.</li>
            <li>Non-Europe: Hong Kong SAR, Singapore, and GCC show high willingness to pay for live seafood and support frequent air shipments and fast turnover.</li>
        </ul>
        <p>Distribution Channels</p>
        <ul>
            <li>Europe: Best entry via specialized importers and live seafood wholesalers with tanks and customs clearance. Secondary route via premium retailers that already operate live seafood counters, often supplied by those wholesalers.</li>
            <li>Non-Europe: Air cargo to hub airports with live seafood handlers, partnerships with import brokers who manage veterinary clearance and immediate distribution to restaurant groups with live tanks.</li>
        </ul>
        <p>Pricing and Cost Structure Considerations</p>
        <ul>
            <li>Value drivers: Species scarcity, survival rate, transit time, and live arrival guarantees.</li>
            <li>Cost drivers: Air freight rate per kilogram including water weight, oxygenated packaging, mortality allowance, veterinary certificates, pre-clearance fees, and last-mile oxygenated tank trucks.</li>
            <li>Strategy: Price to landed cost plus survival-adjusted margin. Offer initial trial pricing with performance-linked rebate tied to survival percentage.</li>
        </ul>
        <p>Risk Assessment</p>
        <ul>
            <li>Biological risk: Mortality in transit and disease detection at border checks.</li>
            <li>Regulatory risk: Species restrictions, health certificate changes, weekend clearance gaps.</li>
            <li>Logistics risk: Flight delays, heat stress, oxygen depletion, and airport handling bottlenecks.</li>
            <li>Commercial risk: Limited initial buyer base and dependence on a few importers.</li>
            <li>Currency risk: EUR to USD rate shifts affecting air freight priced in USD.</li>
        </ul>
        <p>Budget Allocation Recommendations</p>
        <p>Given the small total budget of 10000, prioritize validation and de-risking activities over scale:</p>
        <ul>
            <li>55 percent Europe focus to leverage single market efficiencies and proximity.</li>
            <li>45 percent non-Europe focus targeting one hub market with proven live seafood ecosystems.</li>
        </ul>
        <p>Comparative Market Analysis</p>
        <p>Note: Qualitative comparative conclusions are provided due to gaps in recent granular import data by destination and species within the constraints of this assignment. The following table frames directional choices for where to pilot with minimal capital outlay.</p>
        <br>
        <table>
            <tr>
                <td>Market Option</td>
                <td>Rationale</td>
                <td>Entry Complexity</td>
                <td>Near-term Revenue Potential</td>
            </tr>
            <tr>
                <th>---------------</th>
                <th>-----------</th>
                <th>------------------</th>
                <th>-----------------------------</th>
            </tr>
            <tr>
                <td>France and UK</td>
                <td>Dense premium HoReCa, established importers, frequent flights, strong Asian dining segments</td>
                <td>Medium</td>
                <td>Medium to High</td>
            </tr>
            <tr>
                <td>Netherlands and Germany</td>
                <td>Efficient logistics hubs, re-export potential, stringent checks but predictable</td>
                <td>Medium</td>
                <td>Medium</td>
            </tr>
            <tr>
                <td>UAE</td>
                <td>High willingness to pay, rapid clearance, concentrated buyers</td>
                <td>Medium to High</td>
                <td>High</td>
            </tr>
            <tr>
                <td>Singapore</td>
                <td>Efficient regulator, reliable handlers, concentrated demand</td>
                <td>Medium</td>
                <td>Medium to High</td>
            </tr>
            <tr>
                <td>Hong Kong SAR</td>
                <td>Largest live seafood hub, intense competition</td>
                <td>High</td>
                <td>High</td>
            </tr>
        </table>
        <p>Strategic Recommendations</p>
        <ul>
            <li>Prioritize two pilot corridors:</li>
            <li>Europe: Supplier origin to Paris CDG or London Heathrow with distribution through one vetted live seafood importer serving Rungis and central London restaurant clusters.</li>
            <li>Non-Europe: Supplier origin to Dubai DXB with a single importer distributor servicing Dubai and Abu Dhabi premium restaurants and hotels.</li>
            <li>Focus species: Select hardy, high-survival live fish with established culinary demand and regulatory clarity to reduce mortality and clearance risks. Avoid species with complex CITES or invasive species issues.</li>
            <li>Documentation excellence: Prepare complete veterinary dossiers, water quality logs, and transport SOPs. Pre-notify via TRACES NT in EU or IPAFFS in UK; secure importer permits for UAE.</li>
            <li>Survival guarantee pilot: Offer a limited trial with survival-threshold rebate to build trust and data.</li>
            <li>Brand positioning: Emphasize welfare-compliant handling, full traceability, and freshness metrics. Use QR-linked batch traceability for B2B buyers.</li>
            <li>Data capture: Instrument every shipment with arrival DOA rates, pH and temperature logs, and clearance timestamps to refine SOPs and support scale-up fundraising.</li>
        </ul>
        <p>Implementation Plan</p>
        <p>90-day action plan aligned to a 10000 budget. All amounts are estimates.</p>
        <br>
        <table>
            <tr>
                <td>Workstream</td>
                <td>Key Actions</td>
                <td>Owner</td>
                <td>Timeline</td>
                <td>Budget EUR (Estimate)</td>
            </tr>
            <tr>
                <th>------------</th>
                <th>-------------</th>
                <th>-------</th>
                <th>----------</th>
                <th>------------------------</th>
            </tr>
            <tr>
                <td>Regulatory readiness</td>
                <td>Map species-specific certificates for EU, UK, UAE. Pre-fill TRACES NT, IPAFFS, and UAE veterinary templates. Engage one EU veterinary consultant for document review.</td>
                <td>Compliance Lead</td>
                <td>Days 1 to 21</td>
                <td>1500</td>
            </tr>
            <tr>
                <td>Partner screening</td>
                <td>Shortlist 6 to 8 importers with live tanks in France, UK, UAE. Conduct capability and SLA interviews. Secure 2 LOIs for trials.</td>
                <td>Commercial Lead</td>
                <td>Days 7 to 30</td>
                <td>0 to 300</td>
            </tr>
            <tr>
                <td>Logistics SOPs</td>
                <td>Finalize packaging, oxygenation, stocking density, and emergency reroute SOPs. Align with airline live animal desk at CDG, LHR, DXB.</td>
                <td>Ops Lead</td>
                <td>Days 10 to 35</td>
                <td>500</td>
            </tr>
            <tr>
                <td>Pilot shipment Europe</td>
                <td>One small-batch trial to Paris or London with hardy species. Measure DOA and survival after 24 hours.</td>
                <td>Ops Lead</td>
                <td>Days 30 to 60</td>
                <td>2500 to 3000</td>
            </tr>
            <tr>
                <td>Pilot shipment UAE</td>
                <td>One small-batch trial to Dubai with pre-cleared importer. Ensure weekend clearance avoidance.</td>
                <td>Ops Lead</td>
                <td>Days 45 to 75</td>
                <td>2500 to 3000</td>
            </tr>
            <tr>
                <td>Marketing and materials</td>
                <td>Create B2B technical spec sheets, welfare SOP one-pager, and QR-enabled traceability pages.</td>
                <td>Marketing</td>
                <td>Days 20 to 50</td>
                <td>600</td>
            </tr>
            <tr>
                <td>Insurance and contingency</td>
                <td>Shipment insurance and contingency for re-ice, re-oxygenation, or hoteling.</td>
                <td>Finance</td>
                <td>Days 30 to 75</td>
                <td>700</td>
            </tr>
            <tr>
                <td>Post-pilot review</td>
                <td>Analyze KPIs, buyer feedback, margin after mortality, and readiness to scale. Present go or no-go and budget ask.</td>
                <td>Strategy</td>
                <td>Days 75 to 90</td>
                <td>200</td>
            </tr>
        </table>
        <p>Risk Assessment Matrix</p>
        <table>
            <tr>
                <td>Risk</td>
                <td>Likelihood</td>
                <td>Impact</td>
                <td>Mitigation</td>
            </tr>
            <tr>
                <th>------</th>
                <th>------------</th>
                <th>--------</th>
                <th>------------</th>
            </tr>
            <tr>
                <td>Mortality in transit</td>
                <td>Medium</td>
                <td>High</td>
                <td>Conservative stocking density, validated oxygenation, route with minimal layovers, DOA thresholds and SOPs</td>
            </tr>
            <tr>
                <td>Border clearance delay</td>
                <td>Medium</td>
                <td>High</td>
                <td>Pre-notification, book flights arriving during BCP staffing windows, local broker on standby</td>
            </tr>
            <tr>
                <td>Documentation non-compliance</td>
                <td>Low to Medium</td>
                <td>High</td>
                <td>Third-party vet review, species checklists, batch-wise certificates</td>
            </tr>
            <tr>
                <td>Buyer concentration</td>
                <td>Medium</td>
                <td>Medium</td>
                <td>Two pilots in two markets, LOIs with at least two buyers each</td>
            </tr>
            <tr>
                <td>Air freight volatility</td>
                <td>Medium</td>
                <td>Medium</td>
                <td>Quote-lock windows, alternative carriers, flexible shipment size</td>
            </tr>
            <tr>
                <td>Currency exposure USD</td>
                <td>Medium</td>
                <td>Medium</td>
                <td>Price in EUR where possible, short payment terms</td>
            </tr>
        </table>
        <p>Budget Allocation Recommendations</p>
        <table>
            <tr>
                <td>Item</td>
                <td>Allocation EUR (Estimate)</td>
                <td>Rationale</td>
            </tr>
            <tr>
                <th>------</th>
                <th>---------------------------</th>
                <th>-----------</th>
            </tr>
            <tr>
                <td>Regulatory and consulting</td>
                <td>1500</td>
                <td>Minimize compliance risk early</td>
            </tr>
            <tr>
                <td>Partner screening and travel-light</td>
                <td>300</td>
                <td>Virtual first, use existing broker networks</td>
            </tr>
            <tr>
                <td>Logistics SOPs and materials</td>
                <td>500</td>
                <td>Ensure survival and repeatability</td>
            </tr>
            <tr>
                <td>Pilot shipment Europe</td>
                <td>2750</td>
                <td>Air freight, packaging, certificates</td>
            </tr>
            <tr>
                <td>Pilot shipment UAE</td>
                <td>2750</td>
                <td>Air freight, packaging, certificates</td>
            </tr>
            <tr>
                <td>Marketing materials</td>
                <td>600</td>
                <td>B2B credibility and traceability</td>
            </tr>
            <tr>
                <td>Insurance and contingency</td>
                <td>600</td>
                <td>Unexpected handling or delays</td>
            </tr>
            <tr>
                <td>Post-pilot analytics</td>
                <td>0 to 100</td>
                <td>In-house analysis</td>
            </tr>
        </table>
        <p>Sources &amp; References</p>
        <ul>
            <li>European Commission. Regulation (EC) No 852/2004 on the hygiene of foodstuffs. Published 2004, consolidated versions current to 2024.</li>
            <li>European Commission. Regulation (EC) No 853/2004 laying down specific hygiene rules for food of animal origin. Published 2004, consolidated to 2024.</li>
            <li>European Commission. Regulation (EU) 2016/429 on transmissible animal diseases. Published 2016, applicable 2021 onward, consolidated to 2024.</li>
            <li>European Commission. Regulation (EU) 2017/625 on official controls. Published 2017, consolidated to 2024.</li>
            <li>European Commission. Council Regulation (EC) No 1/2005 on the protection of animals during transport. Published 2005, consolidated to 2024.</li>
            <li>UK Government. Import of live animals and products of animal origin, IPAFFS guidance. GOV.UK, updated 2023 to 2025.</li>
            <li>Singapore Food Agency. Import of live fish. SFA official guidance, updated 2023 to 2025.</li>
            <li>UAE Ministry of Climate Change and Environment, and Dubai Municipality. Food import and veterinary health certificate requirements, updated 2023 to 2025.</li>
            <li>Hong Kong Centre for Food Safety. Import control of live fish, official guidance, updated 2023 to 2025.</li>
            <li>United States FDA. Prior Notice of Imported Foods requirements, updated 2024.</li>
            <li>UN Comtrade Database. HS-03 Live fish trade data. Accessed 2023 to 2024 editions. Note: 2025 data may be provisional.</li>
        </ul>
        <div class="footer">
            <p>This report was generated using AI-powered market research technology.</p>
            <p>For questions or additional analysis, please contact your research team.</p>
        </div>
    </div>
    
    <script>
        // Define the function immediately when script loads
        function downloadPDF() {
            const element = document.getElementById('report-content');
            
            // Show loading state
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '‚è≥ Generating PDF...';
            btn.disabled = true;
           
           // Wait for fonts and images to load
           setTimeout(function() {
               // First, ensure the element is visible and has content
               if (!element || element.offsetHeight === 0 || element.offsetWidth === 0) {
                   alert('Report content not found. Please refresh the page and try again.');
                   btn.innerHTML = originalText;
                   btn.disabled = false;
                   return;
               }
               
               // Ensure the element is visible and has content
               const rect = element.getBoundingClientRect();
               if (rect.width === 0 || rect.height === 0) {
                   alert('Report content is not visible. Please scroll to the report and try again.');
                   btn.innerHTML = originalText;
                   btn.disabled = false;
                   return;
               }
               
               // Force a reflow to ensure content is rendered
               element.style.display = 'none';
               element.offsetHeight; // Trigger reflow
               element.style.display = 'block';
               
               // Ensure all content is visible and expanded
               element.style.height = 'auto';
               element.style.minHeight = '100vh';
               element.style.overflow = 'visible';
               
               // Wait a bit more for any dynamic content to render
               setTimeout(function() {
               
               const opt = {
                   margin: [0.5, 0.5, 0.5, 0.5],
                   filename: 'AI_Trade_Report.pdf',
                   image: { type: 'jpeg', quality: 0.98 },
                   html2canvas: { 
                       scale: 1.2,
                       useCORS: true,
                       allowTaint: true,
                       backgroundColor: '#ffffff',
                       logging: false,
                       letterRendering: true,
                       width: element.scrollWidth,
                       height: element.scrollHeight,
                       scrollX: 0,
                       scrollY: 0,
                       windowWidth: element.scrollWidth,
                       windowHeight: element.scrollHeight
                   },
                   jsPDF: { 
                       unit: 'in', 
                       format: 'a4', 
                       orientation: 'portrait',
                       compress: true
                   },
                   pagebreak: { mode: ['css', 'legacy'] }
               };
              
              // Debug: Log element dimensions
              console.log('Element dimensions:', {
                  width: element.offsetWidth,
                  height: element.offsetHeight,
                  scrollWidth: element.scrollWidth,
                  scrollHeight: element.scrollHeight,
                  rect: element.getBoundingClientRect()
              });
              
              // Try the main PDF generation
              html2pdf().set(opt).from(element).save().then(function() {
                  btn.innerHTML = originalText;
                  btn.disabled = false;
              }).catch(function(error) {
                  console.error('PDF generation failed:', error);
                  
                  // Fallback: Try with simpler options
                  const simpleOpt = {
                      margin: 0.5,
                      filename: 'AI_Trade_Report.pdf',
                      image: { type: 'jpeg', quality: 0.8 },
                      html2canvas: { 
                          scale: 1,
                          backgroundColor: '#ffffff',
                          width: element.scrollWidth,
                          height: element.scrollHeight,
                          useCORS: true,
                          scrollX: 0,
                          scrollY: 0
                      },
                      jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
                  };
                  
                  html2pdf().set(simpleOpt).from(element).save().then(function() {
                      btn.innerHTML = originalText;
                      btn.disabled = false;
                  }).catch(function(fallbackError) {
                      console.error('Fallback PDF generation also failed:', fallbackError);
                      alert('PDF generation failed. Please use the Print button and save as PDF from your browser instead.');
                      btn.innerHTML = originalText;
                      btn.disabled = false;
                  });
              });
          }, 500);
      }, 1000);
  }
  
  // Also make it available on window object
  window.downloadPDF = downloadPDF;
  
  // Save report function
  // Track if report is saved
  let isReportSaved = false;
  
  function saveReport() {
      console.log('Save report function called');
      
      const btn = event.target.closest('.action-btn');
      if (!btn) {
          console.error('Save button not found');
          return;
      }
      
      // Check if already saved
      if (isReportSaved) {
          btn.innerHTML = '‚úÖ Already Saved';
          btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
          btn.disabled = true;
          
          setTimeout(() => {
              btn.innerHTML = 'üíæ Save';
              btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
              btn.disabled = false;
          }, 2000);
          return;
      }
      
      const originalText = btn.innerHTML;
      
      // Show loading state
      btn.innerHTML = '‚è≥ Saving...';
      btn.disabled = true;
      
      try {
          // Get report data
          const reportTitle = document.querySelector('h1')?.textContent || 'AI Trade Report';
          const reportContent = document.getElementById('report-content')?.innerHTML || '';
          const currentUrl = window.location.pathname;
          const filename = currentUrl.split('/').pop() || 'unknown_report.html';
          
          console.log('Report data extracted:', {
              title: reportTitle,
              filename: filename,
              contentLength: reportContent.length
          });
          
          // Extract report metadata from URL or page
          const brand = document.querySelector('.summary-item:nth-child(1) .item-value')?.textContent || 'Unknown Brand';
          const product = document.querySelector('.summary-item:nth-child(2) .item-value')?.textContent || 'Unknown Product';
          const budget = document.querySelector('.summary-item:nth-child(3) .item-value')?.textContent || 'Unknown Budget';
          const enterpriseSize = document.querySelector('.summary-item:nth-child(4) .item-value')?.textContent || 'Unknown Size';
          
          // Prepare data for API
          const reportData = {
              title: reportTitle,
              brand: brand,
              product: product,
              budget: budget,
              enterprise_size: enterpriseSize,
              ai_model: 'gpt-5',
              language: 'en',
              content: reportContent,
              file_path: filename
          };
          
          console.log('Sending data to API:', reportData);
          
          // Send to database
          fetch('/save-report', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify(reportData)
          })
          .then(response => {
              console.log('API response status:', response.status);
              if (!response.ok) {
                  throw new Error(`HTTP error! status: ${response.status}`);
              }
              return response.json();
          })
          .then(data => {
              console.log('API response data:', data);
              if (data.status === 'success') {
                  isReportSaved = true; // Mark as saved
                  btn.innerHTML = '‚úÖ Saved!';
                  btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                  
                  setTimeout(() => {
                      btn.innerHTML = 'üíæ Save';
                      btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
                      btn.disabled = false;
                  }, 2000);
              } else {
                  throw new Error(data.message || 'Failed to save report');
              }
          })
          .catch(error => {
              console.error('Error saving report:', error);
              btn.innerHTML = '‚ùå Error';
              btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
              
              setTimeout(() => {
                  btn.innerHTML = originalText;
                  btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
                  btn.disabled = false;
              }, 3000);
          });
      } catch (error) {
          console.error('Error in saveReport function:', error);
          btn.innerHTML = '‚ùå Error';
          btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
          
          setTimeout(() => {
              btn.innerHTML = originalText;
              btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
              btn.disabled = false;
          }, 3000);
      }
  }
  
  // Return to main page function
  function returnToMain() {
      if (isReportSaved) {
          // If report is saved, go directly without warning
          window.location.href = '/';
      } else {
          // If not saved, show warning
          if (confirm('Are you sure you want to return to the main page? Your current report will be lost.')) {
              window.location.href = '/';
          }
      }
  }
  
  // Make functions available globally
  window.saveReport = saveReport;
  window.returnToMain = returnToMain;
 
          // Hide header when printing
  window.addEventListener('beforeprint', function() {
      const header = document.querySelector('.report-header');
      if (header) header.style.display = 'none';
  });
  
  window.addEventListener('afterprint', function() {
      const header = document.querySelector('.report-header');
      if (header) header.style.display = 'block';
  });
  
  // Ensure function is available when DOM is ready
  document.addEventListener('DOMContentLoaded', function() {
      // Function should be available now
      if (typeof downloadPDF === 'function') {
          console.log('downloadPDF function is ready');
      } else {
          console.error('downloadPDF function not properly defined');
      }
  });
  
  // Also try to make it available immediately
  if (typeof downloadPDF === 'function') {
      console.log('downloadPDF function loaded successfully');
  }
    </script>
</body>
</html>