<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Trade Report - Professional Market Analysis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        html, body {
            font-family: 'Times New Roman', serif;
            font-size: 12pt;
            line-height: 1.5;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
            width: 100%;
            min-width: 100%;
            box-sizing: border-box;
        }
        .container {
            width: 100vw;
            min-width: 100%;
            margin: 0;
            background: white;
            padding: 40px;
            border-radius: 0;
            box-shadow: none;
            box-sizing: border-box;
        }
        h1 {
            color: #2c3e50;
            font-weight: bold;
            font-size: 18pt;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        h2 {
            color: #34495e;
            font-weight: bold;
            font-size: 16pt;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 30px;
            margin-bottom: 20px;
        }
        h3 {
            color: #2c3e50;
            font-weight: bold;
            font-size: 14pt;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        h4 {
            color: #7f8c8d;
            font-weight: bold;
            font-size: 12pt;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        ul, ol {
            margin-bottom: 15px;
            padding-left: 30px;
            line-height: 1.5;
        }
        li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        /* Professional bullet points */
        ul li {
            list-style-type: disc;
            margin-left: 20px;
        }
        ul ul li {
            list-style-type: circle;
        }
        ul ul ul li {
            list-style-type: square;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #e8f4f8;
        }
        .highlight {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
        }
        .summary-box {
            background-color: #d4edda;
            padding: 20px;
            border-left: 4px solid #28a745;
            margin: 20px 0;
            border-radius: 4px;
        }
        .warning-box {
            background-color: #f8d7da;
            padding: 15px;
            border-left: 4px solid #dc3545;
            margin: 20px 0;
            border-radius: 4px;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ecf0f1;
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
        }
        /* Professional Report Header */
        .report-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 1rem 0;
        }
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .header-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            font-size: 1.25rem;
            color: #1f2937;
        }
        .header-brand .brand-icon {
            font-size: 1.5rem;
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header-actions {
            display: flex;
            gap: 0.75rem;
        }
        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .action-btn:active {
            transform: translateY(0);
        }
        .action-btn.print {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        .action-btn.pdf {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        /* Hide download button on mobile devices */
        @media (max-width: 768px) {
            .action-btn.pdf {
                display: none !important;
            }
        }
        .action-btn.save {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }
        .action-btn.home {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        .btn-icon {
            font-size: 1rem;
        }
        .btn-text {
            font-size: 0.875rem;
        }
        
        /* Report Title Section */
        .report-title-section {
            text-align: center;
            margin-bottom: 2rem;
            padding-top: 6rem;
        }
        .title-underline {
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, #2563eb, #7c3aed);
            margin: 1rem auto 0;
            border-radius: 2px;
        }
        
        /* Enhanced Summary Box */
        .summary-box {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border: 1px solid #bae6fd;
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .summary-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #0369a1;
            font-size: 1.125rem;
        }
        .summary-icon {
            font-size: 1.25rem;
        }
        .summary-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        .summary-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        .item-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .item-value {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
        }
                 @media print {
             body { 
                 background-color: white !important; 
                 color: black !important;
                 font-size: 12pt;
                 line-height: 1.4;
                 margin: 0 !important;
                 padding: 0 !important;
                 width: 100% !important;
             }
             .container { 
                 box-shadow: none !important; 
                 background: white !important;
                 padding: 20px !important;
                 margin: 0 !important;
                 width: 100% !important;
                 min-width: 100% !important;
                 max-width: none !important;
                 box-sizing: border-box !important;
                 height: auto !important;
                 min-height: 100vh !important;
             }
             .report-header { display: none !important; }
             .action-buttons { display: none !important; }
             h1, h2, h3, h4 { 
                 color: black !important; 
                 page-break-after: avoid;
                 page-break-inside: avoid;
             }
             table { 
                 page-break-inside: avoid; 
                 border-collapse: collapse !important;
             }
             .summary-box, .highlight, .warning-box {
                 background: #f8f9fa !important;
                 border: 1px solid #ddd !important;
                 color: black !important;
                 page-break-inside: avoid;
             }
             p, li {
                 page-break-inside: avoid;
                 orphans: 3;
                 widows: 3;
             }
             .footer {
                 page-break-inside: avoid;
             }
         }
        /* ===== MOBILE RESPONSIVE DESIGN ===== */
        @media (max-width: 1200px) {
            .header-content {
                padding: 0 1.5rem;
            }
            .container {
                padding: 30px;
            }
        }
        
        @media (max-width: 768px) {
            /* Mobile Header */
            .report-header {
                padding: 0.75rem 0;
            }
            .header-content {
                padding: 0 1rem;
                flex-direction: column;
                gap: 0.75rem;
                align-items: center;
            }
            .header-brand {
                font-size: 1.125rem;
            }
            .header-actions {
                width: 100%;
                justify-content: center;
                gap: 0.5rem;
                flex-wrap: wrap;
            }
            .action-btn {
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
                flex: 1;
                max-width: 120px;
                display: flex;
                align-items: center;
                gap: 0.375rem;
            }
            .btn-text {
                font-size: 0.8125rem;
                display: inline !important;
            }
            
            /* Mobile Container */
            .container {
                padding: 20px 15px;
                margin-top: 120px; /* Account for taller mobile header */
            }
            
            /* Mobile Typography */
            h1 {
                font-size: 1.75rem;
                margin-bottom: 20px;
            }
            h2 {
                font-size: 1.375rem;
                margin-top: 25px;
                margin-bottom: 15px;
            }
            h3 {
                font-size: 1.125rem;
                margin-top: 20px;
                margin-bottom: 12px;
            }
            h4 {
                font-size: 1rem;
                margin-top: 15px;
                margin-bottom: 8px;
            }
            p {
                font-size: 0.9375rem;
                line-height: 1.6;
                margin-bottom: 12px;
            }
            
            /* Mobile Tables */
            table {
                font-size: 0.875rem;
                margin: 15px 0;
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }
            th, td {
                padding: 8px 6px;
                min-width: 80px;
            }
            th {
                font-size: 0.8125rem;
            }
            
            /* Mobile Lists */
            ul, ol {
                padding-left: 20px;
                margin-bottom: 12px;
            }
            li {
                font-size: 0.9375rem;
                margin-bottom: 6px;
                line-height: 1.5;
            }
            
            /* Mobile Boxes */
            .summary-box, .highlight, .warning-box {
                padding: 15px;
                margin: 15px 0;
                border-radius: 8px;
            }
            .summary-content {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            .summary-item {
                padding: 8px 0;
            }
            .item-label {
                font-size: 0.8125rem;
            }
            .item-value {
                font-size: 0.9375rem;
            }
            
            /* Mobile Code Blocks */
            .code-block {
                padding: 12px;
                font-size: 0.8125rem;
                margin: 12px 0;
                border-radius: 6px;
            }
            
            /* Mobile Footer */
            .footer {
                margin-top: 30px;
                padding-top: 15px;
                font-size: 0.8125rem;
            }
        }
        
        @media (max-width: 480px) {
            /* Extra Small Mobile */
            .container {
                padding: 15px 10px;
                margin-top: 140px;
            }
            
            .header-content {
                padding: 0 0.75rem;
            }
            .header-brand {
                font-size: 1rem;
            }
            .action-btn {
                padding: 0.375rem 0.5rem;
                font-size: 0.6875rem;
                max-width: 100px;
                display: flex;
                align-items: center;
                gap: 0.25rem;
            }
            .btn-text {
                font-size: 0.75rem;
                display: inline !important;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            h2 {
                font-size: 1.25rem;
            }
            h3 {
                font-size: 1.0625rem;
            }
            
            table {
                font-size: 0.8125rem;
            }
            th, td {
                padding: 6px 4px;
                min-width: 70px;
            }
            
            .summary-box, .highlight, .warning-box {
                padding: 12px;
                margin: 12px 0;
            }
            
            .code-block {
                padding: 10px;
                font-size: 0.75rem;
            }
        }
        
        /* Mobile Print Optimizations */
        @media print and (max-width: 768px) {
            .container {
                padding: 15px !important;
                margin: 0 !important;
                width: 100% !important;
            }
            h1, h2, h3, h4 {
                page-break-after: avoid;
                font-size: 1.2em;
            }
            table {
                font-size: 0.8em;
                page-break-inside: avoid;
            }
            .summary-box, .highlight, .warning-box {
                page-break-inside: avoid;
                margin: 10px 0;
            }
        }
        @media screen {
            body {
                margin: 0;
                padding: 0;
            }
        }
        
        /* Saved Reports Section Styles */
        .saved-reports-section {
            padding: 2rem 0;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 400px;
        }
        
        .saved-reports-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin: 0 auto;
            max-width: 1200px;
        }
        
        .saved-reports-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .saved-reports-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .title-icon {
            font-size: 1.5rem;
        }
        
        .saved-reports-subtitle {
            color: #64748b;
            font-size: 1rem;
            margin: 0;
        }
        
        .saved-reports-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .saved-report-item {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .saved-report-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #3b82f6;
        }
        
        .saved-report-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        }
        
        .report-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .report-item-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
            line-height: 1.4;
        }
        
        .report-item-date {
            font-size: 0.875rem;
            color: #64748b;
            white-space: nowrap;
        }
        
        .report-item-details {
            margin-bottom: 1rem;
        }
        
        .report-detail-row {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        
        .report-detail-label {
            font-weight: 500;
            color: #475569;
            min-width: 80px;
            margin-right: 0.5rem;
        }
        
        .report-detail-value {
            color: #1e293b;
            flex: 1;
        }
        
        .report-item-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .report-action-btn {
            flex: 1;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.375rem;
        }
        
        .report-action-btn.primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        
        .report-action-btn.primary:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-1px);
        }
        
        .report-action-btn.secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }
        
        .report-action-btn.secondary:hover {
            background: #e2e8f0;
            border-color: #cbd5e1;
        }
        
        .no-reports-message {
            text-align: center;
            padding: 3rem 2rem;
            color: #64748b;
        }
        
        .no-reports-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .no-reports-message h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #475569;
            margin-bottom: 0.5rem;
        }
        
        .no-reports-message p {
            font-size: 1rem;
            margin: 0;
        }
        
        .saved-reports-toggle {
            background: none;
            border: none;
            color: inherit;
            font-size: inherit;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .saved-reports-toggle:hover {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }
        
        .saved-reports-toggle.active {
            background: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }
        
        .nav-icon {
            font-size: 1rem;
        }
        
        /* Mobile Responsive for Saved Reports */
        @media (max-width: 768px) {
            .saved-reports-list {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .saved-report-item {
                padding: 1rem;
            }
            
            .report-item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .report-item-actions {
                flex-direction: column;
            }
            
            .saved-reports-card {
                padding: 1.5rem;
                margin: 0 1rem;
            }
            
        .saved-reports-title {
            font-size: 1.5rem;
        }
    }
    
    /* Loading and Error States */
    .loading-reports {
        text-align: center;
        padding: 2rem;
        color: #64748b;
        font-size: 1rem;
    }
    
        .error-message {
        text-align: center;
        padding: 2rem;
        color: #dc2626;
        font-size: 1rem;
        }

        /* Custom styles for Bootstrap modal enhancements */
        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .modal-header .btn-close {
            filter: invert(1);
        }

        .sortable {
            cursor: pointer;
            user-select: none;
        }

        .sortable:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .sort-indicator {
            margin-left: 8px;
            opacity: 0.5;
            transition: all 0.2s ease;
        }

        .sortable.asc .sort-indicator {
            opacity: 1;
            transform: rotate(180deg);
        }

        .sortable.desc .sort-indicator {
            opacity: 1;
        }

        /* Custom Navbar Styles */
        .navbar {
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 0.75rem 0;
        }

        .navbar-brand {
            font-size: 1.5rem;
            color: #333 !important;
        }

        .navbar-brand .brand-logo-img {
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .navbar-nav .btn {
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s ease;
            padding: 0.5rem 1rem;
        }

        .navbar-nav .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .navbar-nav .btn-outline-primary:hover {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }

        .navbar-nav .btn-outline-secondary:hover {
            background-color: #6c757d;
            border-color: #6c757d;
        }

        .navbar-nav .btn-outline-danger:hover {
            background-color: #dc3545;
            border-color: #dc3545;
        }

        /* Responsive navbar */
        @media (max-width: 768px) {
            .navbar-brand {
                font-size: 1.25rem;
            }
            
            .navbar-nav .btn {
                margin-bottom: 0.5rem;
                width: 100%;
            }
            
            .navbar-nav {
                margin-top: 1rem;
            }
        }

        /* Scrollable Table Styles */
        .table-responsive {
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .table-responsive::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .table-responsive::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .table-responsive::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        .table-responsive::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .sticky-top {
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .table th {
            white-space: nowrap;
            font-weight: 600;
        }

        .table td {
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <!-- Professional Report Header -->
    <header class="report-header">
        <div class="header-content">
            <div class="header-brand">
                <img src="/static/logo_trade_on_chain.png" alt="AI Trade Report" class="brand-logo" style="height: 32px; width: auto; margin-right: 12px;">
                <img src="/static/logo2.png" alt="AI Trade Report" class="brand-logo" style="height: 32px; width: auto; margin-right: 12px;">
                <span class="brand-text">AI Trade Report</span>
            </div>
            <div class="header-actions">
                <button class="action-btn save" onclick="saveReport()">
                    <span class="btn-icon">💾</span>
                    <span class="btn-text">Save</span>
                </button>
                <button class="action-btn home" onclick="returnToMain()">
                    <span class="btn-icon">🏠</span>
                    <span class="btn-text">Home</span>
                </button>
                <button class="action-btn print" onclick="window.print()">
                    <span class="btn-icon">🖨️</span>
                    <span class="btn-text">Print</span>
                </button>
                <button class="action-btn pdf" onclick="downloadPDF()">
                    <span class="btn-icon">📄</span>
                    <span class="btn-text">Download PDF</span>
                </button>
            </div>
        </div>
    </header>
    
    <div class="container" id="report-content">
        <div class="report-title-section">
            <h1>AI Trade Report</h1>
            <div class="title-underline"></div>
        </div>
        <div class="summary-box">
            <div class="summary-header">
                <span class="summary-icon">📋</span>
                <span class="summary-title">Report Overview</span>
            </div>
            <div class="summary-content">
                <div class="summary-item">
                    <span class="item-label">Generated by:</span>
                    <span class="item-value">AI-Powered Market Research</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">Date:</span>
                    <span class="item-value">28 September 2025</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">Report Type:</span>
                    <span class="item-value">Comprehensive Market Analysis</span>
                </div>
            </div>
        </div>
        <p>Title: Strategic Market Analysis Report for Potato Brand Expansion into Potatoes</p>
        <p>Analysis Date: 28 September 2025</p>
        <p>Prepared for: Board of Directors</p>
        <p>Prepared by: Senior Strategy Consultant, International Market Expansion, FMCG and European Distribution</p>
        <br>
        <p>Executive Summary</p>
        <p>This report evaluates expansion opportunities for potatoes under the brand potato across selected European and non-European markets. Given data limitations for exact market sizes and competitor shares at the branded potato level, the analysis focuses on verified macro trade and consumption dynamics, regulatory requirements, and distribution channel structures, complemented by clearly labeled estimates and transparent assumptions. The strategic conclusion is to prioritize a phased Europe-first market entry leveraging the EU single market scale, established retail networks, and lower regulatory friction, followed by selective non-EU expansion in North America and the Gulf Cooperation Council where import dependency, packaging-grade demand, and retail premiumization for branded produce are strongest.</p>
        <br>
        <p>Key recommendations:</p>
        <ul>
            <li>Enter Germany, France, Netherlands, Poland, Spain, and the UK with a dual-channel model: modern trade retail private label plus branded premium washed and convenience SKUs, supported by category management and origin-quality positioning.</li>
            <li>Build sourcing resilience with EU-compliant agronomy and cold chain to target year-round availability; integrate with third-party ripening and packing partners close to retail DCs in Germany and France.</li>
            <li>Allocate an initial 12-month expansion budget of EUR 9.5–13.5 million (Estimate) for a medium enterprise, phased by milestones, with 60 percent to Europe and 40 percent to non-Europe, subject to retailer onboarding and import program wins.</li>
            <li>Target non-EU beachheads: United States Northeast and Midwest, United Arab Emirates and Saudi Arabia, and Singapore; focus on retail program bids and foodservice distributors with year-round import programs.</li>
        </ul>
        <p>Market Overview</p>
        <p>Scope and product definition</p>
        <ul>
            <li>Product: Fresh table potatoes and value-added derivatives relevant to retail produce aisles, including washed, graded, packaged, and convenience-cut potatoes. Processing-grade potatoes for chips or fries are excluded from core go-to-market, except where noted for channel balancing.</li>
            <li>Value chain positioning: Sourcing, packing, private label co-packing, and branded retail; selective HORECA through distributors.</li>
        </ul>
        <p>Market context from official sources</p>
        <ul>
            <li>Potatoes remain a staple crop globally with Europe among the largest producers and consumers. EU-27 production volume has gradually declined over the past decade while retail value has increased due to premiumization, packaging, and convenience formats. Verified macro data points are available from Eurostat and FAO/UN Data; however, the latest disaggregated branded retail shares and country-level premium segment sizes are not publicly available without paid panels. All market size figures below are labeled Estimate and derived from official production, trade, and consumption baselines.</li>
        </ul>
        <p>Target Market Analysis</p>
        <p>Notes on method and assumptions for estimates</p>
        <ul>
            <li>Baseline consumption: National apparent consumption from Eurostat and FAO Food Balance Sheets, latest available 2022 to 2024. Where 2024 is not yet published, 2022 or 2023 is used with stable per-capita assumption.</li>
            <li>Retail addressability: Retail share assumption of total table potato consumption at 60 to 75 percent depending on country’s foodservice penetration and fresh market informality. Marked as Estimate.</li>
            <li>SAM: Share of retail addressable market purchased in modern trade chains and packaged or program-managed categories assumed at 35 to 55 percent depending on country modern trade penetration. Estimate.</li>
            <li>SOM Year 1: Attainable program wins with 2 to 6 retail accounts plus selective foodservice importers; assumed 0.1 to 0.6 percent of TAM in first year in each country subject to listings, seasonality, and supply continuity. Estimate.</li>
        </ul>
        <p>Comparative TAM, SAM, SOM by selected markets (Estimates)</p>
        <table>
            <tr>
                <td>Country or Region</td>
                <td>TAM Retail Table Potatoes Value (Estimate)</td>
                <td>SAM Modern Trade Packaged Value (Estimate)</td>
                <td>SOM Year 1 Value (Estimate)</td>
            </tr>
            <tr>
                <th>-------------------</th>
                <th>--------------------------------------------</th>
                <th>-------------------------------------------</th>
                <th>-----------------------------</th>
            </tr>
            <tr>
                <td>Germany</td>
                <td>EUR 2.6–3.2 B</td>
                <td>EUR 1.1–1.7 B</td>
                <td>EUR 2.5–9.5 M</td>
            </tr>
            <tr>
                <td>France</td>
                <td>EUR 2.1–2.7 B</td>
                <td>EUR 0.9–1.4 B</td>
                <td>EUR 2.0–8.0 M</td>
            </tr>
            <tr>
                <td>United Kingdom</td>
                <td>GBP 2.0–2.6 B</td>
                <td>GBP 0.9–1.3 B</td>
                <td>GBP 1.8–6.5 M</td>
            </tr>
            <tr>
                <td>Spain</td>
                <td>EUR 1.0–1.4 B</td>
                <td>EUR 0.4–0.7 B</td>
                <td>EUR 1.0–3.0 M</td>
            </tr>
            <tr>
                <td>Italy</td>
                <td>EUR 1.3–1.8 B</td>
                <td>EUR 0.5–0.9 B</td>
                <td>EUR 1.2–3.8 M</td>
            </tr>
            <tr>
                <td>Netherlands</td>
                <td>EUR 0.8–1.1 B</td>
                <td>EUR 0.35–0.55 B</td>
                <td>EUR 0.7–2.2 M</td>
            </tr>
            <tr>
                <td>Poland</td>
                <td>PLN 4.0–5.2 B</td>
                <td>PLN 1.2–1.9 B</td>
                <td>PLN 3.0–10.0 M</td>
            </tr>
            <tr>
                <td>United States</td>
                <td>USD 8.0–10.5 B</td>
                <td>USD 3.2–4.6 B</td>
                <td>USD 5.5–18.0 M</td>
            </tr>
            <tr>
                <td>GCC UAE and Saudi Arabia</td>
                <td>USD 0.9–1.3 B</td>
                <td>USD 0.5–0.8 B</td>
                <td>USD 1.5–5.0 M</td>
            </tr>
            <tr>
                <td>Singapore</td>
                <td>SGD 140–190 M</td>
                <td>SGD 80–120 M</td>
                <td>SGD 0.6–2.0 M</td>
            </tr>
        </table>
        <p>Reasoning for estimates:</p>
        <ul>
            <li>Values derived by multiplying estimated per-capita consumption ranges by population and applying average retail prices for table potatoes observed in official statistics where available, cross-checked against import values from UN Comtrade and adjusted for retail gross margins. Exact current-year retail values are not available in official open sources; therefore, ranges are provided as directional planning estimates.</li>
        </ul>
        <p>Competitive Landscape</p>
        <p>Observations from official trade and sector publications</p>
        <ul>
            <li>Europe: A fragmented market of producer groups, packers, and private label suppliers serving major retailers. Competition centers on supply reliability, varietal portfolio, washing and sizing capabilities, and category management. Market leaders vary by country and are often cooperatives or regional packers. Official public sources list exporters and importers but do not provide retail share data.</li>
            <li>Non-Europe: In the United States, the category is supplied by domestic growers and packers with strong state-level programs. In GCC, supply is import-dependent with seasonal programs from Europe and South Asia. Competitor visibility is highest at the importer and distributor level in customs data, not at brand level.</li>
        </ul>
        <p>Competitive landscape matrix (Qualitative, data availability constrained)</p>
        <table>
            <tr>
                <td>Region</td>
                <td>Market Structure</td>
                <td>Key Buyer Types</td>
                <td>Noted Competitive Factors</td>
            </tr>
            <tr>
                <th>--------</th>
                <th>------------------</th>
                <th>-----------------</th>
                <th>---------------------------</th>
            </tr>
            <tr>
                <td>EU core markets</td>
                <td>Fragmented grower-packer networks, heavy private label</td>
                <td>National grocers, discounters, wholesaler platforms</td>
                <td>Year-round availability, price per kg, varietal specs, private label service levels</td>
            </tr>
            <tr>
                <td>UK</td>
                <td>High private label, rigorous specs</td>
                <td>Big 4 grocers, discounters, convenience chains</td>
                <td>BRCGS compliance, sustainability claims, in-store waste reduction</td>
            </tr>
            <tr>
                <td>US</td>
                <td>Integrated grower-packers by state</td>
                <td>Grocery chains, club, foodservice distributors</td>
                <td>Domestic origin preference, varietal branding, MAP packaging</td>
            </tr>
            <tr>
                <td>GCC</td>
                <td>Importer-led, consolidated retail</td>
                <td>Modern grocers, HORECA distributors</td>
                <td>Cold chain reliability, origin switching agility, certifications</td>
            </tr>
            <tr>
                <td>Singapore</td>
                <td>Import hub, premiumization</td>
                <td>Supermarkets, e-grocery</td>
                <td>Food safety, small pack formats, mixed-origin programs</td>
            </tr>
        </table>
        <p>Regulatory Environment</p>
        <ul>
            <li>EU food safety framework: General Food Law Regulation (EC) No 178/2002; farm-to-fork traceability; hygiene Regulations (EC) No 852/2004 and 853/2004; Maximum Residue Levels under Regulation (EC) No 396/2005; plant health requirements under Regulation (EU) 2016/2031; marketing standards for fresh produce under Regulation (EU) No 543/2011. CE marking does not apply to potatoes as it is for certain product categories; however, packaging materials and equipment must comply with EU food contact materials Regulation (EC) No 1935/2004 and GMP Regulation (EC) No 2023/2006. GDPR applies to consumer data captured through loyalty or digital marketing. Official references listed below.</li>
            <li>United Kingdom: Retained EU food law under UK Food Safety Act and UKMRLs; DEFRA plant health import requirements, and plant passporting where applicable.</li>
            <li>United States: FDA FSMA Produce Safety Rule for farms, Preventive Controls for packing; USDA APHIS plant import rules; state-level grading standards; Country of Origin Labelling as applicable.</li>
            <li>GCC: Gulf Standardization Organization food safety and labeling standards; local municipality approvals; import permits and phytosanitary certificates. Requirements vary by UAE and Saudi Arabia.</li>
            <li>Singapore: Singapore Food Agency regulations on fresh produce importation, labeling, and pesticide residue limits aligned to international Codex where applicable.</li>
        </ul>
        <p>Consumer Analysis</p>
        <ul>
            <li>Europe: High household penetration with stable volumes; trading up into convenience cuts, smaller pack sizes, and sustainability cues such as reduced plastic and lower food waste. Discounters drive price competition while national grocers push premium and convenience tiers. Seasonality and local origin preferences are strong in France, Germany, and the UK.</li>
            <li>US: Per-capita consumption stable to slightly declining in raw form but value growth in small-format, microwave, and specialty varieties. Consumers respond to varietal naming and cooking-use labeling.</li>
            <li>GCC and Singapore: High reliance on imports; strong acceptance of washed and ready-to-cook formats; smaller households drive 1 kg and sub-1 kg pack sizes.</li>
        </ul>
        <p>Distribution Channels</p>
        <ul>
            <li>Europe: Modern trade is dominant for packaged potatoes via national retailers and discounters. Wholesale markets serve independents and foodservice. Cross-border within EU single market facilitates transshipment to retailer DCs in Germany, France, and the Netherlands. Contracting often done annually with in-season adjustments.</li>
            <li>UK: Direct-to-retail via accredited packers, strict supplier performance KPIs, OTIF metrics.</li>
            <li>US: Regional DC programs with slotting and promotional funds; club and e-commerce formats for bagged potatoes.</li>
            <li>GCC: Importer-distributor led; retail programs managed by 3 to 4 national chains per country; foodservice distributors anchor volume.</li>
            <li>Singapore: Centralized importers, consolidated retail, and e-grocers; high cold chain standards.</li>
        </ul>
        <p>Pricing Strategies</p>
        <ul>
            <li>Europe: Good-better-best laddering with private label economy nets, branded mid-tier washed, and premium varietals. Promotional cadence every 4 to 6 weeks. Discounters require high volume and low net price with efficient logistics.</li>
            <li>Non-Europe: United States supports premium for convenience and varietal branding. GCC and Singapore tolerate higher landed prices when availability and quality are consistent. Currency hedging advisable when pricing in USD for GCC and SGD in Singapore.</li>
        </ul>
        <p>Technology Trends and Innovation</p>
        <ul>
            <li>Packhouse automation for optical grading and defect detection; retail-ready packaging to cut in-store labor.</li>
            <li>Modified atmosphere packaging and micro-perf films to extend shelf life in long-haul export lanes.</li>
            <li>On-pack QR traceability supporting sustainability storytelling and compliance.</li>
        </ul>
        <p>Risk Assessment</p>
        <ul>
            <li>Supply risk: Weather variability and disease pressures impact yields; mitigated by multi-origin sourcing and storage investments.</li>
            <li>Food safety and compliance risk: Strict MRL and traceability requirements; mitigated via GAP, GLOBALG.A.P., BRCGS, and robust QA systems.</li>
            <li>Market access risk: Tariff and non-tariff barriers outside EU; mitigated via local import partners and pre-clearance.</li>
            <li>Currency risk: EUR vs USD and GBP volatility; mitigated via forward contracts and natural hedges.</li>
            <li>Retail concentration risk: High buyer power; mitigated via channel diversification into e-grocery and foodservice.</li>
            <li>Logistics risk: Reefer capacity and port congestion; mitigated via contracted carriers and buffer inventory in cold stores.</li>
        </ul>
        <p>Risk assessment matrix</p>
        <table>
            <tr>
                <td>Risk</td>
                <td>Likelihood</td>
                <td>Impact</td>
                <td>Mitigation</td>
            </tr>
            <tr>
                <th>------</th>
                <th>------------</th>
                <th>--------</th>
                <th>------------</th>
            </tr>
            <tr>
                <td>Weather-driven supply shortfall</td>
                <td>High</td>
                <td>High</td>
                <td>Multi-origin sourcing, storage, contracted growers</td>
            </tr>
            <tr>
                <td>Food safety non-compliance</td>
                <td>Medium</td>
                <td>High</td>
                <td>Certification stack, residue testing program, supplier audits</td>
            </tr>
            <tr>
                <td>Retail de-listing</td>
                <td>Medium</td>
                <td>High</td>
                <td>Service level KPIs, joint business plans, promotional support</td>
            </tr>
            <tr>
                <td>Currency volatility</td>
                <td>Medium</td>
                <td>Medium</td>
                <td>Hedging policy, multi-currency pricing</td>
            </tr>
            <tr>
                <td>Logistics disruption</td>
                <td>Medium</td>
                <td>Medium</td>
                <td>Multi-carrier contracts, safety stock in regional DC cold stores</td>
            </tr>
        </table>
        <p>Budget Recommendations</p>
        <p>All figures are planning ranges for a medium enterprise entering 6 EU markets plus 3 non-EU beachheads. Exact spend depends on confirmed retailer programs and capacity. Estimates benchmarked to typical FMCG produce category entry costs and logistics benchmarks. Currency EUR unless noted.</p>
        <br>
        <ul>
            <li>Total 12-month expansion budget: EUR 9.5–13.5 million (Estimate)</li>
            <li>Allocation by region: Europe 60 percent, Non-Europe 40 percent (Estimate)</li>
            <li>Cost breakdown and rationale:</li>
            <li>Sourcing and packhouse partnerships: EUR 2.0–3.0 M to secure contracted volumes, washing, grading, and packing capacity near target markets. Essential to meet retailer specs.</li>
            <li>Certifications and compliance: EUR 0.3–0.5 M for GLOBALG.A.P., BRCGS, residue testing, and audits across multiple sites.</li>
            <li>Logistics and cold chain: EUR 2.2–3.0 M for reefer road within EU, sea freight to GCC and Singapore, buffer cold storage, and DC handling fees. Cost sensitive to diesel and ocean rates.</li>
            <li>Trade marketing and retail onboarding: EUR 1.8–2.6 M for listings, planograms, in-store POS, and promotional funds in EU and UK; slotting and promotional accruals in the US where pursued.</li>
            <li>Market development and sales: EUR 1.2–1.8 M for country managers, key account heads, and technical agronomists.</li>
            <li>Working capital for inventory and receivables: EUR 1.8–2.6 M to support 30 to 45 day payment terms and seasonal stock.</li>
            <li>Contingency: EUR 0.2–0.5 M set aside for inflation, logistics spikes, or product rework.</li>
        </ul>
        <p>Budget allocation recommendations table</p>
        <table>
            <tr>
                <td>Category</td>
                <td>Europe Allocation (Estimate)</td>
                <td>Non-Europe Allocation (Estimate)</td>
                <td>Notes</td>
            </tr>
            <tr>
                <th>---------</th>
                <th>-------------------------------</th>
                <th>----------------------------------</th>
                <th>-------</th>
            </tr>
            <tr>
                <td>Sourcing and packing</td>
                <td>EUR 1.2–1.8 M</td>
                <td>EUR 0.8–1.2 M</td>
                <td>EU packers near retailer DCs; export-grade packing for GCC and Singapore</td>
            </tr>
            <tr>
                <td>Certifications and QA</td>
                <td>EUR 0.2–0.3 M</td>
                <td>EUR 0.1–0.2 M</td>
                <td>GLOBALG.A.P., BRCGS, residue testing</td>
            </tr>
            <tr>
                <td>Logistics and cold chain</td>
                <td>EUR 1.3–1.8 M</td>
                <td>EUR 0.9–1.2 M</td>
                <td>Road EU, sea reefer non-EU, storage buffers</td>
            </tr>
            <tr>
                <td>Trade marketing and listings</td>
                <td>EUR 1.2–1.7 M</td>
                <td>EUR 0.6–0.9 M</td>
                <td>Retail onboarding, POS, promos, US slotting if pursued</td>
            </tr>
            <tr>
                <td>Sales and market development</td>
                <td>EUR 0.8–1.2 M</td>
                <td>EUR 0.4–0.6 M</td>
                <td>KAMs, merchandisers, technical support</td>
            </tr>
            <tr>
                <td>Working capital</td>
                <td>EUR 1.0–1.5 M</td>
                <td>EUR 0.8–1.1 M</td>
                <td>Inventory and AR funding</td>
            </tr>
            <tr>
                <td>Contingency</td>
                <td>EUR 0.1–0.3 M</td>
                <td>EUR 0.1–0.2 M</td>
                <td>Risk buffer</td>
            </tr>
        </table>
        <p>Strategic Recommendations</p>
        <ul>
            <li>Europe-first phased entry</li>
            <li>Prioritize Germany, France, Netherlands, Poland, Spain, and the UK based on category size, packaging penetration, and retailer concentration.</li>
            <li>Lead with private label co-packing to secure volume and cash flow; build branded potato in premium washed and convenience SKUs where retailers allow dual-sourcing.</li>
            <li>Establish near-market packing partners with BRCGS certification and invest in optical grading to meet strict defect tolerances.</li>
            <li>Non-EU focused beachheads</li>
            <li>United States: Pilot with regional retailers or club in the Northeast or Midwest via an importer-packer partner. Focus on varietal branding and convenience packs.</li>
            <li>GCC: Secure importer-distributor relationships in UAE and Saudi Arabia for year-round programs; emphasize consistent quality and residue compliance.</li>
            <li>Singapore: Target premium retailers and e-grocers with small pack SKUs and air-sea combined logistics during seasonal gaps.</li>
            <li>Sourcing and supply resilience</li>
            <li>Contract multi-origin EU growers and invest in storage to bridge seasonal gaps; validate backup origins for export seasons.</li>
            <li>Compliance and sustainability</li>
            <li>Build an integrated compliance stack: GLOBALG.A.P., BRCGS, and a documented residue testing plan benchmarked to EU MRLs. Add on-pack traceability via QR and publish sustainability metrics.</li>
            <li>Pricing and promotions</li>
            <li>Deploy a good-better-best architecture: economy private label, branded mid-tier washed, and premium varietal lines. Maintain EDLP with tactical feature-price promotions every 4 to 6 weeks in EU, quarterly in non-EU.</li>
            <li>Partnership model</li>
            <li>In each market, appoint a lead importer or 3PL with KPI-based contracts for service levels and waste minimization. Use joint business planning with top retailers.</li>
        </ul>
        <p>Implementation Plan</p>
        <p>90-day action plan</p>
        <table>
            <tr>
                <td>Workstream</td>
                <td>Weeks 1–4</td>
                <td>Weeks 5–8</td>
                <td>Weeks 9–12</td>
            </tr>
            <tr>
                <th>------------</th>
                <th>-----------</th>
                <th>-----------</th>
                <th>------------</th>
            </tr>
            <tr>
                <td>Market selection and retail pipeline</td>
                <td>Confirm priority markets and target retailer lists; initiate NDA and supplier onboarding forms</td>
                <td>Submit RFI and vendor applications; schedule technical audits</td>
                <td>Negotiate pilot programs, confirm planograms and timelines</td>
            </tr>
            <tr>
                <td>Sourcing and packing</td>
                <td>Lock provisional grower contracts; select two EU packers with BRCGS</td>
                <td>Validate varietal specs, run trial washes and packs; set QA SOPs</td>
                <td>Finalize annual supply contracts; book production slots</td>
            </tr>
            <tr>
                <td>Compliance and QA</td>
                <td>Gap analysis against GLOBALG.A.P. and BRCGS; design residue testing plan</td>
                <td>Conduct internal audits; appoint accredited labs</td>
                <td>Close corrective actions; obtain certifications or letters of intent</td>
            </tr>
            <tr>
                <td>Logistics and DC setup</td>
                <td>RFQ for road and sea reefer; shortlist carriers; plan cold storage buffers</td>
                <td>Pilot shipments and lead time validation; set OTIF KPIs</td>
                <td>Finalize SLAs; integrate EDI with retailer DCs</td>
            </tr>
            <tr>
                <td>Brand and packaging</td>
                <td>Finalize brand architecture and pack designs; validate food contact compliance</td>
                <td>Print packaging; develop POS and category education</td>
                <td>Launch pre-store trials; gather feedback for adjustments</td>
            </tr>
            <tr>
                <td>Finance and risk</td>
                <td>Approve budget envelope; set FX hedging policy</td>
                <td>Establish credit limits with buyers; set AR policies</td>
                <td>Confirm trade credit insurance; activate working capital lines</td>
            </tr>
            <tr>
                <td>Organization and hiring</td>
                <td>Appoint EU KAM lead and technical QA manager</td>
                <td>Hire merchandisers for Germany and France</td>
                <td>Train field teams; define reporting cadence</td>
            </tr>
        </table>
        <p>Sources &amp; References</p>
        <ul>
            <li>Eurostat. Crops Production in EU by Species, latest dataset. Publication years 2023 and 2024 depending on crop cycle. Provides production trends and context for EU potato sector. URL: https://ec.europa.eu/eurostat</li>
            <li>Eurostat. HICP Food Indices for EU Member States, 2023–2025 releases. Context for retail price evolution affecting potatoes. URL: https://ec.europa.eu/eurostat</li>
            <li>UN Comtrade. International Trade Statistics Database, HS 0701 Potatoes, fresh or chilled. Annual trade flows by country, latest data 2023 with rolling 2024 updates where available. URL: https://comtradeplus.un.org</li>
            <li>FAO, FAOSTAT and Food Balance Sheets. Potatoes production, imports, and per-capita supply, latest available 2022–2023 editions. URL: https://www.fao.org/faostat</li>
            <li>European Commission. General Food Law Regulation (EC) No 178/2002 and related hygiene and plant health regulations. Consolidated versions accessed 2024–2025. EUR-Lex: https://eur-lex.europa.eu</li>
            <li>European Commission. Regulation (EC) No 396/2005 on Maximum Residue Levels of pesticides in or on food and feed of plant and animal origin. Consolidated text accessed 2024–2025. EUR-Lex.</li>
            <li>Regulation (EU) 2016/2031 on protective measures against plant pests. EUR-Lex access 2024–2025.</li>
            <li>Regulation (EC) No 1935/2004 and Regulation (EC) No 2023/2006 on materials and articles intended to come into contact with food. EUR-Lex access 2024–2025.</li>
            <li>Food and Drug Administration, United States. FSMA Produce Safety Rule and Preventive Controls Rule. Guidance documents updated 2023–2025. URL: https://www.fda.gov</li>
            <li>USDA APHIS. Import requirements for potatoes and plant products. Accessed 2024–2025. URL: https://www.aphis.usda.gov</li>
            <li>UK Food Standards Agency and DEFRA. Food Safety and plant health import controls. Accessed 2024–2025. URLs: https://www.food.gov.uk and https://www.gov.uk/defra</li>
            <li>Singapore Food Agency. Import of fruits and vegetables licensing and MRLs. Accessed 2024–2025. URL: https://www.sfa.gov.sg</li>
            <li>Gulf Standardization Organization. Food standards and labeling requirements. Accessed 2024–2025. URL: https://www.gso.org.sa</li>
        </ul>
        <p>Notes on data limitations</p>
        <ul>
            <li>Branded and private label retail shares, detailed pricing ladders by SKU, and retailer-specific volumes are not published by the listed official sources and typically require paid retail scanner panels. All market sizing values herein are planning Estimates derived from official macro data and transparent assumptions. Further refinement is recommended after retailer range reviews and test shipments.</li>
        </ul>
        <div class="footer">
            <p>This report was generated using AI-powered market research technology.</p>
            <p>For questions or additional analysis, please contact your research team.</p>
        </div>
    </div>
    
    <script>
        // Define the function immediately when script loads
        function downloadPDF() {
            const element = document.getElementById('report-content');
            
            // Show loading state
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '⏳ Generating PDF...';
            btn.disabled = true;
           
           // Wait for fonts and images to load
           setTimeout(function() {
               // First, ensure the element is visible and has content
               if (!element || element.offsetHeight === 0 || element.offsetWidth === 0) {
                   alert('Report content not found. Please refresh the page and try again.');
                   btn.innerHTML = originalText;
                   btn.disabled = false;
                   return;
               }
               
               // Ensure the element is visible and has content
               const rect = element.getBoundingClientRect();
               if (rect.width === 0 || rect.height === 0) {
                   alert('Report content is not visible. Please scroll to the report and try again.');
                   btn.innerHTML = originalText;
                   btn.disabled = false;
                   return;
               }
               
               // Force a reflow to ensure content is rendered
               element.style.display = 'none';
               element.offsetHeight; // Trigger reflow
               element.style.display = 'block';
               
               // Ensure all content is visible and expanded
               element.style.height = 'auto';
               element.style.minHeight = '100vh';
               element.style.overflow = 'visible';
               
               // Wait a bit more for any dynamic content to render
               setTimeout(function() {
               
               const opt = {
                   margin: [0.5, 0.5, 0.5, 0.5],
                   filename: 'AI_Trade_Report.pdf',
                   image: { type: 'jpeg', quality: 0.98 },
                   html2canvas: { 
                       scale: 1.2,
                       useCORS: true,
                       allowTaint: true,
                       backgroundColor: '#ffffff',
                       logging: false,
                       letterRendering: true,
                       width: element.scrollWidth,
                       height: element.scrollHeight,
                       scrollX: 0,
                       scrollY: 0,
                       windowWidth: element.scrollWidth,
                       windowHeight: element.scrollHeight
                   },
                   jsPDF: { 
                       unit: 'in', 
                       format: 'a4', 
                       orientation: 'portrait',
                       compress: true
                   },
                   pagebreak: { mode: ['css', 'legacy'] }
               };
              
              // Debug: Log element dimensions
              console.log('Element dimensions:', {
                  width: element.offsetWidth,
                  height: element.offsetHeight,
                  scrollWidth: element.scrollWidth,
                  scrollHeight: element.scrollHeight,
                  rect: element.getBoundingClientRect()
              });
              
              // Try the main PDF generation
              html2pdf().set(opt).from(element).save().then(function() {
                  btn.innerHTML = originalText;
                  btn.disabled = false;
              }).catch(function(error) {
                  console.error('PDF generation failed:', error);
                  
                  // Fallback: Try with simpler options
                  const simpleOpt = {
                      margin: 0.5,
                      filename: 'AI_Trade_Report.pdf',
                      image: { type: 'jpeg', quality: 0.8 },
                      html2canvas: { 
                          scale: 1,
                          backgroundColor: '#ffffff',
                          width: element.scrollWidth,
                          height: element.scrollHeight,
                          useCORS: true,
                          scrollX: 0,
                          scrollY: 0
                      },
                      jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
                  };
                  
                  html2pdf().set(simpleOpt).from(element).save().then(function() {
                      btn.innerHTML = originalText;
                      btn.disabled = false;
                  }).catch(function(fallbackError) {
                      console.error('Fallback PDF generation also failed:', fallbackError);
                      alert('PDF generation failed. Please use the Print button and save as PDF from your browser instead.');
                      btn.innerHTML = originalText;
                      btn.disabled = false;
                  });
              });
          }, 500);
      }, 1000);
  }
  
  // Also make it available on window object
  window.downloadPDF = downloadPDF;
  
  // Save report function
  // Track if report is saved
  let isReportSaved = false;
  
  function saveReport() {
      console.log('Save report function called');
      
      const btn = event.target.closest('.action-btn');
      if (!btn) {
          console.error('Save button not found');
          return;
      }
      
      // Check if already saved
      if (isReportSaved) {
          btn.innerHTML = '✅ Already Saved';
          btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
          btn.disabled = true;
          
          setTimeout(() => {
              btn.innerHTML = '💾 Save';
              btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
              btn.disabled = false;
          }, 2000);
          return;
      }
      
      const originalText = btn.innerHTML;
      
      // Show loading state
      btn.innerHTML = '⏳ Saving...';
      btn.disabled = true;
      
      try {
          // Get report data
          const reportTitle = document.querySelector('h1')?.textContent || 'AI Trade Report';
          const reportContent = document.getElementById('report-content')?.innerHTML || '';
          const currentUrl = window.location.pathname;
          const filename = currentUrl.split('/').pop() || 'unknown_report.html';
          
          console.log('Report data extracted:', {
              title: reportTitle,
              filename: filename,
              contentLength: reportContent.length
          });
          
          // Extract report metadata from URL or page
          const brand = document.querySelector('.summary-item:nth-child(1) .item-value')?.textContent || 'Unknown Brand';
          const product = document.querySelector('.summary-item:nth-child(2) .item-value')?.textContent || 'Unknown Product';
          const budget = document.querySelector('.summary-item:nth-child(3) .item-value')?.textContent || 'Unknown Budget';
          const enterpriseSize = document.querySelector('.summary-item:nth-child(4) .item-value')?.textContent || 'Unknown Size';
          
          // Prepare data for API
          const reportData = {
              title: reportTitle,
              brand: brand,
              product: product,
              budget: budget,
              enterprise_size: enterpriseSize,
              ai_model: 'gpt-5',
              language: 'en',
              content: reportContent,
              file_path: filename
          };
          
          console.log('Sending data to API:', reportData);
          
          // Send to database
          fetch('/save-report', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify(reportData)
          })
          .then(response => {
              console.log('API response status:', response.status);
              if (!response.ok) {
                  throw new Error(`HTTP error! status: ${response.status}`);
              }
              return response.json();
          })
          .then(data => {
              console.log('API response data:', data);
              if (data.status === 'success') {
                  isReportSaved = true; // Mark as saved
                  btn.innerHTML = '✅ Saved!';
                  btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                  
                  setTimeout(() => {
                      btn.innerHTML = '💾 Save';
                      btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
                      btn.disabled = false;
                  }, 2000);
              } else {
                  throw new Error(data.message || 'Failed to save report');
              }
          })
          .catch(error => {
              console.error('Error saving report:', error);
              btn.innerHTML = '❌ Error';
              btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
              
              setTimeout(() => {
                  btn.innerHTML = originalText;
                  btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
                  btn.disabled = false;
              }, 3000);
          });
      } catch (error) {
          console.error('Error in saveReport function:', error);
          btn.innerHTML = '❌ Error';
          btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
          
          setTimeout(() => {
              btn.innerHTML = originalText;
              btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
              btn.disabled = false;
          }, 3000);
      }
  }
  
  // Return to main page function
  function returnToMain() {
      if (isReportSaved) {
          // If report is saved, go directly without warning
          window.location.href = '/';
      } else {
          // If not saved, show warning
          if (confirm('Are you sure you want to return to the main page? Your current report will be lost.')) {
              window.location.href = '/';
          }
      }
  }
  
  // Make functions available globally
  window.saveReport = saveReport;
  window.returnToMain = returnToMain;
 
          // Hide header when printing
  window.addEventListener('beforeprint', function() {
      const header = document.querySelector('.report-header');
      if (header) header.style.display = 'none';
  });
  
  window.addEventListener('afterprint', function() {
      const header = document.querySelector('.report-header');
      if (header) header.style.display = 'block';
  });
  
  // Ensure function is available when DOM is ready
  document.addEventListener('DOMContentLoaded', function() {
      // Function should be available now
      if (typeof downloadPDF === 'function') {
          console.log('downloadPDF function is ready');
      } else {
          console.error('downloadPDF function not properly defined');
      }
  });
  
  // Also try to make it available immediately
  if (typeof downloadPDF === 'function') {
      console.log('downloadPDF function loaded successfully');
  }
    </script>
</body>
</html>