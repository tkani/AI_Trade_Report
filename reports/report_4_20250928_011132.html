<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Trade Report - Professional Market Analysis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        html, body {
            font-family: 'Times New Roman', serif;
            font-size: 12pt;
            line-height: 1.5;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
            width: 100%;
            min-width: 100%;
            box-sizing: border-box;
        }
        .container {
            width: 100vw;
            min-width: 100%;
            margin: 0;
            background: white;
            padding: 40px;
            border-radius: 0;
            box-shadow: none;
            box-sizing: border-box;
        }
        h1 {
            color: #2c3e50;
            font-weight: bold;
            font-size: 18pt;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        h2 {
            color: #34495e;
            font-weight: bold;
            font-size: 16pt;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 30px;
            margin-bottom: 20px;
        }
        h3 {
            color: #2c3e50;
            font-weight: bold;
            font-size: 14pt;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        h4 {
            color: #7f8c8d;
            font-weight: bold;
            font-size: 12pt;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        ul, ol {
            margin-bottom: 15px;
            padding-left: 30px;
            line-height: 1.5;
        }
        li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        /* Professional bullet points */
        ul li {
            list-style-type: disc;
            margin-left: 20px;
        }
        ul ul li {
            list-style-type: circle;
        }
        ul ul ul li {
            list-style-type: square;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #e8f4f8;
        }
        .highlight {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
        }
        .summary-box {
            background-color: #d4edda;
            padding: 20px;
            border-left: 4px solid #28a745;
            margin: 20px 0;
            border-radius: 4px;
        }
        .warning-box {
            background-color: #f8d7da;
            padding: 15px;
            border-left: 4px solid #dc3545;
            margin: 20px 0;
            border-radius: 4px;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ecf0f1;
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
        }
        /* Professional Report Header */
        .report-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 1rem 0;
        }
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .header-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            font-size: 1.25rem;
            color: #1f2937;
        }
        .header-brand .brand-icon {
            font-size: 1.5rem;
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header-actions {
            display: flex;
            gap: 0.75rem;
        }
        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .action-btn:active {
            transform: translateY(0);
        }
        .action-btn.print {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        .action-btn.pdf {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        /* Hide download button on mobile devices */
        @media (max-width: 768px) {
            .action-btn.pdf {
                display: none !important;
            }
        }
        .action-btn.save {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }
        .action-btn.home {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        .btn-icon {
            font-size: 1rem;
        }
        .btn-text {
            font-size: 0.875rem;
        }
        
        /* Report Title Section */
        .report-title-section {
            text-align: center;
            margin-bottom: 2rem;
            padding-top: 6rem;
        }
        .title-underline {
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, #2563eb, #7c3aed);
            margin: 1rem auto 0;
            border-radius: 2px;
        }
        
        /* Enhanced Summary Box */
        .summary-box {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border: 1px solid #bae6fd;
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .summary-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #0369a1;
            font-size: 1.125rem;
        }
        .summary-icon {
            font-size: 1.25rem;
        }
        .summary-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        .summary-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        .item-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .item-value {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
        }
                 @media print {
             body { 
                 background-color: white !important; 
                 color: black !important;
                 font-size: 12pt;
                 line-height: 1.4;
                 margin: 0 !important;
                 padding: 0 !important;
                 width: 100% !important;
             }
             .container { 
                 box-shadow: none !important; 
                 background: white !important;
                 padding: 20px !important;
                 margin: 0 !important;
                 width: 100% !important;
                 min-width: 100% !important;
                 max-width: none !important;
                 box-sizing: border-box !important;
                 height: auto !important;
                 min-height: 100vh !important;
             }
             .report-header { display: none !important; }
             .action-buttons { display: none !important; }
             h1, h2, h3, h4 { 
                 color: black !important; 
                 page-break-after: avoid;
                 page-break-inside: avoid;
             }
             table { 
                 page-break-inside: avoid; 
                 border-collapse: collapse !important;
             }
             .summary-box, .highlight, .warning-box {
                 background: #f8f9fa !important;
                 border: 1px solid #ddd !important;
                 color: black !important;
                 page-break-inside: avoid;
             }
             p, li {
                 page-break-inside: avoid;
                 orphans: 3;
                 widows: 3;
             }
             .footer {
                 page-break-inside: avoid;
             }
         }
        /* ===== MOBILE RESPONSIVE DESIGN ===== */
        @media (max-width: 1200px) {
            .header-content {
                padding: 0 1.5rem;
            }
            .container {
                padding: 30px;
            }
        }
        
        @media (max-width: 768px) {
            /* Mobile Header */
            .report-header {
                padding: 0.75rem 0;
            }
            .header-content {
                padding: 0 1rem;
                flex-direction: column;
                gap: 0.75rem;
                align-items: center;
            }
            .header-brand {
                font-size: 1.125rem;
            }
            .header-actions {
                width: 100%;
                justify-content: center;
                gap: 0.5rem;
                flex-wrap: wrap;
            }
            .action-btn {
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
                flex: 1;
                max-width: 120px;
                display: flex;
                align-items: center;
                gap: 0.375rem;
            }
            .btn-text {
                font-size: 0.8125rem;
                display: inline !important;
            }
            
            /* Mobile Container */
            .container {
                padding: 20px 15px;
                margin-top: 120px; /* Account for taller mobile header */
            }
            
            /* Mobile Typography */
            h1 {
                font-size: 1.75rem;
                margin-bottom: 20px;
            }
            h2 {
                font-size: 1.375rem;
                margin-top: 25px;
                margin-bottom: 15px;
            }
            h3 {
                font-size: 1.125rem;
                margin-top: 20px;
                margin-bottom: 12px;
            }
            h4 {
                font-size: 1rem;
                margin-top: 15px;
                margin-bottom: 8px;
            }
            p {
                font-size: 0.9375rem;
                line-height: 1.6;
                margin-bottom: 12px;
            }
            
            /* Mobile Tables */
            table {
                font-size: 0.875rem;
                margin: 15px 0;
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }
            th, td {
                padding: 8px 6px;
                min-width: 80px;
            }
            th {
                font-size: 0.8125rem;
            }
            
            /* Mobile Lists */
            ul, ol {
                padding-left: 20px;
                margin-bottom: 12px;
            }
            li {
                font-size: 0.9375rem;
                margin-bottom: 6px;
                line-height: 1.5;
            }
            
            /* Mobile Boxes */
            .summary-box, .highlight, .warning-box {
                padding: 15px;
                margin: 15px 0;
                border-radius: 8px;
            }
            .summary-content {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            .summary-item {
                padding: 8px 0;
            }
            .item-label {
                font-size: 0.8125rem;
            }
            .item-value {
                font-size: 0.9375rem;
            }
            
            /* Mobile Code Blocks */
            .code-block {
                padding: 12px;
                font-size: 0.8125rem;
                margin: 12px 0;
                border-radius: 6px;
            }
            
            /* Mobile Footer */
            .footer {
                margin-top: 30px;
                padding-top: 15px;
                font-size: 0.8125rem;
            }
        }
        
        @media (max-width: 480px) {
            /* Extra Small Mobile */
            .container {
                padding: 15px 10px;
                margin-top: 140px;
            }
            
            .header-content {
                padding: 0 0.75rem;
            }
            .header-brand {
                font-size: 1rem;
            }
            .action-btn {
                padding: 0.375rem 0.5rem;
                font-size: 0.6875rem;
                max-width: 100px;
                display: flex;
                align-items: center;
                gap: 0.25rem;
            }
            .btn-text {
                font-size: 0.75rem;
                display: inline !important;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            h2 {
                font-size: 1.25rem;
            }
            h3 {
                font-size: 1.0625rem;
            }
            
            table {
                font-size: 0.8125rem;
            }
            th, td {
                padding: 6px 4px;
                min-width: 70px;
            }
            
            .summary-box, .highlight, .warning-box {
                padding: 12px;
                margin: 12px 0;
            }
            
            .code-block {
                padding: 10px;
                font-size: 0.75rem;
            }
        }
        
        /* Mobile Print Optimizations */
        @media print and (max-width: 768px) {
            .container {
                padding: 15px !important;
                margin: 0 !important;
                width: 100% !important;
            }
            h1, h2, h3, h4 {
                page-break-after: avoid;
                font-size: 1.2em;
            }
            table {
                font-size: 0.8em;
                page-break-inside: avoid;
            }
            .summary-box, .highlight, .warning-box {
                page-break-inside: avoid;
                margin: 10px 0;
            }
        }
        @media screen {
            body {
                margin: 0;
                padding: 0;
            }
        }
        
        /* Saved Reports Section Styles */
        .saved-reports-section {
            padding: 2rem 0;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 400px;
        }
        
        .saved-reports-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin: 0 auto;
            max-width: 1200px;
        }
        
        .saved-reports-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .saved-reports-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .title-icon {
            font-size: 1.5rem;
        }
        
        .saved-reports-subtitle {
            color: #64748b;
            font-size: 1rem;
            margin: 0;
        }
        
        .saved-reports-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .saved-report-item {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .saved-report-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #3b82f6;
        }
        
        .saved-report-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        }
        
        .report-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .report-item-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
            line-height: 1.4;
        }
        
        .report-item-date {
            font-size: 0.875rem;
            color: #64748b;
            white-space: nowrap;
        }
        
        .report-item-details {
            margin-bottom: 1rem;
        }
        
        .report-detail-row {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        
        .report-detail-label {
            font-weight: 500;
            color: #475569;
            min-width: 80px;
            margin-right: 0.5rem;
        }
        
        .report-detail-value {
            color: #1e293b;
            flex: 1;
        }
        
        .report-item-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .report-action-btn {
            flex: 1;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.375rem;
        }
        
        .report-action-btn.primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        
        .report-action-btn.primary:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-1px);
        }
        
        .report-action-btn.secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }
        
        .report-action-btn.secondary:hover {
            background: #e2e8f0;
            border-color: #cbd5e1;
        }
        
        .no-reports-message {
            text-align: center;
            padding: 3rem 2rem;
            color: #64748b;
        }
        
        .no-reports-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .no-reports-message h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #475569;
            margin-bottom: 0.5rem;
        }
        
        .no-reports-message p {
            font-size: 1rem;
            margin: 0;
        }
        
        .saved-reports-toggle {
            background: none;
            border: none;
            color: inherit;
            font-size: inherit;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .saved-reports-toggle:hover {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }
        
        .saved-reports-toggle.active {
            background: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }
        
        .nav-icon {
            font-size: 1rem;
        }
        
        /* Mobile Responsive for Saved Reports */
        @media (max-width: 768px) {
            .saved-reports-list {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .saved-report-item {
                padding: 1rem;
            }
            
            .report-item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .report-item-actions {
                flex-direction: column;
            }
            
            .saved-reports-card {
                padding: 1.5rem;
                margin: 0 1rem;
            }
            
        .saved-reports-title {
            font-size: 1.5rem;
        }
    }
    
    /* Loading and Error States */
    .loading-reports {
        text-align: center;
        padding: 2rem;
        color: #64748b;
        font-size: 1rem;
    }
    
        .error-message {
        text-align: center;
        padding: 2rem;
        color: #dc2626;
        font-size: 1rem;
        }

        /* Custom styles for Bootstrap modal enhancements */
        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .modal-header .btn-close {
            filter: invert(1);
        }

        .sortable {
            cursor: pointer;
            user-select: none;
        }

        .sortable:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .sort-indicator {
            margin-left: 8px;
            opacity: 0.5;
            transition: all 0.2s ease;
        }

        .sortable.asc .sort-indicator {
            opacity: 1;
            transform: rotate(180deg);
        }

        .sortable.desc .sort-indicator {
            opacity: 1;
        }

        /* Custom Navbar Styles */
        .navbar {
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 0.75rem 0;
        }

        .navbar-brand {
            font-size: 1.5rem;
            color: #333 !important;
        }

        .navbar-brand .brand-logo-img {
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .navbar-nav .btn {
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s ease;
            padding: 0.5rem 1rem;
        }

        .navbar-nav .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .navbar-nav .btn-outline-primary:hover {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }

        .navbar-nav .btn-outline-secondary:hover {
            background-color: #6c757d;
            border-color: #6c757d;
        }

        .navbar-nav .btn-outline-danger:hover {
            background-color: #dc3545;
            border-color: #dc3545;
        }

        /* Responsive navbar */
        @media (max-width: 768px) {
            .navbar-brand {
                font-size: 1.25rem;
            }
            
            .navbar-nav .btn {
                margin-bottom: 0.5rem;
                width: 100%;
            }
            
            .navbar-nav {
                margin-top: 1rem;
            }
        }

        /* Scrollable Table Styles */
        .table-responsive {
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .table-responsive::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .table-responsive::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .table-responsive::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        .table-responsive::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .sticky-top {
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .table th {
            white-space: nowrap;
            font-weight: 600;
        }

        .table td {
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <!-- Professional Report Header -->
    <header class="report-header">
        <div class="header-content">
            <div class="header-brand">
                <img src="/static/logo_trade_on_chain.png" alt="AI Trade Report" class="brand-logo" style="height: 32px; width: auto; margin-right: 12px;">
                <img src="/static/logo2.png" alt="AI Trade Report" class="brand-logo" style="height: 32px; width: auto; margin-right: 12px;">
                <span class="brand-text">AI Trade Report</span>
            </div>
            <div class="header-actions">
                <button class="action-btn save" onclick="saveReport()">
                    <span class="btn-icon">💾</span>
                    <span class="btn-text">Save</span>
                </button>
                <button class="action-btn home" onclick="returnToMain()">
                    <span class="btn-icon">🏠</span>
                    <span class="btn-text">Home</span>
                </button>
                <button class="action-btn print" onclick="window.print()">
                    <span class="btn-icon">🖨️</span>
                    <span class="btn-text">Print</span>
                </button>
                <button class="action-btn pdf" onclick="downloadPDF()">
                    <span class="btn-icon">📄</span>
                    <span class="btn-text">Download PDF</span>
                </button>
            </div>
        </div>
    </header>
    
    <div class="container" id="report-content">
        <div class="report-title-section">
            <h1>AI Trade Report</h1>
            <div class="title-underline"></div>
        </div>
        <div class="summary-box">
            <div class="summary-header">
                <span class="summary-icon">📋</span>
                <span class="summary-title">Report Overview</span>
            </div>
            <div class="summary-content">
                <div class="summary-item">
                    <span class="item-label">Generated by:</span>
                    <span class="item-value">AI-Powered Market Research</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">Date:</span>
                    <span class="item-value">28 September 2025</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">Report Type:</span>
                    <span class="item-value">Comprehensive Market Analysis</span>
                </div>
            </div>
        </div>
        <p>Title: Strategic Market Analysis Report for Cherry Tomatoes under the brand &quot;tomato&quot;</p>
        <p>Analysis Date: 28 September 2025</p>
        <br>
        <p>Executive Summary</p>
        <p>This report evaluates market expansion opportunities for cherry tomatoes under the brand &quot;tomato&quot; across European and non-European markets, using publicly available sources and clearly flagged estimates where necessary. Europe remains the largest integrated high-value fresh tomato market with robust retail penetration and advanced logistics, while North America and selected Asia-Pacific markets offer strong growth and margin opportunities. Key EU markets with near-term potential include Germany, France, the Netherlands, Italy, Spain, Poland, and the UK. Outside Europe, the United States, Canada, Japan, South Korea, the United Arab Emirates, and Saudi Arabia present attractive entry opportunities based on import reliance, premium retail channels, and cold-chain infrastructure.</p>
        <br>
        <p>Food safety compliance and labeling will be critical: EU Regulation (EC) No 178/2002 and related hygiene and marketing standards, along with Codex-aligned requirements in non-EU markets. Logistics efficiency, seasonality, and supply diversification are decisive for service levels and cost. Given the client’s Big Enterprise profile, we recommend a scale market entry across priority markets with a phased 90-day execution plan, centralized compliance, and diversified sourcing. Budget recommendations are provided with clear ranges and assumptions to support Board allocation decisions.</p>
        <br>
        <p>Market Overview</p>
        <p>Available official sources confirm the continued significance of tomatoes in global horticulture and trade, though most sources report aggregated tomato data rather than a distinct “cherry tomatoes” category. Where cherry or small tomatoes are separated, data is limited by market. Therefore, market size figures for cherry tomatoes below are estimates, derived as a share of the broader fresh tomato category and supported by retail assortment observations in developed markets. All such figures are explicitly labeled as Estimate.</p>
        <br>
        <p>Selected official market context:</p>
        <ul>
            <li>EU tomato production and trade: Eurostat publishes annual crop statistics and external trade data for tomatoes in aggregate under Combined Nomenclature codes (latest annual publications available; 2023 data coverage ongoing) [Eurostat, Crop statistics in EU, 2024; Eurostat Comext, External trade in tomatoes, 2024].</li>
            <li>International trade flows: UN Comtrade and ITC Trade Map report fresh tomato trade by HS 0702 category at country level [UN Comtrade, HS 0702, accessed 2024–2025].</li>
            <li>Global horticulture and food safety frameworks: Codex Alimentarius and WTO SPS/TBT notifications provide regulatory baselines [WTO SPS Information Management System, accessed 2024–2025; Codex standards, accessed 2024–2025].</li>
        </ul>
        <p>Target Market Analysis</p>
        <p>Note: TAM, SAM, and SOM figures for cherry tomatoes are labeled as Estimate. Reasoning: derived as a percentage of the total fresh tomato retail value market in each country, considering the share of small/snacking tomatoes in modern retail assortments. In developed markets, cherry and small tomatoes typically account for an estimated 15–30 percent of retail tomato value. We use 20–25 percent share for EU-5 and North America, 10–15 percent for emerging markets with lower premium segment penetration. Currency in EUR for cross-market comparability. Exchange assumptions use average 2024–2025 rates from ECB and OECD (qualitative reference only; no point rates reported here).</p>
        <br>
        <table>
            <tr>
                <td>Country</td>
                <td>TAM (Estimate)</td>
                <td>SAM (Estimate)</td>
                <td>SOM Year 1 (Estimate)</td>
            </tr>
            <tr>
                <th>---------</th>
                <th>----------------</th>
                <th>----------------</th>
                <th>-----------------------</th>
            </tr>
            <tr>
                <td>Germany</td>
                <td>1,800–2,400 EUR M</td>
                <td>900–1,200 EUR M</td>
                <td>6–15 EUR M</td>
            </tr>
            <tr>
                <td>France</td>
                <td>1,300–1,800 EUR M</td>
                <td>650–900 EUR M</td>
                <td>4–10 EUR M</td>
            </tr>
            <tr>
                <td>UK</td>
                <td>1,200–1,700 EUR M</td>
                <td>600–850 EUR M</td>
                <td>4–10 EUR M</td>
            </tr>
            <tr>
                <td>Italy</td>
                <td>1,100–1,600 EUR M</td>
                <td>550–800 EUR M</td>
                <td>3–8 EUR M</td>
            </tr>
            <tr>
                <td>Spain</td>
                <td>900–1,300 EUR M</td>
                <td>450–700 EUR M</td>
                <td>3–7 EUR M</td>
            </tr>
            <tr>
                <td>Netherlands</td>
                <td>700–1,000 EUR M</td>
                <td>350–550 EUR M</td>
                <td>3–6 EUR M</td>
            </tr>
            <tr>
                <td>Poland</td>
                <td>500–800 EUR M</td>
                <td>250–400 EUR M</td>
                <td>2–5 EUR M</td>
            </tr>
            <tr>
                <td>United States</td>
                <td>3,500–4,800 EUR M</td>
                <td>1,700–2,400 EUR M</td>
                <td>10–25 EUR M</td>
            </tr>
            <tr>
                <td>Canada</td>
                <td>500–750 EUR M</td>
                <td>250–400 EUR M</td>
                <td>2–6 EUR M</td>
            </tr>
            <tr>
                <td>Japan</td>
                <td>700–1,000 EUR M</td>
                <td>300–450 EUR M</td>
                <td>2–6 EUR M</td>
            </tr>
            <tr>
                <td>South Korea</td>
                <td>400–600 EUR M</td>
                <td>200–350 EUR M</td>
                <td>1–4 EUR M</td>
            </tr>
            <tr>
                <td>UAE</td>
                <td>180–260 EUR M</td>
                <td>90–150 EUR M</td>
                <td>1–3 EUR M</td>
            </tr>
            <tr>
                <td>Saudi Arabia</td>
                <td>250–350 EUR M</td>
                <td>120–200 EUR M</td>
                <td>1–3 EUR M</td>
            </tr>
        </table>
        <p>Estimation method:</p>
        <ul>
            <li>Country fresh tomato retail value base (Estimate) derived from Eurostat household consumption expenditure on food by product categories and UN Comtrade import values for fresh tomatoes in net import markets (2019–2024 trend), scaled to 2024–2025.</li>
            <li>Cherry tomato share applied as described above.</li>
            <li>SAM reflects premium retail channels in urban catchments served by modern grocery and e-commerce, estimated at 50 percent of TAM in developed markets and 40–50 percent in others.</li>
            <li>SOM Year 1 reflects a Big Enterprise launch with multi-retailer listings in top cities, assuming limited initial distribution and conservative velocities.</li>
        </ul>
        <p>Competitive Landscape</p>
        <p>Public official datasets do not enumerate brand-level competitors in cherry tomatoes. The EU market features a mix of:</p>
        <ul>
            <li>Greenhouse producers and cooperatives in the Netherlands, Spain, Italy, Morocco, and Turkey supplying EU retailers.</li>
            <li>Retailer private labels dominant in many markets, supported by large grower-marketer groups.</li>
            <li>Import-reliant non-EU markets such as UAE and Saudi Arabia depending on regional greenhouse operators and airfreight sea-air supply.</li>
        </ul>
        <p>Given the lack of official brand share data, we present a qualitative matrix based on structural characteristics. No market shares are assigned.</p>
        <br>
        <table>
            <tr>
                <td>Company Type</td>
                <td>Presence</td>
                <td>Strengths</td>
                <td>Weaknesses</td>
            </tr>
            <tr>
                <th>--------------</th>
                <th>----------</th>
                <th>-----------</th>
                <th>------------</th>
            </tr>
            <tr>
                <td>EU greenhouse cooperatives</td>
                <td>EU-27, UK</td>
                <td>Scale, year-round supply, certifications, retailer relationships</td>
                <td>Exposure to energy costs, labor constraints</td>
            </tr>
            <tr>
                <td>Dutch and Spanish exporters</td>
                <td>EU-27, UK</td>
                <td>Logistics hubs, category management, assortment breadth</td>
                <td>Margin pressure, retailer consolidation</td>
            </tr>
            <tr>
                <td>Retailer private labels</td>
                <td>EU, UK, North America</td>
                <td>Shelf access, pricing power, consumer trust</td>
                <td>Limited brand differentiation potential for suppliers</td>
            </tr>
            <tr>
                <td>North American greenhouse groups</td>
                <td>US, Canada</td>
                <td>Proximity, large-scale CEA, 52-week programs</td>
                <td>Regional coverage gaps, weather-energy risks</td>
            </tr>
            <tr>
                <td>Middle East regional producers</td>
                <td>GCC</td>
                <td>Shorter lead times, local freshness</td>
                <td>Seasonality, quality variance, water constraints</td>
            </tr>
        </table>
        <p>Regulatory Environment</p>
        <p>European Union</p>
        <ul>
            <li>General Food Law: Regulation (EC) No 178/2002 setting principles of food safety including traceability and responsibility [European Commission, consolidated text, accessed 2024].</li>
            <li>Hygiene package: Regulations (EC) No 852/2004 and 853/2004 on food hygiene requirements [European Commission, accessed 2024].</li>
            <li>Marketing standards for fruit and vegetables: Commission Implementing Regulation (EU) No 543/2011 and related updates defining quality classes, sizing, labeling and presentation for tomatoes [European Commission, accessed 2024].</li>
            <li>Pesticide MRLs: Regulation (EC) No 396/2005 [European Commission, accessed 2024].</li>
            <li>Packaging and labeling: Regulation (EU) No 1169/2011 on food information to consumers [European Commission, accessed 2024].</li>
            <li>Plant health and import controls: Regulation (EU) 2017/625 and associated implementing acts [European Commission, accessed 2024].</li>
            <li>CE marking is not applicable to fresh produce. GDPR applies to consumer data collected for marketing or e-commerce purposes.</li>
        </ul>
        <p>United Kingdom</p>
        <ul>
            <li>UK retained EU law equivalents for food safety and labeling, with import controls phased since 2024 on EU and non-EU products [UK Government, Food standards and border target operating model, 2024].</li>
        </ul>
        <p>United States and Canada</p>
        <ul>
            <li>USA: FDA FSMA Produce Safety Rule for growing, harvesting, packing and holding of produce; FSMA Foreign Supplier Verification Programs for importers [FDA, updated 2024].</li>
            <li>Canada: Safe Food for Canadians Regulations covering preventive controls, traceability, licenses [CFIA, updated 2024].</li>
        </ul>
        <p>Gulf Cooperation Council</p>
        <ul>
            <li>Gulf Standard Organization specifications for labeling and shelf-life; national SFDA requirements in Saudi Arabia and ESMA in UAE on food labeling and MRLs [SFDA, ESMA, accessed 2024–2025].</li>
        </ul>
        <p>Asia</p>
        <ul>
            <li>Japan: Food Sanitation Act with MRLs and import notification; JAS labeling rules [Japan MHLW and MAFF, accessed 2024].</li>
            <li>South Korea: MFDS food safety regulations with MRLs and import inspection [MFDS, accessed 2024].</li>
        </ul>
        <p>Consumer Analysis</p>
        <p>Selected patterns supported by official and sector reports:</p>
        <ul>
            <li>EU households have increased purchases of small and snack vegetables for convenience and health; Eurostat HBS shows steady expenditure on vegetables, with a shift to premium subsegments in higher-income markets post-2020 [Eurostat Household Budget Survey, releases 2023–2024].</li>
            <li>Non-EU urban consumers in North America and Asia-Pacific demonstrate willingness to pay for premium, sweet, snacking tomatoes, particularly in e-commerce and convenience channels [OECD urban consumption insights, 2023–2024].</li>
        </ul>
        <p>Distribution Channels</p>
        <ul>
            <li>Europe: Modern grocery retailing dominates distribution, with strong roles for hypermarkets, supermarkets, discounters, and e-commerce. EU single market facilitates cross-border movement with common standards and reduced internal barriers [European Commission Single Market overview, accessed 2024].</li>
            <li>Non-EU: North America uses integrated grower-shipper programs with DC deliveries and cross-docking. GCC markets rely on importers and wholesale markets alongside modern retail. Japan and South Korea combine centralized retail procurement with high quality and packaging expectations.</li>
        </ul>
        <p>Risk Assessment</p>
        <p>Key risks identified with mitigations. No fabricated probabilities are presented.</p>
        <br>
        <table>
            <tr>
                <td>Risk</td>
                <td>Impact</td>
                <td>Likelihood</td>
                <td>Mitigation</td>
            </tr>
            <tr>
                <th>------</th>
                <th>--------</th>
                <th>------------</th>
                <th>------------</th>
            </tr>
            <tr>
                <td>Energy cost spikes affecting greenhouse supply and pricing</td>
                <td>High</td>
                <td>Medium</td>
                <td>Multi-origin sourcing, forward energy hedges via supplier contracts</td>
            </tr>
            <tr>
                <td>Border and phytosanitary delays in UK and non-EU markets</td>
                <td>Medium to High</td>
                <td>Medium</td>
                <td>Pre-clearance documentation, appoint AEO-certified customs brokers</td>
            </tr>
            <tr>
                <td>MRL non-compliance and recall risk</td>
                <td>High</td>
                <td>Low to Medium</td>
                <td>Strict agronomy protocols, accredited labs, batch-level traceability</td>
            </tr>
            <tr>
                <td>Climate and weather disruptions</td>
                <td>High</td>
                <td>Medium</td>
                <td>Diversified geographies, contingency inventories, CEA partnerships</td>
            </tr>
            <tr>
                <td>Currency volatility vs EUR</td>
                <td>Medium</td>
                <td>Medium</td>
                <td>Natural hedging, forward contracts, price indexation clauses</td>
            </tr>
            <tr>
                <td>Retailer margin and fee pressure</td>
                <td>Medium</td>
                <td>High</td>
                <td>Mix of private label and branded, value engineering, promo ROAS gating</td>
            </tr>
            <tr>
                <td>Reputation risk from labor or sustainability issues</td>
                <td>High</td>
                <td>Low to Medium</td>
                <td>Third-party certifications, supplier audits, transparent ESG reporting</td>
            </tr>
        </table>
        <p>Strategic Recommendations</p>
        <ul>
            <li>Prioritize tiered market entry:</li>
            <li>Tier 1 Europe: Germany, France, UK, Netherlands. Rationale: scale retail markets, year-round demand, advanced cold-chain. Align with top three retailers per market and leading e-grocery platforms.</li>
            <li>Tier 1 Non-EU: United States and Canada for scale, Japan and South Korea for premium margins, UAE and Saudi Arabia for import reliance and premium retail.</li>
            <li>Build a multi-origin 52-week program:</li>
            <li>Combine EU greenhouse supply (Netherlands, Spain, Italy) with Morocco and Turkey in shoulder seasons. For North America, partner with Canada and Mexico CEA growers. In GCC and Asia, evaluate local greenhouse alliances for in-season freshness.</li>
            <li>Compliance by design:</li>
            <li>Centralize regulatory intelligence. Maintain harmonized pesticide programs meeting the strictest MRLs encountered. Standardize lot coding, traceability, and multilingual labeling compliant with EU 1169/2011, UK equivalents, FDA FSMA, CFIA, SFDA, ESMA, MHLW, MFDS.</li>
            <li>Portfolio and packaging:</li>
            <li>Offer segmented SKUs: premium vine cherry, snacking cherry, mixed color medleys, and sustainable packaging options compliant with national packaging rules. Include recyclable or compostable packs where permitted.</li>
            <li>Route-to-market:</li>
            <li>Europe: direct-to-retailer contracts, plus select wholesale for flexibility. Use Benelux as consolidation hub.</li>
            <li>North America: importer of record partners and DC-direct programs; consider JV with established greenhouse distributor.</li>
            <li>Asia and GCC: master importers with cold-chain capabilities; prioritize modern trade and online grocery.</li>
            <li>Brand and private label mix:</li>
            <li>Pursue dual strategy: flagship branded SKUs in premium channels and private label supply for scale and shelf presence. Maintain consistent eating quality to support brand premiums.</li>
            <li>Data and demand planning:</li>
            <li>Deploy demand sensing using retailer POS and e-commerce data, forecast at SKU by market. Use service level KPIs and waste reduction targets.</li>
        </ul>
        <p>Budget Recommendations</p>
        <p>Note: The client has not specified a budget. The following budget ranges are Estimates for a Big Enterprise multi-market launch over Year 1, calibrated to typical FMCG fresh produce programs of this scope. Ranges reflect scale sensitivity and regional cost factors. Currency: EUR.</p>
        <br>
        <table>
            <tr>
                <td>Budget Line</td>
                <td>Europe Allocation (Estimate)</td>
                <td>Non-Europe Allocation (Estimate)</td>
                <td>Total Year 1 (Estimate)</td>
                <td>Rationale</td>
            </tr>
            <tr>
                <th>-------------</th>
                <th>-------------------------------</th>
                <th>----------------------------------</th>
                <th>--------------------------</th>
                <th>-----------</th>
            </tr>
            <tr>
                <td>Market access and compliance</td>
                <td>2.0–3.0 M</td>
                <td>2.5–3.5 M</td>
                <td>4.5–6.5 M</td>
                <td>Certifications, lab testing, audits, registrations, legal reviews</td>
            </tr>
            <tr>
                <td>Sourcing and quality programs</td>
                <td>4.0–6.0 M</td>
                <td>4.5–6.5 M</td>
                <td>8.5–12.5 M</td>
                <td>Grower onboarding, agronomy, QA staff, traceability systems</td>
            </tr>
            <tr>
                <td>Logistics and working capital</td>
                <td>8.0–12.0 M</td>
                <td>10.0–15.0 M</td>
                <td>18.0–27.0 M</td>
                <td>Cold-chain transport, buffer stock, packaging inventory</td>
            </tr>
            <tr>
                <td>Trade marketing and listings</td>
                <td>5.0–7.0 M</td>
                <td>4.0–6.0 M</td>
                <td>9.0–13.0 M</td>
                <td>Retailer fees, promo accruals, in-store activation</td>
            </tr>
            <tr>
                <td>Brand and consumer marketing</td>
                <td>3.0–5.0 M</td>
                <td>3.0–5.0 M</td>
                <td>6.0–10.0 M</td>
                <td>Digital, sampling, content, e-commerce media</td>
            </tr>
            <tr>
                <td>Organization and IT</td>
                <td>2.0–3.0 M</td>
                <td>2.0–3.0 M</td>
                <td>4.0–6.0 M</td>
                <td>Team hiring, demand planning tools, data integration</td>
            </tr>
            <tr>
                <td>Contingency</td>
                <td>2.0–3.0 M</td>
                <td>2.0–3.0 M</td>
                <td>4.0–6.0 M</td>
                <td>Risk buffer for volatility</td>
            </tr>
            <tr>
                <td>Total</td>
                <td>26.0–39.0 M</td>
                <td>28.0–42.5 M</td>
                <td>54.0–81.5 M</td>
                <td>Year 1 total for priority markets only</td>
            </tr>
        </table>
        <p>Justification:</p>
        <ul>
            <li>Big Enterprise scope across multiple retailers and countries requires significant working capital and listing fees.</li>
            <li>Cold-chain and packaging costs remain elevated in 2024–2025 relative to pre-2020 baselines per OECD and Eurostat transport cost indicators.</li>
            <li>Compliance costs reflect multi-jurisdiction testing and supplier certification rollouts in Year 1.</li>
        </ul>
        <p>Budget Allocation Recommendations</p>
        <ul>
            <li>Europe 48–52 percent vs Non-Europe 48–52 percent in Year 1, shifting toward Non-Europe if US and Japan scale faster on premium SKUs and if North American CEA partners secure capacity.</li>
            <li>Allocate 55–60 percent of marketing to retailer media and trade activation; 40–45 percent to brand-building with a focus on digital commerce.</li>
        </ul>
        <p>Comparative Pricing and Cost Structure Insights</p>
        <ul>
            <li>EU retail price bands for cherry tomatoes vary widely by season and origin. Official average price series are not consistently available by subcategory. Observationally, premium vine cherry commands higher retail prices in Northern Europe and Japan. Strategy: position “tomato” as consistent high Brix, premium taste, with value packs for discounters to manage price architecture across channels.</li>
        </ul>
        <p>Technology Trends and Innovation Opportunities</p>
        <ul>
            <li>Controlled Environment Agriculture growth in EU, North America, and GCC improves 52-week availability and quality. Adoption of LED, climate controls, and integrated pest management is consistent with EU sustainability targets [OECD Green Growth indicators, 2024; European Commission Farm to Fork documentation, 2023–2024].</li>
            <li>Digital demand sensing and blockchain-enabled traceability can reduce shrink and support compliance documentation across borders.</li>
        </ul>
        <p>Distribution Channels</p>
        <ul>
            <li>Europe: Consolidate at Dutch logistics hubs for EU distribution. Utilize cross-docking and temperature-controlled consolidation for speed into Germany, France, and Poland. Leverage EU single market to simplify cross-border flows [European Commission Single Market, accessed 2024].</li>
            <li>Non-EU: Establish North American distribution via US East Coast and Midwest DCs; in GCC, use Jebel Ali as regional gateway; in Asia, prioritize refrigerated airfreight initially for premium programs in Japan and Korea, transitioning to sea when feasible.</li>
        </ul>
        <p>Trade Agreements and Tariffs</p>
        <ul>
            <li>Intra-EU: zero tariffs, common standards under the single market.</li>
            <li>UK: MFN tariffs applicable to non-preferential origins; seasonal tariff management via UK Global Tariff schedule [UK DIT, 2024].</li>
            <li>US and Canada: MFN tariffs for fresh tomatoes vary by origin, with US trade measures historically affecting specific origins; importers must comply with CBP and USDA APHIS rules [USITC tariff database, USDA APHIS, accessed 2024].</li>
            <li>GCC: Tariffs generally low for fresh produce; check HS 0702 national schedules [GCC customs portals, accessed 2024].</li>
        <p>Note: Specific tariff rates should be confirmed per origin before contracting. We do not present rates here due to frequent updates.</p>
        </ul>
        <p>Implementation Plan</p>
        <p>90-Day Action Plan for Priority Markets</p>
        <br>
        <table>
            <tr>
                <td>Workstream</td>
                <td>Weeks 1–3</td>
                <td>Weeks 4–6</td>
                <td>Weeks 7–9</td>
                <td>Weeks 10–12</td>
            </tr>
            <tr>
                <th>------------</th>
                <th>-----------</th>
                <th>-----------</th>
                <th>-----------</th>
                <th>-------------</th>
            </tr>
            <tr>
                <td>Regulatory and compliance</td>
                <td>Map requirements EU, UK, US, CA, JP, KR, UAE, KSA; appoint regulatory counsel</td>
                <td>Finalize pesticide program, MRL matrices; initiate lab partnerships</td>
                <td>Complete label artworks per market; submit required notifications</td>
                <td>Conduct mock recalls and traceability tests; approve SOPs</td>
            </tr>
            <tr>
                <td>Sourcing and quality</td>
                <td>Shortlist growers in NL, ES, IT, MA, TR; North America CEA partners</td>
                <td>Audit priority suppliers; sign supply MOUs with specs and KPIs</td>
                <td>Pilot test shipments to EU hub; set Brix and shelf-life thresholds</td>
                <td>Lock seasonal calendars; finalize year-round supply plan</td>
            </tr>
            <tr>
                <td>Logistics and DC setup</td>
                <td>Secure EU hub in NL; engage 3PL; define temp controls</td>
                <td>Contract North America and GCC freight; book capacity</td>
                <td>Implement QA at intake; integrate EDI with 3PL</td>
                <td>Dry runs and performance SLAs; contingency routing</td>
            </tr>
            <tr>
                <td>Commercial and listings</td>
                <td>Identify top retailers per market; prepare sell-in decks</td>
                <td>Negotiate listings, intro fees, and promo calendars</td>
                <td>Confirm planograms and initial orders; train store staff</td>
                <td>Launch windows in first retailers; track sell-out</td>
            </tr>
            <tr>
                <td>Brand and activation</td>
                <td>Finalize “tomato” brand architecture and packaging guidelines</td>
                <td>Build digital assets, e-comm pages; schedule sampling</td>
                <td>Launch digital campaigns aligned with listing dates</td>
                <td>Review ROAS and tweak messaging, price-pack architectures</td>
            </tr>
            <tr>
                <td>Finance and risk</td>
                <td>Set FX hedging policy and credit insurance</td>
                <td>Define pricing corridors and indexation clauses</td>
                <td>Implement ERP demand planning; set shrink KPIs</td>
                <td>Board review on scale-up gates and budget reallocation</td>
            </tr>
        </table>
        <p>Strategic Market Entry Guardrails</p>
        <ul>
            <li>Do not broaden beyond Tier 1 markets until service levels exceed 97 percent for 8 consecutive weeks.</li>
            <li>Maintain dual pathway: branded growth in premium channels and private label volumes to anchor utilization.</li>
            <li>Require supplier certification to GlobalG.A.P. or equivalent and social compliance audits.</li>
        </ul>
        <p>Sources &amp; References</p>
        <p>All sources are official or authoritative portals. Publication or access dates are included.</p>
        <br>
        <ul>
            <li>Eurostat, Crop and livestock statistics in the EU. Publication year 2024. Accessed 2024–2025. https://ec.europa.eu/eurostat</li>
            <li>Eurostat Comext, External trade in goods, HS 0702 tomatoes. Data updated 2024. Accessed 2024–2025. https://ec.europa.eu/eurostat</li>
            <li>UN Comtrade Database, HS 0702 Tomatoes, fresh or chilled. Accessed 2024–2025. https://comtrade.un.org</li>
            <li>European Commission, General Food Law Regulation (EC) No 178/2002. Consolidated, accessed 2024. https://food.ec.europa.eu</li>
            <li>European Commission, Food hygiene Regulations (EC) No 852/2004 and 853/2004. Accessed 2024. https://food.ec.europa.eu</li>
            <li>European Commission, Marketing standards for fruit and vegetables, Implementing Regulation (EU) No 543/2011. Accessed 2024. https://agriculture.ec.europa.eu</li>
            <li>European Commission, Regulation (EC) No 396/2005 on MRLs. Accessed 2024. https://food.ec.europa.eu</li>
            <li>European Commission, Food information to consumers Regulation (EU) No 1169/2011. Accessed 2024. https://food.ec.europa.eu</li>
            <li>European Commission, Official controls Regulation (EU) 2017/625. Accessed 2024. https://food.ec.europa.eu</li>
            <li>European Commission, The Single Market. Accessed 2024. https://single-market-economy.ec.europa.eu</li>
            <li>UK Government, Food standards and Border Target Operating Model. Published 2024. https://www.gov.uk</li>
            <li>US FDA, FSMA Produce Safety Rule and FSVP. Updated 2024. https://www.fda.gov</li>
            <li>Canadian Food Inspection Agency, Safe Food for Canadians Regulations. Updated 2024. https://inspection.canada.ca</li>
            <li>Saudi Food and Drug Authority (SFDA), Food regulations and MRLs. Accessed 2024–2025. https://sfda.gov.sa</li>
            <li>Emirates Authority for Standardization and Metrology (ESMA), Food standards and labeling. Accessed 2024–2025. https://www.moiat.gov.ae</li>
            <li>Japan Ministry of Health, Labour and Welfare (MHLW), Food Sanitation Act and MRLs. Accessed 2024–2025. https://www.mhlw.go.jp</li>
            <li>Japan MAFF, Japanese Agricultural Standards (JAS) labeling. Accessed 2024–2025. https://www.maff.go.jp</li>
            <li>Korea MFDS, Food safety and import inspection. Accessed 2024–2025. https://www.mfds.go.kr</li>
            <li>WTO SPS Information Management System. Accessed 2024–2025. https://spsims.wto.org</li>
            <li>OECD, Transport and logistics cost indicators and green growth insights. Published 2023–2024. https://www.oecd.org</li>
        </ul>
        <p>Notes on Data Limitations</p>
        <ul>
            <li>Official statistics rarely isolate cherry tomatoes from total fresh tomatoes; TAM, SAM, SOM are presented as Estimates with explicit assumptions.</li>
            <li>No official competitor brand shares were available; the competitive section is structural, not quantitative.</li>
            <li>Tariff rates vary by origin and are frequently updated; confirm at the time of contracting via official tariff databases.</li>
        </ul>
        <p>End of Report</p>
        <div class="footer">
            <p>This report was generated using AI-powered market research technology.</p>
            <p>For questions or additional analysis, please contact your research team.</p>
        </div>
    </div>
    
    <script>
        // Define the function immediately when script loads
        function downloadPDF() {
            const element = document.getElementById('report-content');
            
            // Show loading state
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '⏳ Generating PDF...';
            btn.disabled = true;
           
           // Wait for fonts and images to load
           setTimeout(function() {
               // First, ensure the element is visible and has content
               if (!element || element.offsetHeight === 0 || element.offsetWidth === 0) {
                   alert('Report content not found. Please refresh the page and try again.');
                   btn.innerHTML = originalText;
                   btn.disabled = false;
                   return;
               }
               
               // Ensure the element is visible and has content
               const rect = element.getBoundingClientRect();
               if (rect.width === 0 || rect.height === 0) {
                   alert('Report content is not visible. Please scroll to the report and try again.');
                   btn.innerHTML = originalText;
                   btn.disabled = false;
                   return;
               }
               
               // Force a reflow to ensure content is rendered
               element.style.display = 'none';
               element.offsetHeight; // Trigger reflow
               element.style.display = 'block';
               
               // Ensure all content is visible and expanded
               element.style.height = 'auto';
               element.style.minHeight = '100vh';
               element.style.overflow = 'visible';
               
               // Wait a bit more for any dynamic content to render
               setTimeout(function() {
               
               const opt = {
                   margin: [0.5, 0.5, 0.5, 0.5],
                   filename: 'AI_Trade_Report.pdf',
                   image: { type: 'jpeg', quality: 0.98 },
                   html2canvas: { 
                       scale: 1.2,
                       useCORS: true,
                       allowTaint: true,
                       backgroundColor: '#ffffff',
                       logging: false,
                       letterRendering: true,
                       width: element.scrollWidth,
                       height: element.scrollHeight,
                       scrollX: 0,
                       scrollY: 0,
                       windowWidth: element.scrollWidth,
                       windowHeight: element.scrollHeight
                   },
                   jsPDF: { 
                       unit: 'in', 
                       format: 'a4', 
                       orientation: 'portrait',
                       compress: true
                   },
                   pagebreak: { mode: ['css', 'legacy'] }
               };
              
              // Debug: Log element dimensions
              console.log('Element dimensions:', {
                  width: element.offsetWidth,
                  height: element.offsetHeight,
                  scrollWidth: element.scrollWidth,
                  scrollHeight: element.scrollHeight,
                  rect: element.getBoundingClientRect()
              });
              
              // Try the main PDF generation
              html2pdf().set(opt).from(element).save().then(function() {
                  btn.innerHTML = originalText;
                  btn.disabled = false;
              }).catch(function(error) {
                  console.error('PDF generation failed:', error);
                  
                  // Fallback: Try with simpler options
                  const simpleOpt = {
                      margin: 0.5,
                      filename: 'AI_Trade_Report.pdf',
                      image: { type: 'jpeg', quality: 0.8 },
                      html2canvas: { 
                          scale: 1,
                          backgroundColor: '#ffffff',
                          width: element.scrollWidth,
                          height: element.scrollHeight,
                          useCORS: true,
                          scrollX: 0,
                          scrollY: 0
                      },
                      jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
                  };
                  
                  html2pdf().set(simpleOpt).from(element).save().then(function() {
                      btn.innerHTML = originalText;
                      btn.disabled = false;
                  }).catch(function(fallbackError) {
                      console.error('Fallback PDF generation also failed:', fallbackError);
                      alert('PDF generation failed. Please use the Print button and save as PDF from your browser instead.');
                      btn.innerHTML = originalText;
                      btn.disabled = false;
                  });
              });
          }, 500);
      }, 1000);
  }
  
  // Also make it available on window object
  window.downloadPDF = downloadPDF;
  
  // Save report function
  // Track if report is saved
  let isReportSaved = false;
  
  function saveReport() {
      console.log('Save report function called');
      
      const btn = event.target.closest('.action-btn');
      if (!btn) {
          console.error('Save button not found');
          return;
      }
      
      // Check if already saved
      if (isReportSaved) {
          btn.innerHTML = '✅ Already Saved';
          btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
          btn.disabled = true;
          
          setTimeout(() => {
              btn.innerHTML = '💾 Save';
              btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
              btn.disabled = false;
          }, 2000);
          return;
      }
      
      const originalText = btn.innerHTML;
      
      // Show loading state
      btn.innerHTML = '⏳ Saving...';
      btn.disabled = true;
      
      try {
          // Get report data
          const reportTitle = document.querySelector('h1')?.textContent || 'AI Trade Report';
          const reportContent = document.getElementById('report-content')?.innerHTML || '';
          const currentUrl = window.location.pathname;
          const filename = currentUrl.split('/').pop() || 'unknown_report.html';
          
          console.log('Report data extracted:', {
              title: reportTitle,
              filename: filename,
              contentLength: reportContent.length
          });
          
          // Extract report metadata from URL or page
          const brand = document.querySelector('.summary-item:nth-child(1) .item-value')?.textContent || 'Unknown Brand';
          const product = document.querySelector('.summary-item:nth-child(2) .item-value')?.textContent || 'Unknown Product';
          const budget = document.querySelector('.summary-item:nth-child(3) .item-value')?.textContent || 'Unknown Budget';
          const enterpriseSize = document.querySelector('.summary-item:nth-child(4) .item-value')?.textContent || 'Unknown Size';
          
          // Prepare data for API
          const reportData = {
              title: reportTitle,
              brand: brand,
              product: product,
              budget: budget,
              enterprise_size: enterpriseSize,
              ai_model: 'gpt-5',
              language: 'en',
              content: reportContent,
              file_path: filename
          };
          
          console.log('Sending data to API:', reportData);
          
          // Send to database
          fetch('/save-report', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify(reportData)
          })
          .then(response => {
              console.log('API response status:', response.status);
              if (!response.ok) {
                  throw new Error(`HTTP error! status: ${response.status}`);
              }
              return response.json();
          })
          .then(data => {
              console.log('API response data:', data);
              if (data.status === 'success') {
                  isReportSaved = true; // Mark as saved
                  btn.innerHTML = '✅ Saved!';
                  btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                  
                  setTimeout(() => {
                      btn.innerHTML = '💾 Save';
                      btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
                      btn.disabled = false;
                  }, 2000);
              } else {
                  throw new Error(data.message || 'Failed to save report');
              }
          })
          .catch(error => {
              console.error('Error saving report:', error);
              btn.innerHTML = '❌ Error';
              btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
              
              setTimeout(() => {
                  btn.innerHTML = originalText;
                  btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
                  btn.disabled = false;
              }, 3000);
          });
      } catch (error) {
          console.error('Error in saveReport function:', error);
          btn.innerHTML = '❌ Error';
          btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
          
          setTimeout(() => {
              btn.innerHTML = originalText;
              btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
              btn.disabled = false;
          }, 3000);
      }
  }
  
  // Return to main page function
  function returnToMain() {
      if (isReportSaved) {
          // If report is saved, go directly without warning
          window.location.href = '/';
      } else {
          // If not saved, show warning
          if (confirm('Are you sure you want to return to the main page? Your current report will be lost.')) {
              window.location.href = '/';
          }
      }
  }
  
  // Make functions available globally
  window.saveReport = saveReport;
  window.returnToMain = returnToMain;
 
          // Hide header when printing
  window.addEventListener('beforeprint', function() {
      const header = document.querySelector('.report-header');
      if (header) header.style.display = 'none';
  });
  
  window.addEventListener('afterprint', function() {
      const header = document.querySelector('.report-header');
      if (header) header.style.display = 'block';
  });
  
  // Ensure function is available when DOM is ready
  document.addEventListener('DOMContentLoaded', function() {
      // Function should be available now
      if (typeof downloadPDF === 'function') {
          console.log('downloadPDF function is ready');
      } else {
          console.error('downloadPDF function not properly defined');
      }
  });
  
  // Also try to make it available immediately
  if (typeof downloadPDF === 'function') {
      console.log('downloadPDF function loaded successfully');
  }
    </script>
</body>
</html>