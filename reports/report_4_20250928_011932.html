<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Trade Report - Professional Market Analysis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        html, body {
            font-family: 'Times New Roman', serif;
            font-size: 12pt;
            line-height: 1.5;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
            width: 100%;
            min-width: 100%;
            box-sizing: border-box;
        }
        .container {
            width: 100vw;
            min-width: 100%;
            margin: 0;
            background: white;
            padding: 40px;
            border-radius: 0;
            box-shadow: none;
            box-sizing: border-box;
        }
        h1 {
            color: #2c3e50;
            font-weight: bold;
            font-size: 18pt;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        h2 {
            color: #34495e;
            font-weight: bold;
            font-size: 16pt;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 30px;
            margin-bottom: 20px;
        }
        h3 {
            color: #2c3e50;
            font-weight: bold;
            font-size: 14pt;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        h4 {
            color: #7f8c8d;
            font-weight: bold;
            font-size: 12pt;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        ul, ol {
            margin-bottom: 15px;
            padding-left: 30px;
            line-height: 1.5;
        }
        li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        /* Professional bullet points */
        ul li {
            list-style-type: disc;
            margin-left: 20px;
        }
        ul ul li {
            list-style-type: circle;
        }
        ul ul ul li {
            list-style-type: square;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #e8f4f8;
        }
        .highlight {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
        }
        .summary-box {
            background-color: #d4edda;
            padding: 20px;
            border-left: 4px solid #28a745;
            margin: 20px 0;
            border-radius: 4px;
        }
        .warning-box {
            background-color: #f8d7da;
            padding: 15px;
            border-left: 4px solid #dc3545;
            margin: 20px 0;
            border-radius: 4px;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ecf0f1;
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
        }
        /* Professional Report Header */
        .report-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 1rem 0;
        }
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .header-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            font-size: 1.25rem;
            color: #1f2937;
        }
        .header-brand .brand-icon {
            font-size: 1.5rem;
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header-actions {
            display: flex;
            gap: 0.75rem;
        }
        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .action-btn:active {
            transform: translateY(0);
        }
        .action-btn.print {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        .action-btn.pdf {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        /* Hide download button on mobile devices */
        @media (max-width: 768px) {
            .action-btn.pdf {
                display: none !important;
            }
        }
        .action-btn.save {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }
        .action-btn.home {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        .btn-icon {
            font-size: 1rem;
        }
        .btn-text {
            font-size: 0.875rem;
        }
        
        /* Report Title Section */
        .report-title-section {
            text-align: center;
            margin-bottom: 2rem;
            padding-top: 6rem;
        }
        .title-underline {
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, #2563eb, #7c3aed);
            margin: 1rem auto 0;
            border-radius: 2px;
        }
        
        /* Enhanced Summary Box */
        .summary-box {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border: 1px solid #bae6fd;
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .summary-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #0369a1;
            font-size: 1.125rem;
        }
        .summary-icon {
            font-size: 1.25rem;
        }
        .summary-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        .summary-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        .item-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .item-value {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
        }
                 @media print {
             body { 
                 background-color: white !important; 
                 color: black !important;
                 font-size: 12pt;
                 line-height: 1.4;
                 margin: 0 !important;
                 padding: 0 !important;
                 width: 100% !important;
             }
             .container { 
                 box-shadow: none !important; 
                 background: white !important;
                 padding: 20px !important;
                 margin: 0 !important;
                 width: 100% !important;
                 min-width: 100% !important;
                 max-width: none !important;
                 box-sizing: border-box !important;
                 height: auto !important;
                 min-height: 100vh !important;
             }
             .report-header { display: none !important; }
             .action-buttons { display: none !important; }
             h1, h2, h3, h4 { 
                 color: black !important; 
                 page-break-after: avoid;
                 page-break-inside: avoid;
             }
             table { 
                 page-break-inside: avoid; 
                 border-collapse: collapse !important;
             }
             .summary-box, .highlight, .warning-box {
                 background: #f8f9fa !important;
                 border: 1px solid #ddd !important;
                 color: black !important;
                 page-break-inside: avoid;
             }
             p, li {
                 page-break-inside: avoid;
                 orphans: 3;
                 widows: 3;
             }
             .footer {
                 page-break-inside: avoid;
             }
         }
        /* ===== MOBILE RESPONSIVE DESIGN ===== */
        @media (max-width: 1200px) {
            .header-content {
                padding: 0 1.5rem;
            }
            .container {
                padding: 30px;
            }
        }
        
        @media (max-width: 768px) {
            /* Mobile Header */
            .report-header {
                padding: 0.75rem 0;
            }
            .header-content {
                padding: 0 1rem;
                flex-direction: column;
                gap: 0.75rem;
                align-items: center;
            }
            .header-brand {
                font-size: 1.125rem;
            }
            .header-actions {
                width: 100%;
                justify-content: center;
                gap: 0.5rem;
                flex-wrap: wrap;
            }
            .action-btn {
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
                flex: 1;
                max-width: 120px;
                display: flex;
                align-items: center;
                gap: 0.375rem;
            }
            .btn-text {
                font-size: 0.8125rem;
                display: inline !important;
            }
            
            /* Mobile Container */
            .container {
                padding: 20px 15px;
                margin-top: 120px; /* Account for taller mobile header */
            }
            
            /* Mobile Typography */
            h1 {
                font-size: 1.75rem;
                margin-bottom: 20px;
            }
            h2 {
                font-size: 1.375rem;
                margin-top: 25px;
                margin-bottom: 15px;
            }
            h3 {
                font-size: 1.125rem;
                margin-top: 20px;
                margin-bottom: 12px;
            }
            h4 {
                font-size: 1rem;
                margin-top: 15px;
                margin-bottom: 8px;
            }
            p {
                font-size: 0.9375rem;
                line-height: 1.6;
                margin-bottom: 12px;
            }
            
            /* Mobile Tables */
            table {
                font-size: 0.875rem;
                margin: 15px 0;
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }
            th, td {
                padding: 8px 6px;
                min-width: 80px;
            }
            th {
                font-size: 0.8125rem;
            }
            
            /* Mobile Lists */
            ul, ol {
                padding-left: 20px;
                margin-bottom: 12px;
            }
            li {
                font-size: 0.9375rem;
                margin-bottom: 6px;
                line-height: 1.5;
            }
            
            /* Mobile Boxes */
            .summary-box, .highlight, .warning-box {
                padding: 15px;
                margin: 15px 0;
                border-radius: 8px;
            }
            .summary-content {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            .summary-item {
                padding: 8px 0;
            }
            .item-label {
                font-size: 0.8125rem;
            }
            .item-value {
                font-size: 0.9375rem;
            }
            
            /* Mobile Code Blocks */
            .code-block {
                padding: 12px;
                font-size: 0.8125rem;
                margin: 12px 0;
                border-radius: 6px;
            }
            
            /* Mobile Footer */
            .footer {
                margin-top: 30px;
                padding-top: 15px;
                font-size: 0.8125rem;
            }
        }
        
        @media (max-width: 480px) {
            /* Extra Small Mobile */
            .container {
                padding: 15px 10px;
                margin-top: 140px;
            }
            
            .header-content {
                padding: 0 0.75rem;
            }
            .header-brand {
                font-size: 1rem;
            }
            .action-btn {
                padding: 0.375rem 0.5rem;
                font-size: 0.6875rem;
                max-width: 100px;
                display: flex;
                align-items: center;
                gap: 0.25rem;
            }
            .btn-text {
                font-size: 0.75rem;
                display: inline !important;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            h2 {
                font-size: 1.25rem;
            }
            h3 {
                font-size: 1.0625rem;
            }
            
            table {
                font-size: 0.8125rem;
            }
            th, td {
                padding: 6px 4px;
                min-width: 70px;
            }
            
            .summary-box, .highlight, .warning-box {
                padding: 12px;
                margin: 12px 0;
            }
            
            .code-block {
                padding: 10px;
                font-size: 0.75rem;
            }
        }
        
        /* Mobile Print Optimizations */
        @media print and (max-width: 768px) {
            .container {
                padding: 15px !important;
                margin: 0 !important;
                width: 100% !important;
            }
            h1, h2, h3, h4 {
                page-break-after: avoid;
                font-size: 1.2em;
            }
            table {
                font-size: 0.8em;
                page-break-inside: avoid;
            }
            .summary-box, .highlight, .warning-box {
                page-break-inside: avoid;
                margin: 10px 0;
            }
        }
        @media screen {
            body {
                margin: 0;
                padding: 0;
            }
        }
        
        /* Saved Reports Section Styles */
        .saved-reports-section {
            padding: 2rem 0;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 400px;
        }
        
        .saved-reports-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin: 0 auto;
            max-width: 1200px;
        }
        
        .saved-reports-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .saved-reports-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .title-icon {
            font-size: 1.5rem;
        }
        
        .saved-reports-subtitle {
            color: #64748b;
            font-size: 1rem;
            margin: 0;
        }
        
        .saved-reports-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .saved-report-item {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .saved-report-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #3b82f6;
        }
        
        .saved-report-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        }
        
        .report-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .report-item-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
            line-height: 1.4;
        }
        
        .report-item-date {
            font-size: 0.875rem;
            color: #64748b;
            white-space: nowrap;
        }
        
        .report-item-details {
            margin-bottom: 1rem;
        }
        
        .report-detail-row {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        
        .report-detail-label {
            font-weight: 500;
            color: #475569;
            min-width: 80px;
            margin-right: 0.5rem;
        }
        
        .report-detail-value {
            color: #1e293b;
            flex: 1;
        }
        
        .report-item-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .report-action-btn {
            flex: 1;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.375rem;
        }
        
        .report-action-btn.primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        
        .report-action-btn.primary:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-1px);
        }
        
        .report-action-btn.secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }
        
        .report-action-btn.secondary:hover {
            background: #e2e8f0;
            border-color: #cbd5e1;
        }
        
        .no-reports-message {
            text-align: center;
            padding: 3rem 2rem;
            color: #64748b;
        }
        
        .no-reports-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .no-reports-message h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #475569;
            margin-bottom: 0.5rem;
        }
        
        .no-reports-message p {
            font-size: 1rem;
            margin: 0;
        }
        
        .saved-reports-toggle {
            background: none;
            border: none;
            color: inherit;
            font-size: inherit;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .saved-reports-toggle:hover {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }
        
        .saved-reports-toggle.active {
            background: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }
        
        .nav-icon {
            font-size: 1rem;
        }
        
        /* Mobile Responsive for Saved Reports */
        @media (max-width: 768px) {
            .saved-reports-list {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .saved-report-item {
                padding: 1rem;
            }
            
            .report-item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .report-item-actions {
                flex-direction: column;
            }
            
            .saved-reports-card {
                padding: 1.5rem;
                margin: 0 1rem;
            }
            
        .saved-reports-title {
            font-size: 1.5rem;
        }
    }
    
    /* Loading and Error States */
    .loading-reports {
        text-align: center;
        padding: 2rem;
        color: #64748b;
        font-size: 1rem;
    }
    
        .error-message {
        text-align: center;
        padding: 2rem;
        color: #dc2626;
        font-size: 1rem;
        }

        /* Custom styles for Bootstrap modal enhancements */
        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .modal-header .btn-close {
            filter: invert(1);
        }

        .sortable {
            cursor: pointer;
            user-select: none;
        }

        .sortable:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .sort-indicator {
            margin-left: 8px;
            opacity: 0.5;
            transition: all 0.2s ease;
        }

        .sortable.asc .sort-indicator {
            opacity: 1;
            transform: rotate(180deg);
        }

        .sortable.desc .sort-indicator {
            opacity: 1;
        }

        /* Custom Navbar Styles */
        .navbar {
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 0.75rem 0;
        }

        .navbar-brand {
            font-size: 1.5rem;
            color: #333 !important;
        }

        .navbar-brand .brand-logo-img {
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .navbar-nav .btn {
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s ease;
            padding: 0.5rem 1rem;
        }

        .navbar-nav .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .navbar-nav .btn-outline-primary:hover {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }

        .navbar-nav .btn-outline-secondary:hover {
            background-color: #6c757d;
            border-color: #6c757d;
        }

        .navbar-nav .btn-outline-danger:hover {
            background-color: #dc3545;
            border-color: #dc3545;
        }

        /* Responsive navbar */
        @media (max-width: 768px) {
            .navbar-brand {
                font-size: 1.25rem;
            }
            
            .navbar-nav .btn {
                margin-bottom: 0.5rem;
                width: 100%;
            }
            
            .navbar-nav {
                margin-top: 1rem;
            }
        }

        /* Scrollable Table Styles */
        .table-responsive {
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .table-responsive::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .table-responsive::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .table-responsive::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        .table-responsive::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .sticky-top {
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .table th {
            white-space: nowrap;
            font-weight: 600;
        }

        .table td {
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <!-- Professional Report Header -->
    <header class="report-header">
        <div class="header-content">
            <div class="header-brand">
                <img src="/static/logo_trade_on_chain.png" alt="AI Trade Report" class="brand-logo" style="height: 32px; width: auto; margin-right: 12px;">
                <img src="/static/logo2.png" alt="AI Trade Report" class="brand-logo" style="height: 32px; width: auto; margin-right: 12px;">
                <span class="brand-text">AI Trade Report</span>
            </div>
            <div class="header-actions">
                <button class="action-btn save" onclick="saveReport()">
                    <span class="btn-icon">💾</span>
                    <span class="btn-text">Save</span>
                </button>
                <button class="action-btn home" onclick="returnToMain()">
                    <span class="btn-icon">🏠</span>
                    <span class="btn-text">Home</span>
                </button>
                <button class="action-btn print" onclick="window.print()">
                    <span class="btn-icon">🖨️</span>
                    <span class="btn-text">Print</span>
                </button>
                <button class="action-btn pdf" onclick="downloadPDF()">
                    <span class="btn-icon">📄</span>
                    <span class="btn-text">Download PDF</span>
                </button>
            </div>
        </div>
    </header>
    
    <div class="container" id="report-content">
        <div class="report-title-section">
            <h1>AI Trade Report</h1>
            <div class="title-underline"></div>
        </div>
        <div class="summary-box">
            <div class="summary-header">
                <span class="summary-icon">📋</span>
                <span class="summary-title">Report Overview</span>
            </div>
            <div class="summary-content">
                <div class="summary-item">
                    <span class="item-label">Generated by:</span>
                    <span class="item-value">AI-Powered Market Research</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">Date:</span>
                    <span class="item-value">28 September 2025</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">Report Type:</span>
                    <span class="item-value">Comprehensive Market Analysis</span>
                </div>
            </div>
        </div>
        <p>Title: Strategic Market Analysis Report</p>
        <p>Subtitle: SWEET POTATOES AND SIMILAR ROOTS AND TUBERS WITH HIGH STARCH OR INULIN CONTENT under the brand “potato”</p>
        <p>Analysis Date: 28 September 2025</p>
        <p>Prepared for: Board of Directors</p>
        <p>Prepared by: Senior Strategy Consultant</p>
        <br>
        <p>Executive Summary</p>
        <ul>
            <li>Opportunity: Global demand for sweet potatoes and high-starch or inulin-rich roots and tubers has grown with shifts toward healthier carbohydrates, gluten-free alternatives, and functional fibers. The category spans fresh sweet potatoes, processed cuts, ready-to-cook items, frozen, dehydrated flours, and inulin-rich roots such as yacon and Jerusalem artichoke derivatives. Europe and North America show resilient retail and foodservice demand, while Asia-Pacific and Middle East markets show strong growth potential in both retail and HORECA.</li>
            <li>Strategic focus: For a medium enterprise brand “potato,” Europe offers a manageable regulatory pathway, unified logistics, and premium positioning upside. North America offers scale and advanced retail buyers but requires strong supply chain reliability and category marketing. Selected Asia-Pacific markets present growth with localized partnerships. A dual-track expansion prioritizing the EU Big 5 plus Netherlands and Poland, alongside a staged entry to North America and one Asia-Pacific market via partnerships, is recommended.</li>
            <li>Investment: Given no specified budget, a phased plan with a first-year market entry budget of EUR 3.5–5.5 million (Estimate) is advised for a medium enterprise covering market development, certifications, listings, trade marketing, and supply chain assurance. Allocation: Europe 55–65 percent, North America 20–25 percent, Asia-Pacific 10–15 percent, Contingency 5 percent. Justification is provided in Budget Recommendations.</li>
        </ul>
        <p>Market Overview</p>
        <ul>
            <li>Global demand drivers: Health and wellness trends, increased home cooking post-pandemic normalization, expansion of ethnic cuisines, and growth in plant-forward menus in foodservice. Inulin and high-starch tubers also benefit from functional fiber and low-GI positioning in specialized products.</li>
            <li>Trade flows: The EU remains a net importer of sweet potatoes, with strong inbound volumes from the United States, Egypt, Israel, South Africa, and Latin America. The UK and Netherlands are key import and distribution hubs for Europe. North America has significant domestic production in the United States, with year-round supply from multi-state growers and supplemental imports for seasonal balancing.</li>
            <li>Format segmentation: Fresh whole dominates volume. Value-added segments include washed and graded retail packs, microwaveable singles, cut fries and wedges, frozen sweet potato fries, dehydrated powders/flours, and industrial inulin-rich inputs for bakery and functional foods.</li>
        </ul>
        <p>Target Market Analysis</p>
        <p>Note: The following TAM, SAM, SOM are directional estimates based on import volumes, retail scanner insights proxies, and foodservice penetration patterns from official trade and statistical sources. Exact brandable volume depends on product mix and pack formats. Ranges are labeled as Estimate. Sources listed in Sources &amp; References.</p>
        <br>
        <table>
            <tr>
                <td>Country</td>
                <td>TAM (Estimate)</td>
                <td>SAM (Estimate)</td>
                <td>SOM Year 1 (Estimate)</td>
            </tr>
            <tr>
                <th>---------</th>
                <th>----------------</th>
                <th>----------------</th>
                <th>----------------------</th>
            </tr>
            <tr>
                <td>Germany</td>
                <td>700–1,000 EUR M</td>
                <td>250–350 EUR M</td>
                <td>1.5–3.0 EUR M</td>
            </tr>
            <tr>
                <td>France</td>
                <td>600–900 EUR M</td>
                <td>220–320 EUR M</td>
                <td>1.2–2.5 EUR M</td>
            </tr>
            <tr>
                <td>United Kingdom</td>
                <td>650–950 EUR M</td>
                <td>240–340 EUR M</td>
                <td>1.3–2.6 EUR M</td>
            </tr>
            <tr>
                <td>Italy</td>
                <td>350–500 EUR M</td>
                <td>120–170 EUR M</td>
                <td>0.7–1.4 EUR M</td>
            </tr>
            <tr>
                <td>Spain</td>
                <td>300–450 EUR M</td>
                <td>110–160 EUR M</td>
                <td>0.6–1.2 EUR M</td>
            </tr>
            <tr>
                <td>Netherlands</td>
                <td>250–400 EUR M</td>
                <td>90–140 EUR M</td>
                <td>0.5–1.0 EUR M</td>
            </tr>
            <tr>
                <td>Poland</td>
                <td>150–250 EUR M</td>
                <td>60–100 EUR M</td>
                <td>0.3–0.7 EUR M</td>
            </tr>
            <tr>
                <td>United States</td>
                <td>2,000–2,800 EUR M</td>
                <td>700–1,000 EUR M</td>
                <td>2.0–4.0 EUR M</td>
            </tr>
            <tr>
                <td>Canada</td>
                <td>300–450 EUR M</td>
                <td>100–160 EUR M</td>
                <td>0.6–1.2 EUR M</td>
            </tr>
            <tr>
                <td>Japan</td>
                <td>900–1,200 EUR M</td>
                <td>250–350 EUR M</td>
                <td>0.8–1.6 EUR M</td>
            </tr>
            <tr>
                <td>South Korea</td>
                <td>250–350 EUR M</td>
                <td>80–120 EUR M</td>
                <td>0.4–0.8 EUR M</td>
            </tr>
            <tr>
                <td>UAE and GCC</td>
                <td>150–250 EUR M</td>
                <td>60–100 EUR M</td>
                <td>0.3–0.7 EUR M</td>
            </tr>
        </table>
        <p>Assumptions for estimates:</p>
        <ul>
            <li>TAM reflects total retail and foodservice value for sweet potatoes and similar high-starch or inulin-rich roots across fresh and processed forms, proxied from official import values, domestic production valuations, and retail price bands in each market.</li>
            <li>SAM assumes accessible channels for a new entrant with mainstream and premium retail plus foodservice distributors, excluding restricted public procurement or specialty-only niches.</li>
            <li>SOM Year 1 assumes selective listings, modest brand awareness, and prioritization of value-added SKUs in top retailers and HORECA distributors. Ranges reflect likely outcomes for a medium enterprise with targeted investments.</li>
        </ul>
        <p>Competitive Landscape</p>
        <table>
            <tr>
                <td>Company</td>
                <td>Market Share</td>
                <td>Strengths</td>
                <td>Weaknesses</td>
            </tr>
            <tr>
                <th>---------</th>
                <th>--------------</th>
                <th>-----------</th>
                <th>------------</th>
            </tr>
            <tr>
                <td>Major EU importers and packers clustered in NL and UK</td>
                <td>Not disclosed in official sources</td>
                <td>Established buyer relationships with EU retailers, logistics scale, year-round supply programs</td>
                <td>Limited brand-led consumer pull, price sensitivity, dependency on external growers</td>
            </tr>
            <tr>
                <td>US grower-packer-exporter cooperatives</td>
                <td>Not disclosed in official sources</td>
                <td>Consistent quality, scale, category leadership in fresh, export experience to EU and Canada</td>
                <td>Currency exposure in EUR markets, shipping lead times, retailer private label focus</td>
            </tr>
            <tr>
                <td>North African and Israeli exporters</td>
                <td>Not disclosed in official sources</td>
                <td>Proximity to EU, competitive costs, early and late season windows</td>
                <td>Weather variability, capacity for consistent premium grades varies</td>
            </tr>
            <tr>
                <td>Frozen and value-added processors in EU and North America</td>
                <td>Not disclosed in official sources</td>
                <td>Innovation in fries and ready-to-cook formats, private label capabilities</td>
                <td>Commodity exposure to input price swings, high-capex operations</td>
            </tr>
        </table>
        <p>Notes:</p>
        <ul>
            <li>Official market share data for specific companies is not available in the cited public datasets listed in this report. Competitor categories are presented based on verifiable trade and industry structure insights.</li>
        </ul>
        <p>Regulatory Environment</p>
        <ul>
            <li>EU food safety and labeling: Compliance with EU General Food Law and food hygiene package, including HACCP implementation and traceability. Labeling per Regulation (EU) No 1169/2011 on food information to consumers, country of origin indication where required, allergens where applicable for processed items, nutrition labeling for prepacked foods.</li>
            <li>Residues and contaminants: Compliance with EU MRLs for plant protection products, monitored through EU RASFF system. Third-country imports subject to official controls per Regulation (EU) 2017/625.</li>
            <li>Phytosanitary: Plant health requirements for tubers and roots entering the EU, including phytosanitary certificates, inspection, and freedom from quarantine pests per EU plant health law.</li>
            <li>CE marking: Not applicable to food products.</li>
            <li>GDPR: Applies to consumer data from digital marketing and loyalty programs.</li>
            <li>UK: Retained EU food law with GB-specific import controls under the UK Border Target Operating Model, phased certificates and checks.</li>
            <li>North America:</li>
            <li>United States: FDA Food Safety Modernization Act preventive controls, FSVP for importers, facility registration, labeling per FDA, and any USDA oversight for certain products.</li>
            <li>Canada: Safe Food for Canadians Regulations for licensing, preventive controls, traceability, bilingual labeling.</li>
            <li>Asia-Pacific:</li>
            <li>Japan: Food Sanitation Act, MRL lists, import notification to MHLW, JAS labeling for certain claims.</li>
            <li>South Korea: MFDS import requirements, KCS customs classification, and Korean labeling standards.</li>
            <li>Gulf markets: GCC Standardization Organization requirements, Arabic labeling, Halal-related expectations for processed lines as relevant.</li>
        </ul>
        <p>Consumer Analysis</p>
        <ul>
            <li>Europe: Growing acceptance of sweet potatoes as a healthy staple and alternative to white potatoes. Premiumization opportunities through origin claims, sustainability certifications, and convenient formats. Demand strongest in UK, Germany, Netherlands, France. Southern and Eastern Europe growing from a smaller base.</li>
            <li>North America: Familiarity and high household penetration in the US and Canada. Strong performance of frozen sweet potato fries and prepared items in retail and foodservice.</li>
            <li>Asia-Pacific: Japan and South Korea have established cultural usage for sweet potatoes in snacks, confections, and seasonal items. Opportunities exist in premium fresh, baked snack formats, and ready-to-eat.</li>
            <li>Middle East: Rising modern retail and HORECA expansion, openness to premium imported produce. Value in year-round availability and consistent sizing.</li>
        </ul>
        <p>Distribution Channels</p>
        <ul>
            <li>EU:</li>
            <li>Retail: Centralized buyers in Germany, France, UK, Netherlands, Spain, Italy. Private label prevalent, but brand opportunities exist in convenience and value-added SKUs. Category captains often import and pack in NL and UK.</li>
            <li>Foodservice: Broadline distributors serve HORECA, with strong frozen fries category.</li>
            <li>Hubs: Netherlands serves as import, ripening, packing, and redistribution center for continental EU; UK operates independent from EU customs since 2021.</li>
            <li>North America:</li>
            <li>Retail: National and regional chains with category resets and planograms; private label share.</li>
            <li>Foodservice: Chains increasingly carry sweet potato fries and sides.</li>
            <li>Asia-Pacific: Importers and specialized wholesalers dominate; retail buyers value Japanese-spec packaging and high visual quality.</li>
            <li>Middle East: Modern trade groups and HORECA distributors in UAE and KSA act as entry gateways.</li>
        </ul>
        <p>Pricing Strategies</p>
        <ul>
            <li>Fresh: Price bands vary by grade, origin, and season, with premiums for consistent size, washed, and branded packs.</li>
            <li>Value-added: Premium pricing justified by convenience, pre-cut, and ready-to-cook. Frozen fries priced above regular potato fries due to input and processing costs.</li>
            <li>B2B: Program supply contracts with indexation to input costs and freight can stabilize margins. Promotional funding and EDLP or Hi-Lo structures vary by retailer and market.</li>
        </ul>
        <p>Technology Trends and Innovation Opportunities</p>
        <ul>
            <li>Post-harvest handling: Curing, controlled humidity, and temperature management to extend shelf life and reduce shrink.</li>
            <li>Packaging: Modified atmosphere and breathable films for fresh-cut products. Recyclable mono-materials for sustainability claims.</li>
            <li>Processed lines: Air-frying and low-oil processing, dehydration to flours and powders, and clean-label batter systems for fries.</li>
            <li>Traceability: Digital lot-level traceability and QR codes for origin storytelling and compliance with retailer and regulatory demands.</li>
        </ul>
        <p>Risk Assessment</p>
        <table>
            <tr>
                <td>Risk</td>
                <td>Likelihood</td>
                <td>Impact</td>
                <td>Mitigation</td>
            </tr>
            <tr>
                <th>------</th>
                <th>------------</th>
                <th>--------</th>
                <th>------------</th>
            </tr>
            <tr>
                <td>Supply variability due to weather in source regions</td>
                <td>Medium</td>
                <td>High</td>
                <td>Multi-origin sourcing, forward contracts, buffer inventory in EU and US DCs</td>
            </tr>
            <tr>
                <td>Residue or phytosanitary non-compliance</td>
                <td>Low to Medium</td>
                <td>High</td>
                <td>Strict grower protocols, pre-shipment testing, third-party certification, EU and UK-specific MRL checks</td>
            </tr>
            <tr>
                <td>Retailer private label pressure</td>
                <td>High</td>
                <td>Medium</td>
                <td>Differentiate with value-added formats, sustainability and origin storytelling, invest in brand pull</td>
            </tr>
            <tr>
                <td>Freight and currency volatility</td>
                <td>Medium</td>
                <td>Medium to High</td>
                <td>Currency hedging, freight contracts, diversified logistics routes, pricing clauses</td>
            </tr>
            <tr>
                <td>Market access delays due to import formalities</td>
                <td>Medium</td>
                <td>Medium</td>
                <td>Engage experienced customs brokers, pre-approval of labels, mock inspections</td>
            </tr>
            <tr>
                <td>Foodservice demand cyclicality</td>
                <td>Medium</td>
                <td>Medium</td>
                <td>Balance retail and foodservice portfolio, diversify across regions</td>
            </tr>
        </table>
        <p>Budget Recommendations</p>
        <ul>
            <li>First-year total market entry budget: EUR 3.5–5.5 million (Estimate)</li>
            <li>Rationale: Medium enterprise entering multiple regions with a focused SKU set needs capital for certifications, packaging, retail listings, trade marketing, initial working capital for inventory, and route-to-market partnerships. This aligns with typical multi-country FMCG produce-category entry costs for 6–9 markets with value-added lines.</li>
            <li>Allocation by region (Estimate):</li>
            <li>Europe: 55–65 percent for listings, trade spend, NL hub setup or 3PL packing, retailer campaigns, QA staffing, regulatory.</li>
            <li>North America: 20–25 percent for importer of record setup, broker fees, retail authorizations, and foodservice tests.</li>
            <li>Asia-Pacific: 10–15 percent for one pilot market (Japan or South Korea), importer partnerships, localization, and compliance.</li>
            <li>Contingency: 5 percent for risk events and currency swings.</li>
            <li>Allocation by function (Estimate):</li>
            <li>Route to market and logistics: 30–35 percent</li>
            <li>Trade marketing and promotions: 25–30 percent</li>
            <li>Certifications, QA, and compliance: 8–12 percent</li>
            <li>Packaging and product development: 10–15 percent</li>
            <li>Market research and consumer activation: 5–8 percent</li>
            <li>Working capital and safety stock: 10–15 percent</li>
        </ul>
        <p>EU Funding Opportunities and Support Programs</p>
        <ul>
            <li>COSME Single Market Programme successors and national export promotion grants for SMEs may co-finance market development services and trade fair participation.</li>
            <li>Horizon Europe and EIT Food programs for processing innovation and sustainability pilots where applicable to value-added products.</li>
            <li>Export credit and guarantee schemes at national level in EU member states for trade financing and risk coverage.</li>
        </ul>
        <p>Trade Agreements and Tariff Considerations</p>
        <ul>
            <li>EU: Preferential tariffs with several partners under EU FTAs, Most Favoured Nation rates apply otherwise. Check CN codes for sweet potatoes and related processed categories to confirm duty rates in target markets.</li>
            <li>UK: UK Global Tariff schedules apply; some continuity agreements mirror EU FTAs.</li>
            <li>USMCA governs North American trade among US, Canada, and Mexico.</li>
            <li>Asia-Pacific: CPTPP and RCEP influence tariff structures for member-to-member flows. Japan and Korea have specific tariff schedules for tubers and processed products that require product-level confirmation.</li>
        </ul>
        <p>Currency Considerations</p>
        <ul>
            <li>EUR strength or weakness affects import cost competitiveness for third-country sourcing into the EU and export pricing.</li>
            <li>USD volatility impacts North America sourcing and EU imports denominated in USD.</li>
            <li>JPY and KRW movements affect Asia-Pacific consumer price positioning. Hedging policy recommended with rolling coverage on major flows.</li>
        </ul>
        <p>Strategic Recommendations</p>
        <ul>
            <li>Prioritize EU Big 5 plus Netherlands and Poland:</li>
            <li>Establish a Netherlands-based consolidation and packing hub via 3PL to enable EU-wide distribution and reduce lead times.</li>
            <li>Launch a dual portfolio: premium fresh graded packs and value-added ready-to-cook cuts plus frozen sweet potato fries through retail and HORECA distributors.</li>
            <li>Secure year-round supply through multi-origin programs, balancing EU-grown seasonal product with imports from the US, Egypt, Israel, and South Africa.</li>
            <li>Enter the UK with adapted packaging and compliance:</li>
            <li>Prepare GB-specific labeling, align with UK Border Target Operating Model, and partner with a UK-based importer-packer for retailer programs.</li>
            <li>North America pilot:</li>
            <li>Leverage broker networks to target regional chains for value-added SKUs where brand differentiation is stronger than in fresh commodity.</li>
            <li>Explore co-packing for frozen fries with established processors to accelerate market penetration.</li>
            <li>Asia-Pacific selective entry:</li>
            <li>Choose Japan or South Korea for a premium fresh and snackable format with tight quality specs; partner with an experienced importer-wholesaler.</li>
            <li>Brand and category strategy:</li>
            <li>Position “potato” on health, sustainability, and convenience. Use recyclable packaging, origin transparency, and QR-enabled traceability.</li>
            <li>Develop private label supply options in parallel to stabilize volumes, while building the brand through value-added innovation.</li>
            <li>Compliance and quality:</li>
            <li>Implement rigorous residue testing and supplier audits. Maintain lot-level digital traceability across regions.</li>
            <li>Pricing and trade terms:</li>
            <li>Utilize program pricing with indexation to freight and input costs where possible. Plan promotional calendars and in-store sampling to accelerate trial.</li>
        </ul>
        <p>Implementation Plan</p>
        <table>
            <tr>
                <td>Timeline</td>
                <td>Action</td>
                <td>Owner</td>
                <td>Output</td>
            </tr>
            <tr>
                <th>----------</th>
                <th>--------</th>
                <th>-------</th>
                <th>--------</th>
            </tr>
            <tr>
                <td>Days 1–15</td>
                <td>Finalize multi-origin supply MOUs and quality specs; initiate residue testing protocols</td>
                <td>Head of Sourcing, QA Lead</td>
                <td>Signed supply programs, testing schedule</td>
            </tr>
            <tr>
                <td>Days 1–30</td>
                <td>Select NL 3PL for consolidation and packing; secure customs and phytosanitary processes</td>
                <td>Operations Director</td>
                <td>EU hub operational blueprint</td>
            </tr>
            <tr>
                <td>Days 15–45</td>
                <td>Complete EU and UK labeling, nutrition panels, and regulatory checks; register facilities as required</td>
                <td>Regulatory Affairs</td>
                <td>Approved labels, compliance dossier</td>
            </tr>
            <tr>
                <td>Days 30–60</td>
                <td>Retail buyer pitches in DE, FR, UK, NL; align on planograms and trial stores</td>
                <td>Commercial Director</td>
                <td>Initial listing agreements</td>
            </tr>
            <tr>
                <td>Days 30–60</td>
                <td>Engage EU and UK foodservice distributors for frozen fries and pre-cut lines</td>
                <td>Foodservice Lead</td>
                <td>Distributor MOUs</td>
            </tr>
            <tr>
                <td>Days 45–75</td>
                <td>North America broker selection; define target regional chains; initiate FSMA FSVP preparation</td>
                <td>NA Market Lead</td>
                <td>Broker contracts, compliance readiness</td>
            </tr>
            <tr>
                <td>Days 45–75</td>
                <td>Asia-Pacific importer shortlisting for JP or KR; conduct product adaptation tests</td>
                <td>APAC Lead</td>
                <td>Shortlist and product specs</td>
            </tr>
            <tr>
                <td>Days 60–90</td>
                <td>First production runs, NL packing line trials, logistics dry-runs; launch digital traceability</td>
                <td>Operations, IT</td>
                <td>Shippable inventory, live traceability</td>
            </tr>
            <tr>
                <td>Days 60–90</td>
                <td>Trade marketing plan execution: in-store displays, digital campaigns, and launch PR</td>
                <td>Marketing Director</td>
                <td>Campaign assets and activations</td>
            </tr>
        </table>
        <p>Sources &amp; References</p>
        <ul>
            <li>Eurostat International Trade in Goods, Combined Nomenclature chapters for sweet potatoes and related roots, latest available releases 2023–2025.</li>
            <li>UN Comtrade, commodity-level trade flows for sweet potatoes and root tubers, accessed 2023–2025.</li>
            <li>OECD and FAO Agricultural Outlook datasets on root and tuber consumption trends, editions 2023 and 2024.</li>
            <li>World Bank Logistics Performance Index and Doing Business archival indicators for route-to-market considerations, 2023–2024 publications.</li>
            <li>European Commission, Regulation (EU) No 1169/2011 on food information to consumers; General Food Law Regulation, consolidated versions accessed 2024–2025.</li>
            <li>European Commission, Plant Health and Official Controls Regulation (EU) 2017/625, accessed 2024–2025.</li>
            <li>European Commission RASFF Portal for food safety notifications, accessed 2024–2025.</li>
            <li>UK Government, Border Target Operating Model guidance for sanitary and phytosanitary imports, 2024–2025.</li>
            <li>U.S. FDA, FSMA Preventive Controls and FSVP requirements, official guidance pages, accessed 2024–2025.</li>
            <li>Canadian Food Inspection Agency, Safe Food for Canadians Regulations, guidance pages, accessed 2024–2025.</li>
            <li>Japan MHLW, Food Sanitation Act import procedures and MRL lists, accessed 2024–2025.</li>
            <li>South Korea MFDS import food procedures and labeling requirements, accessed 2024–2025.</li>
            <li>GCC Standardization Organization references for food labeling, accessed 2024–2025.</li>
        </ul>
        <p>Notes on Data Limitations</p>
        <ul>
            <li>Specific quantitative company market shares, retail scanner sales, and precise consumption volumes by SKU format are not publicly available from the listed official sources. Where market sizes are presented, they are labeled as Estimate and reasoned from import values, domestic production significance, and observed retail and foodservice dynamics.</li>
            <li>Exact tariffs and duty rates vary by product classification and processing status. Confirmation at HS-6 and CN-8 levels is required at the time of contracting.</li>
        </ul>
        <div class="footer">
            <p>This report was generated using AI-powered market research technology.</p>
            <p>For questions or additional analysis, please contact your research team.</p>
        </div>
    </div>
    
    <script>
        // Define the function immediately when script loads
        function downloadPDF() {
            const element = document.getElementById('report-content');
            
            // Show loading state
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '⏳ Generating PDF...';
            btn.disabled = true;
           
           // Wait for fonts and images to load
           setTimeout(function() {
               // First, ensure the element is visible and has content
               if (!element || element.offsetHeight === 0 || element.offsetWidth === 0) {
                   alert('Report content not found. Please refresh the page and try again.');
                   btn.innerHTML = originalText;
                   btn.disabled = false;
                   return;
               }
               
               // Ensure the element is visible and has content
               const rect = element.getBoundingClientRect();
               if (rect.width === 0 || rect.height === 0) {
                   alert('Report content is not visible. Please scroll to the report and try again.');
                   btn.innerHTML = originalText;
                   btn.disabled = false;
                   return;
               }
               
               // Force a reflow to ensure content is rendered
               element.style.display = 'none';
               element.offsetHeight; // Trigger reflow
               element.style.display = 'block';
               
               // Ensure all content is visible and expanded
               element.style.height = 'auto';
               element.style.minHeight = '100vh';
               element.style.overflow = 'visible';
               
               // Wait a bit more for any dynamic content to render
               setTimeout(function() {
               
               const opt = {
                   margin: [0.5, 0.5, 0.5, 0.5],
                   filename: 'AI_Trade_Report.pdf',
                   image: { type: 'jpeg', quality: 0.98 },
                   html2canvas: { 
                       scale: 1.2,
                       useCORS: true,
                       allowTaint: true,
                       backgroundColor: '#ffffff',
                       logging: false,
                       letterRendering: true,
                       width: element.scrollWidth,
                       height: element.scrollHeight,
                       scrollX: 0,
                       scrollY: 0,
                       windowWidth: element.scrollWidth,
                       windowHeight: element.scrollHeight
                   },
                   jsPDF: { 
                       unit: 'in', 
                       format: 'a4', 
                       orientation: 'portrait',
                       compress: true
                   },
                   pagebreak: { mode: ['css', 'legacy'] }
               };
              
              // Debug: Log element dimensions
              console.log('Element dimensions:', {
                  width: element.offsetWidth,
                  height: element.offsetHeight,
                  scrollWidth: element.scrollWidth,
                  scrollHeight: element.scrollHeight,
                  rect: element.getBoundingClientRect()
              });
              
              // Try the main PDF generation
              html2pdf().set(opt).from(element).save().then(function() {
                  btn.innerHTML = originalText;
                  btn.disabled = false;
              }).catch(function(error) {
                  console.error('PDF generation failed:', error);
                  
                  // Fallback: Try with simpler options
                  const simpleOpt = {
                      margin: 0.5,
                      filename: 'AI_Trade_Report.pdf',
                      image: { type: 'jpeg', quality: 0.8 },
                      html2canvas: { 
                          scale: 1,
                          backgroundColor: '#ffffff',
                          width: element.scrollWidth,
                          height: element.scrollHeight,
                          useCORS: true,
                          scrollX: 0,
                          scrollY: 0
                      },
                      jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
                  };
                  
                  html2pdf().set(simpleOpt).from(element).save().then(function() {
                      btn.innerHTML = originalText;
                      btn.disabled = false;
                  }).catch(function(fallbackError) {
                      console.error('Fallback PDF generation also failed:', fallbackError);
                      alert('PDF generation failed. Please use the Print button and save as PDF from your browser instead.');
                      btn.innerHTML = originalText;
                      btn.disabled = false;
                  });
              });
          }, 500);
      }, 1000);
  }
  
  // Also make it available on window object
  window.downloadPDF = downloadPDF;
  
  // Save report function
  // Track if report is saved
  let isReportSaved = false;
  
  function saveReport() {
      console.log('Save report function called');
      
      const btn = event.target.closest('.action-btn');
      if (!btn) {
          console.error('Save button not found');
          return;
      }
      
      // Check if already saved
      if (isReportSaved) {
          btn.innerHTML = '✅ Already Saved';
          btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
          btn.disabled = true;
          
          setTimeout(() => {
              btn.innerHTML = '💾 Save';
              btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
              btn.disabled = false;
          }, 2000);
          return;
      }
      
      const originalText = btn.innerHTML;
      
      // Show loading state
      btn.innerHTML = '⏳ Saving...';
      btn.disabled = true;
      
      try {
          // Get report data
          const reportTitle = document.querySelector('h1')?.textContent || 'AI Trade Report';
          const reportContent = document.getElementById('report-content')?.innerHTML || '';
          const currentUrl = window.location.pathname;
          const filename = currentUrl.split('/').pop() || 'unknown_report.html';
          
          console.log('Report data extracted:', {
              title: reportTitle,
              filename: filename,
              contentLength: reportContent.length
          });
          
          // Extract report metadata from URL or page
          const brand = document.querySelector('.summary-item:nth-child(1) .item-value')?.textContent || 'Unknown Brand';
          const product = document.querySelector('.summary-item:nth-child(2) .item-value')?.textContent || 'Unknown Product';
          const budget = document.querySelector('.summary-item:nth-child(3) .item-value')?.textContent || 'Unknown Budget';
          const enterpriseSize = document.querySelector('.summary-item:nth-child(4) .item-value')?.textContent || 'Unknown Size';
          
          // Prepare data for API
          const reportData = {
              title: reportTitle,
              brand: brand,
              product: product,
              budget: budget,
              enterprise_size: enterpriseSize,
              ai_model: 'gpt-5',
              language: 'en',
              content: reportContent,
              file_path: filename
          };
          
          console.log('Sending data to API:', reportData);
          
          // Send to database
          fetch('/save-report', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },
              body: JSON.stringify(reportData)
          })
          .then(response => {
              console.log('API response status:', response.status);
              if (!response.ok) {
                  throw new Error(`HTTP error! status: ${response.status}`);
              }
              return response.json();
          })
          .then(data => {
              console.log('API response data:', data);
              if (data.status === 'success') {
                  isReportSaved = true; // Mark as saved
                  btn.innerHTML = '✅ Saved!';
                  btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                  
                  setTimeout(() => {
                      btn.innerHTML = '💾 Save';
                      btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
                      btn.disabled = false;
                  }, 2000);
              } else {
                  throw new Error(data.message || 'Failed to save report');
              }
          })
          .catch(error => {
              console.error('Error saving report:', error);
              btn.innerHTML = '❌ Error';
              btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
              
              setTimeout(() => {
                  btn.innerHTML = originalText;
                  btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
                  btn.disabled = false;
              }, 3000);
          });
      } catch (error) {
          console.error('Error in saveReport function:', error);
          btn.innerHTML = '❌ Error';
          btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
          
          setTimeout(() => {
              btn.innerHTML = originalText;
              btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
              btn.disabled = false;
          }, 3000);
      }
  }
  
  // Return to main page function
  function returnToMain() {
      if (isReportSaved) {
          // If report is saved, go directly without warning
          window.location.href = '/';
      } else {
          // If not saved, show warning
          if (confirm('Are you sure you want to return to the main page? Your current report will be lost.')) {
              window.location.href = '/';
          }
      }
  }
  
  // Make functions available globally
  window.saveReport = saveReport;
  window.returnToMain = returnToMain;
 
          // Hide header when printing
  window.addEventListener('beforeprint', function() {
      const header = document.querySelector('.report-header');
      if (header) header.style.display = 'none';
  });
  
  window.addEventListener('afterprint', function() {
      const header = document.querySelector('.report-header');
      if (header) header.style.display = 'block';
  });
  
  // Ensure function is available when DOM is ready
  document.addEventListener('DOMContentLoaded', function() {
      // Function should be available now
      if (typeof downloadPDF === 'function') {
          console.log('downloadPDF function is ready');
      } else {
          console.error('downloadPDF function not properly defined');
      }
  });
  
  // Also try to make it available immediately
  if (typeof downloadPDF === 'function') {
      console.log('downloadPDF function loaded successfully');
  }
    </script>
</body>
</html>