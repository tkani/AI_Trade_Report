<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Trade Report - Professional Market Analysis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        html, body {
            font-family: 'Times New Roman', serif;
            font-size: 12pt;
            line-height: 1.5;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
            width: 100%;
            min-width: 100%;
            box-sizing: border-box;
        }
        .container {
            width: 100vw;
            min-width: 100%;
            margin: 0;
            background: white;
            padding: 40px;
            border-radius: 0;
            box-shadow: none;
            box-sizing: border-box;
        }
        h1 {
            color: #2c3e50;
            font-weight: bold;
            font-size: 18pt;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        h2 {
            color: #34495e;
            font-weight: bold;
            font-size: 16pt;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
            margin-top: 30px;
            margin-bottom: 20px;
        }
        h3 {
            color: #2c3e50;
            font-weight: bold;
            font-size: 14pt;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        h4 {
            color: #7f8c8d;
            font-weight: bold;
            font-size: 12pt;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        ul, ol {
            margin-bottom: 15px;
            padding-left: 30px;
            line-height: 1.5;
        }
        li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        /* Professional bullet points */
        ul li {
            list-style-type: disc;
            margin-left: 20px;
        }
        ul ul li {
            list-style-type: circle;
        }
        ul ul ul li {
            list-style-type: square;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #e8f4f8;
        }
        .highlight {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
        }
        .summary-box {
            background-color: #d4edda;
            padding: 20px;
            border-left: 4px solid #28a745;
            margin: 20px 0;
            border-radius: 4px;
        }
        .warning-box {
            background-color: #f8d7da;
            padding: 15px;
            border-left: 4px solid #dc3545;
            margin: 20px 0;
            border-radius: 4px;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ecf0f1;
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
        }
        /* Professional Report Header */
        .report-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 1rem 0;
        }
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .header-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            font-size: 1.25rem;
            color: #1f2937;
        }
        .header-brand .brand-icon {
            font-size: 1.5rem;
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header-actions {
            display: flex;
            gap: 0.75rem;
        }
        .action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .action-btn:active {
            transform: translateY(0);
        }
        .action-btn.print {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        .action-btn.pdf {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        .action-btn.save {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }
        .action-btn.home {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        .btn-icon {
            font-size: 1rem;
        }
        .btn-text {
            font-size: 0.875rem;
        }
        
        /* Report Title Section */
        .report-title-section {
            text-align: center;
            margin-bottom: 2rem;
            padding-top: 6rem;
        }
        .title-underline {
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, #2563eb, #7c3aed);
            margin: 1rem auto 0;
            border-radius: 2px;
        }
        
        /* Enhanced Summary Box */
        .summary-box {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border: 1px solid #bae6fd;
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .summary-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #0369a1;
            font-size: 1.125rem;
        }
        .summary-icon {
            font-size: 1.25rem;
        }
        .summary-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        .summary-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        .item-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .item-value {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
        }
                 @media print {
             body { 
                 background-color: white !important; 
                 color: black !important;
                 font-size: 12pt;
                 line-height: 1.4;
                 margin: 0 !important;
                 padding: 0 !important;
                 width: 100% !important;
             }
             .container { 
                 box-shadow: none !important; 
                 background: white !important;
                 padding: 20px !important;
                 margin: 0 !important;
                 width: 100% !important;
                 min-width: 100% !important;
                 max-width: none !important;
                 box-sizing: border-box !important;
                 height: auto !important;
                 min-height: 100vh !important;
             }
             .report-header { display: none !important; }
             .action-buttons { display: none !important; }
             h1, h2, h3, h4 { 
                 color: black !important; 
                 page-break-after: avoid;
                 page-break-inside: avoid;
             }
             table { 
                 page-break-inside: avoid; 
                 border-collapse: collapse !important;
             }
             .summary-box, .highlight, .warning-box {
                 background: #f8f9fa !important;
                 border: 1px solid #ddd !important;
                 color: black !important;
                 page-break-inside: avoid;
             }
             p, li {
                 page-break-inside: avoid;
                 orphans: 3;
                 widows: 3;
             }
             .footer {
                 page-break-inside: avoid;
             }
         }
        /* ===== MOBILE RESPONSIVE DESIGN ===== */
        @media (max-width: 1200px) {
            .header-content {
                padding: 0 1.5rem;
            }
            .container {
                padding: 30px;
            }
        }
        
        @media (max-width: 768px) {
            /* Mobile Header */
            .report-header {
                padding: 0.75rem 0;
            }
            .header-content {
                padding: 0 1rem;
                flex-direction: column;
                gap: 0.75rem;
                align-items: center;
            }
            .header-brand {
                font-size: 1.125rem;
            }
            .header-actions {
                width: 100%;
                justify-content: center;
                gap: 0.5rem;
                flex-wrap: wrap;
            }
            .action-btn {
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
                flex: 1;
                max-width: 120px;
                display: flex;
                align-items: center;
                gap: 0.375rem;
            }
            .btn-text {
                font-size: 0.8125rem;
                display: inline !important;
            }
            
            /* Mobile Container */
            .container {
                padding: 20px 15px;
                margin-top: 120px; /* Account for taller mobile header */
            }
            
            /* Mobile Typography */
            h1 {
                font-size: 1.75rem;
                margin-bottom: 20px;
            }
            h2 {
                font-size: 1.375rem;
                margin-top: 25px;
                margin-bottom: 15px;
            }
            h3 {
                font-size: 1.125rem;
                margin-top: 20px;
                margin-bottom: 12px;
            }
            h4 {
                font-size: 1rem;
                margin-top: 15px;
                margin-bottom: 8px;
            }
            p {
                font-size: 0.9375rem;
                line-height: 1.6;
                margin-bottom: 12px;
            }
            
            /* Mobile Tables */
            table {
                font-size: 0.875rem;
                margin: 15px 0;
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }
            th, td {
                padding: 8px 6px;
                min-width: 80px;
            }
            th {
                font-size: 0.8125rem;
            }
            
            /* Mobile Lists */
            ul, ol {
                padding-left: 20px;
                margin-bottom: 12px;
            }
            li {
                font-size: 0.9375rem;
                margin-bottom: 6px;
                line-height: 1.5;
            }
            
            /* Mobile Boxes */
            .summary-box, .highlight, .warning-box {
                padding: 15px;
                margin: 15px 0;
                border-radius: 8px;
            }
            .summary-content {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            .summary-item {
                padding: 8px 0;
            }
            .item-label {
                font-size: 0.8125rem;
            }
            .item-value {
                font-size: 0.9375rem;
            }
            
            /* Mobile Code Blocks */
            .code-block {
                padding: 12px;
                font-size: 0.8125rem;
                margin: 12px 0;
                border-radius: 6px;
            }
            
            /* Mobile Footer */
            .footer {
                margin-top: 30px;
                padding-top: 15px;
                font-size: 0.8125rem;
            }
        }
        
        @media (max-width: 480px) {
            /* Extra Small Mobile */
            .container {
                padding: 15px 10px;
                margin-top: 140px;
            }
            
            .header-content {
                padding: 0 0.75rem;
            }
            .header-brand {
                font-size: 1rem;
            }
            .action-btn {
                padding: 0.375rem 0.5rem;
                font-size: 0.6875rem;
                max-width: 100px;
                display: flex;
                align-items: center;
                gap: 0.25rem;
            }
            .btn-text {
                font-size: 0.75rem;
                display: inline !important;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            h2 {
                font-size: 1.25rem;
            }
            h3 {
                font-size: 1.0625rem;
            }
            
            table {
                font-size: 0.8125rem;
            }
            th, td {
                padding: 6px 4px;
                min-width: 70px;
            }
            
            .summary-box, .highlight, .warning-box {
                padding: 12px;
                margin: 12px 0;
            }
            
            .code-block {
                padding: 10px;
                font-size: 0.75rem;
            }
        }
        
        /* Mobile Print Optimizations */
        @media print and (max-width: 768px) {
            .container {
                padding: 15px !important;
                margin: 0 !important;
                width: 100% !important;
            }
            h1, h2, h3, h4 {
                page-break-after: avoid;
                font-size: 1.2em;
            }
            table {
                font-size: 0.8em;
                page-break-inside: avoid;
            }
            .summary-box, .highlight, .warning-box {
                page-break-inside: avoid;
                margin: 10px 0;
            }
        }
        @media screen {
            body {
                margin: 0;
                padding: 0;
            }
        }
        
        /* Saved Reports Section Styles */
        .saved-reports-section {
            padding: 2rem 0;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 400px;
        }
        
        .saved-reports-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin: 0 auto;
            max-width: 1200px;
        }
        
        .saved-reports-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .saved-reports-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .title-icon {
            font-size: 1.5rem;
        }
        
        .saved-reports-subtitle {
            color: #64748b;
            font-size: 1rem;
            margin: 0;
        }
        
        .saved-reports-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .saved-report-item {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .saved-report-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #3b82f6;
        }
        
        .saved-report-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        }
        
        .report-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .report-item-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
            line-height: 1.4;
        }
        
        .report-item-date {
            font-size: 0.875rem;
            color: #64748b;
            white-space: nowrap;
        }
        
        .report-item-details {
            margin-bottom: 1rem;
        }
        
        .report-detail-row {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        
        .report-detail-label {
            font-weight: 500;
            color: #475569;
            min-width: 80px;
            margin-right: 0.5rem;
        }
        
        .report-detail-value {
            color: #1e293b;
            flex: 1;
        }
        
        .report-item-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .report-action-btn {
            flex: 1;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.375rem;
        }
        
        .report-action-btn.primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        
        .report-action-btn.primary:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-1px);
        }
        
        .report-action-btn.secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }
        
        .report-action-btn.secondary:hover {
            background: #e2e8f0;
            border-color: #cbd5e1;
        }
        
        .no-reports-message {
            text-align: center;
            padding: 3rem 2rem;
            color: #64748b;
        }
        
        .no-reports-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .no-reports-message h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #475569;
            margin-bottom: 0.5rem;
        }
        
        .no-reports-message p {
            font-size: 1rem;
            margin: 0;
        }
        
        .saved-reports-toggle {
            background: none;
            border: none;
            color: inherit;
            font-size: inherit;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .saved-reports-toggle:hover {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }
        
        .saved-reports-toggle.active {
            background: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }
        
        .nav-icon {
            font-size: 1rem;
        }
        
        /* Mobile Responsive for Saved Reports */
        @media (max-width: 768px) {
            .saved-reports-list {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .saved-report-item {
                padding: 1rem;
            }
            
            .report-item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .report-item-actions {
                flex-direction: column;
            }
            
            .saved-reports-card {
                padding: 1.5rem;
                margin: 0 1rem;
            }
            
        .saved-reports-title {
            font-size: 1.5rem;
        }
    }
    
    /* Loading and Error States */
    .loading-reports {
        text-align: center;
        padding: 2rem;
        color: #64748b;
        font-size: 1rem;
    }
    
    .error-message {
        text-align: center;
        padding: 2rem;
        color: #dc2626;
        font-size: 1rem;
    }
    </style>
</head>
<body>
    <!-- Professional Report Header -->
    <header class="report-header">
        <div class="header-content">
            <div class="header-brand">
                <img src="/static/logo_trade_on_chain.png" alt="AI Trade Report" class="brand-logo" style="height: 32px; width: auto; margin-right: 12px;">
                <span class="brand-text">AI Trade Report</span>
            </div>
            <div class="header-actions">
                <button class="action-btn save" onclick="saveReport()">
                    <span class="btn-icon">💾</span>
                    <span class="btn-text">Save</span>
                </button>
                <button class="action-btn home" onclick="returnToMain()">
                    <span class="btn-icon">🏠</span>
                    <span class="btn-text">Return to Main Page</span>
                </button>
                <button class="action-btn print" onclick="window.print()">
                    <span class="btn-icon">🖨️</span>
                    <span class="btn-text">Print</span>
                </button>
                <button class="action-btn pdf" onclick="downloadPDF()">
                    <span class="btn-icon">📄</span>
                    <span class="btn-text">Download PDF</span>
                </button>
            </div>
        </div>
    </header>
    
    <div class="container" id="report-content">
        <div class="report-title-section">
            <h1>AI Trade Report</h1>
            <div class="title-underline"></div>
        </div>
        <div class="summary-box">
            <div class="summary-header">
                <span class="summary-icon">📋</span>
                <span class="summary-title">Report Overview</span>
            </div>
            <div class="summary-content">
                <div class="summary-item">
                    <span class="item-label">Generated by:</span>
                    <span class="item-value">AI-Powered Market Research</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">Date:</span>
                    <span class="item-value">27 September 2025</span>
                </div>
                <div class="summary-item">
                    <span class="item-label">Report Type:</span>
                    <span class="item-value">Comprehensive Market Analysis</span>
                </div>
            </div>
        </div>
        <p>Title Page</p>
        <p>Strategic Market Analysis Report</p>
        <p>Brand: tomato</p>
        <p>Category: Fresh and Processed Tomatoes</p>
        <p>Enterprise Size: Small Enterprise</p>
        <p>Total Available Budget: 10,000</p>
        <p>Analysis Date: 27 September 2025</p>
        <p>Prepared by: Senior Strategy Consultant, International Market Expansion, FMCG and European Distribution</p>
        <br>
        <p>Executive Summary</p>
        <p>This report evaluates market expansion opportunities for tomatoes under the brand tomato across European and selected non-European markets, tailored to a small enterprise with a total budget of 10,000. Given the modest budget, near-term expansion should prioritize cost-efficient, high-access channels such as cross-border EU trade leveraging existing distributors, digital wholesale marketplaces, and targeted B2B outreach to regional retailers and foodservice buyers. The EU single market, harmonized food safety framework, and mature distribution infrastructure provide the most feasible entry path within budget. Non-EU opportunities can be explored through export partnerships and marketplace pilots, but regulated market access and logistics costs will constrain scope.</p>
        <br>
        <p>Reliable public data confirms Europe as one of the largest tomato consumption and trade regions, with Germany, France, Italy, Spain, Netherlands, Poland, and the UK as significant importers or consumers, while Spain, Netherlands, Morocco, and Turkey are key exporters into Europe. For a small enterprise, practical focus should be on differentiated positioning, supply reliability, and certification, with initial markets selected on import reliance, distributor density, logistics proximity, and price realization. Given current budget constraints, the recommended approach is a staged EU-first entry targeting Germany and the Netherlands through wholesale platforms and specialized importers, complemented by micro-pilots in the UK and UAE via consolidators. Investment priorities include compliance documentation, buyer discovery, samples, and low-cost trade-fair presence.</p>
        <br>
        <p>Market Overview</p>
        <p>Note on data availability: The sections below reference only data supported by official sources. Where precise, recent statistics are not available from the specified databases within the report scope, findings are framed as directional insights. All quantitative ranges labeled as Estimate are reasoned based on multi-year public trends and structural trade patterns.</p>
        <br>
        <p>Target Market Analysis</p>
        <p>TAM, SAM, SOM</p>
        <p>Data availability note: Official sources provide robust production, trade, and consumption indicators at EU and country levels, but brand-level market sizes and net-of-waste retail sales for tomatoes are fragmented publicly. The following table provides directional estimates for fresh tomato demand as a proxy using import reliance and retail channel accessibility. All values are directional monetary ranges for Year 1 opportunity sizing for a small entrant and labeled as Estimate. Reasoning is provided below the table.</p>
        <br>
        <table>
            <tr>
                <td>Country or Region</td>
                <td>TAM (Estimate)</td>
                <td>SAM (Estimate)</td>
                <td>SOM Year 1 (Estimate)</td>
            </tr>
            <tr>
                <th>-------------------</th>
                <th>----------------</th>
                <th>----------------</th>
                <th>-----------------------</th>
            </tr>
            <tr>
                <td>Germany</td>
                <td>3,500-4,800 EUR M</td>
                <td>400-650 EUR M</td>
                <td>0.05-0.15 EUR M</td>
            </tr>
            <tr>
                <td>France</td>
                <td>2,800-4,000 EUR M</td>
                <td>250-450 EUR M</td>
                <td>0.04-0.12 EUR M</td>
            </tr>
            <tr>
                <td>UK</td>
                <td>2,200-3,200 EUR M</td>
                <td>250-450 EUR M</td>
                <td>0.04-0.12 EUR M</td>
            </tr>
            <tr>
                <td>Italy</td>
                <td>2,500-3,500 EUR M</td>
                <td>150-300 EUR M</td>
                <td>0.03-0.10 EUR M</td>
            </tr>
            <tr>
                <td>Spain</td>
                <td>1,800-2,600 EUR M</td>
                <td>120-250 EUR M</td>
                <td>0.02-0.08 EUR M</td>
            </tr>
            <tr>
                <td>Netherlands</td>
                <td>1,000-1,400 EUR M</td>
                <td>150-280 EUR M</td>
                <td>0.03-0.10 EUR M</td>
            </tr>
            <tr>
                <td>Poland</td>
                <td>900-1,300 EUR M</td>
                <td>120-220 EUR M</td>
                <td>0.02-0.07 EUR M</td>
            </tr>
            <tr>
                <td>UAE</td>
                <td>350-550 EUR M</td>
                <td>60-120 EUR M</td>
                <td>0.02-0.06 EUR M</td>
            </tr>
            <tr>
                <td>Saudi Arabia</td>
                <td>500-750 EUR M</td>
                <td>70-140 EUR M</td>
                <td>0.02-0.06 EUR M</td>
            </tr>
            <tr>
                <td>Canada</td>
                <td>1,000-1,500 EUR M</td>
                <td>120-250 EUR M</td>
                <td>0.02-0.07 EUR M</td>
            </tr>
            <tr>
                <td>Singapore</td>
                <td>180-280 EUR M</td>
                <td>30-70 EUR M</td>
                <td>0.01-0.04 EUR M</td>
            </tr>
            <tr>
                <td>Hong Kong SAR</td>
                <td>220-320 EUR M</td>
                <td>30-70 EUR M</td>
                <td>0.01-0.04 EUR M</td>
            </tr>
        </table>
        <p>Estimate reasoning:</p>
        <ul>
            <li>TAM: Directional retail value of fresh tomatoes inferred from per capita tomato consumption ranges in Europe and import statistics for non-producer-heavy markets, using indicative EU retail price bands. This is an estimate due to lack of unified retail sales totals in official public sources.</li>
            <li>SAM: Addressable segment for a small entrant factoring import-reliant share, specialty retail and foodservice channels accessible through distributors, and realistic logistics footprints within 12 months.</li>
            <li>SOM Year 1: Conservative pilot penetration assuming small enterprise capacity, limited brand equity, and a 10,000 launch budget.</li>
        </ul>
        <p>Competitive Landscape</p>
        <p>Data availability note: Official public databases do not publish comprehensive brand-level shares for fresh tomatoes. However, structural competitors are identifiable as follows:</p>
        <ul>
            <li>EU greenhouse powerhouses and co-ops: Netherlands grower-exporters and auctions; Spanish Almeria and Murcia growers; Italian Sicilian and Campanian producers. Strengths include scale, year-round programs, and established retail contracts.</li>
            <li>Morocco and Turkey exporters: Competitive pricing into EU and Middle East, strong seasonal windows.</li>
            <li>Local producers in target markets: Italy, Spain, Poland have regional supply advantages, especially in season.</li>
            <li>Wholesale marketplaces and large importers: Dutch auction system, German and French Rungis-style wholesale hubs, UK specialty importers.</li>
        <p>Given the small budget, direct competition with category captains on national retail programs is not feasible; focus should be on niche SKUs, off-peak windows, and regional buyers.</p>
        </ul>
        <p>Regulatory Environment</p>
        <p>EU and UK</p>
        <ul>
            <li>Food safety and hygiene: General Food Law Regulation EC 178/2002 and associated hygiene package. Requires HACCP-based controls and traceability. Source: European Commission, consolidated legal framework, accessed 2024.</li>
            <li>Pesticide residues: Maximum Residue Levels set by Regulation EC 396/2005. Source: European Commission MRL database, updated 2024.</li>
            <li>Plant health: Regulation EU 2016/2031 on protective measures against pests; phytosanitary requirements for third-country imports. Source: European Commission, last updates 2023-2024.</li>
            <li>Marketing standards for fresh produce: Commission Implementing Regulation EU 543/2011 and horizontal standards for quality classes and labeling. Source: European Commission, consolidated text, accessed 2024.</li>
            <li>Packaging and labelling: Regulation EU 1169/2011 on food information to consumers for prepacked items; origin, class, variety for fresh produce where applicable. Source: European Commission, 2024.</li>
            <li>Organic: Regulation EU 2018/848 for organic production and import controls. Source: European Commission, 2024.</li>
            <li>UK post-Brexit import controls: UK Global Tariff schedule, DEFRA plant health rules and IPAFFS pre-notification for high-risk consignments. Source: UK Government guidance, 2023-2024.</li>
        </ul>
        <p>Non-EU focus examples</p>
        <ul>
            <li>GCC markets: Gulf standards for pesticide residues and shelf-life vary by country; common requirement for phytosanitary certificates and conformity documents. Source: Gulf Standardization Organization guidance, 2023.</li>
            <li>Canada: Safe Food for Canadians Regulations for import licensing and preventive controls. Source: Canadian Food Inspection Agency, 2023-2024.</li>
            <li>Singapore and Hong Kong SAR: Import permits and phytosanitary certification for fresh produce; Food safety standards governed by SFA and CFS respectively. Sources: Singapore Food Agency 2024, Hong Kong CFS 2024.</li>
        </ul>
        <p>Consumer Analysis</p>
        <p>Directional insights supported by official and trade data context:</p>
        <ul>
            <li>Europe maintains high tomato consumption per capita with strong preference for vine-ripened, cherry, and specialty varieties in Northern and Western Europe, while Southern Europe shows strong seasonal local preference. Higher share of supermarket purchases with premium niches in organic and snacking tomatoes. Source context: Eurostat agricultural products and household expenditure datasets; European Commission market observatory for fruit and vegetables, accessed 2023-2024.</li>
            <li>Non-EU markets such as the GCC, Singapore, and Hong Kong feature high import dependence and premium tolerance for air-freight or high-grade greenhouse tomatoes, favoring year-round availability and convenience. Sources: UN Comtrade import reliance, 2023-2024; WTO trade profiles.</li>
        </ul>
        <p>Distribution Channels</p>
        <p>EU</p>
        <ul>
            <li>Fresh produce wholesale hubs: Netherlands auctions and logistics parks, Germany’s major wholesale markets, Rungis International Market in France, Mercabarna in Spain, with strong re-export flows in the Netherlands. Sources: National wholesale market operators and EU trade flow patterns via Comtrade, 2023-2024.</li>
            <li>Retail: Consolidated grocery retail in Germany, France, UK, Netherlands; access typically via national importers or integrated procurement platforms. Sources: OECD Competition and retail structure studies; European Commission retail market monitoring, 2023-2024.</li>
            <li>Digital B2B: EU produce buyers active on platforms such as Tridge and EEX-style exchanges for perishables; cost-efficient initial reach for small exporters. Source: Industry platform public information, 2024.</li>
        </ul>
        <p>Non-EU</p>
        <ul>
            <li>Consolidators and re-exporters in the Netherlands and Spain serve Middle East and Asia routes; for pilot exports with small volumes these partnerships reduce fixed costs. Source: UN Comtrade re-export patterns and Dutch trade data, 2023-2024.</li>
            <li>Regional wholesale markets in GCC and Asia act as primary distribution for imported fresh produce.</li>
        </ul>
        <p>Comparative Analysis</p>
        <p>Pricing strategies and cost structures</p>
        <ul>
            <li>EU supermarket programs demand consistent spec and long-term pricing corridors; small entrants can target off-peak windows and niches such as specialty cherry, vine, or organic where price realization is higher relative to volume.</li>
            <li>GCC and Asian city-states offer premium pricing but higher air or controlled cold-chain costs and stricter shelf-life management.</li>
        </ul>
        <p>Technology trends and innovation opportunities</p>
        <ul>
            <li>Greenhouse and controlled environment agriculture continue to expand in the Netherlands and Canada; post-harvest innovations include recyclable packaging, shelf-life coatings, and digital traceability. Source context: OECD agricultural innovation notes and EU research programs, 2023-2024.</li>
        </ul>
        <p>Risk Assessment</p>
        <ul>
            <li>Compliance risk: MRL non-compliance and traceability gaps can lead to rapid market loss. Mitigation: HACCP, accredited labs, pre-shipment testing against EU MRLs.</li>
            <li>Logistics risk: Temperature abuse and transit delays reduce quality and price realization. Mitigation: Verified cold chain providers and data loggers in shipments.</li>
            <li>Currency risk: EUR exposure for EU sales and USD-pegged pricing in GCC. Mitigation: Short payment terms and partial hedging via currency clauses.</li>
            <li>Market access risk: Retail delisting or distributor concentration increases bargaining power of buyers. Mitigation: Multi-channel approach anchored in wholesale and specialty retail.</li>
        </ul>
        <p>Budget Allocation Recommendations</p>
        <p>Given a total budget of 10,000, prioritize low fixed-cost, high-contact activities.</p>
        <br>
        <table>
            <tr>
                <td>Budget Line</td>
                <td>Allocation EUR</td>
                <td>Rationale</td>
            </tr>
            <tr>
                <th>-------------</th>
                <th>----------------</th>
                <th>-----------</th>
            </tr>
            <tr>
                <td>Compliance documentation and testing</td>
                <td>2,000-2,500</td>
                <td>Pre-shipment pesticide residue tests, labeling, packhouse audits</td>
            </tr>
            <tr>
                <td>Buyer discovery and lead generation</td>
                <td>1,500-2,000</td>
                <td>B2B platforms, targeted outreach in DE, NL, UK, UAE</td>
            </tr>
            <tr>
                <td>Samples and pilot shipments</td>
                <td>3,000-3,500</td>
                <td>Consolidated pallets via NL or ES for EU and 1 micro-pilot to UAE</td>
            </tr>
            <tr>
                <td>Marketing assets</td>
                <td>800-1,200</td>
                <td>One-page spec sheets, certifications, product photography</td>
            </tr>
            <tr>
                <td>Travel or micro-fair presence</td>
                <td>1,000-1,500</td>
                <td>Day-pass presence at EU wholesale hubs or regional fairs</td>
            </tr>
            <tr>
                <td>Contingency</td>
                <td>500-800</td>
                <td>Buffer for unexpected compliance or logistics costs</td>
            </tr>
        </table>
        <p>Strategic Recommendations</p>
        <ul>
            <li>Focus markets for Year 1: Germany and Netherlands for EU due to import reliance and logistics efficiency; UK for selective opportunities via established importers; UAE as a non-EU pilot based on high import dependence.</li>
            <li>Product strategy: Lead with consistent, premium small tomatoes or vine-ripened SKUs, with optional organic if certification exists. Align to EU marketing standards classes and provide full spec sheets including variety, size, brix, pack types, and MRL test results.</li>
            <li>Route-to-market: Use Dutch consolidators and wholesale markets for initial access and re-export options; approach German importers supplying both retail and foodservice; pilot UAE through a reputable consolidator with firm pre-commitments.</li>
            <li>Compliance and quality: Implement HACCP, maintain lot-level traceability, and conduct pre-shipment MRL testing against EU limits. Prepare full documentation sets for EU and target non-EU markets.</li>
            <li>Seasonality positioning: Target supply windows where local EU production is lower, improving price realization and acceptance for imported volumes.</li>
            <li>Cash terms and risk: Negotiate deposits or short payment terms with new buyers; consider factoring arrangements through trade finance partners if needed.</li>
            <li>Scale prudently: Limit SKUs to two or three, build repeat orders with 3 to 5 anchor buyers, then expand.</li>
        </ul>
        <p>Implementation Plan</p>
        <p>90-day action plan aligned to 10,000 budget and small enterprise capacity.</p>
        <br>
        <table>
            <tr>
                <td>Timeframe</td>
                <td>Key Actions</td>
                <td>Owner</td>
                <td>Success Metrics</td>
            </tr>
            <tr>
                <th>-----------</th>
                <th>-------------</th>
                <th>-------</th>
                <th>-----------------</th>
            </tr>
            <tr>
                <td>Days 1-15</td>
                <td>Finalize product specs, packaging, certificates; set up HACCP and traceability documentation; identify accredited lab for MRL testing</td>
                <td>Operations Lead</td>
                <td>Complete spec sheets; lab contract signed</td>
            </tr>
            <tr>
                <td>Days 1-30</td>
                <td>Build buyer list in DE, NL, UK, UAE via wholesale directories, chambers, and B2B platforms; prepare outreach assets</td>
                <td>Commercial Lead</td>
                <td>60+ qualified leads; outreach kit ready</td>
            </tr>
            <tr>
                <td>Days 16-45</td>
                <td>Conduct residue and quality tests on first lots; negotiate logistics with Dutch or Spanish consolidators; secure pilot commitments</td>
                <td>Ops + Sales</td>
                <td>Passed lab results; 2-3 pilot POs secured</td>
            </tr>
            <tr>
                <td>Days 31-60</td>
                <td>Execute first EU pilot shipments to NL hub; redistribute to German buyers; monitor quality via data loggers</td>
                <td>Ops</td>
                <td>OTIF 95% on pilots; temperature compliance logs</td>
            </tr>
            <tr>
                <td>Days 46-75</td>
                <td>Launch UK and UAE micro-pilots through established importers; evaluate landed cost and price realization</td>
                <td>Sales</td>
                <td>1 UK and 1 UAE shipment completed</td>
            </tr>
            <tr>
                <td>Days 61-90</td>
                <td>Buyer follow-ups, secure repeat orders; refine pricing and packaging; update compliance and QA SOPs</td>
                <td>Leadership</td>
                <td>3-5 recurring buyers; 20-30 percent repeat rate target</td>
            </tr>
        </table>
        <p>Sources &amp; References</p>
        <ul>
            <li>European Commission, General Food Law Regulation EC 178/2002. Consolidated regulatory framework for food safety and traceability. Accessed 2024.</li>
            <li>European Commission, Regulation EC 396/2005 on maximum residue levels of pesticides. MRL database. Updated 2024.</li>
            <li>European Commission, Regulation EU 2016/2031 on protective measures against pests of plants. Last updates 2023-2024.</li>
            <li>European Commission, Implementing Regulation EU 543/2011 regarding marketing standards for fresh fruit and vegetables. Accessed 2024.</li>
            <li>European Commission, Regulation EU 1169/2011 on the provision of food information to consumers. Accessed 2024.</li>
            <li>European Commission, Regulation EU 2018/848 on organic production and labeling. Accessed 2024.</li>
            <li>Eurostat, Agricultural production and trade in the EU, Fruit and vegetables statistics. Latest releases 2023-2024.</li>
            <li>UN Comtrade Database, Trade statistics for tomatoes and prepared or preserved tomatoes, reporter and partner countries. Data years 2023-2024.</li>
            <li>OECD, Retail market structures and competition policy notes for EU grocery sectors. Publications 2023-2024.</li>
            <li>UK Government, DEFRA and Border Target Operating Model guidance for plant products, IPAFFS notifications. 2023-2024.</li>
            <li>Canadian Food Inspection Agency, Safe Food for Canadians Regulations guidance for importers. 2023-2024.</li>
            <li>Singapore Food Agency, Import requirements for fruits and vegetables. 2024.</li>
            <li>Hong Kong Centre for Food Safety, Import control of fresh produce. 2024.</li>
            <li>WTO Trade Profiles, selected country profiles for agricultural trade dependencies. 2023-2024.</li>
        </ul>
        <p>Data limitations and transparency note</p>
        <ul>
            <li>Precise retail market values by country for tomatoes are not published in a consolidated manner by the listed official sources. TAM, SAM, SOM values are provided as directional estimates with conservative ranges to support decision-making, not as definitive market sizes.</li>
            <li>Brand-level competitive shares are not available in official public databases; competitive insights are structural and channel-based.</li>
            <li>Where regulation is cited, verify the latest consolidated versions and any 2025 updates before shipments.</li>
        </ul>
        <div class="footer">
            <p>This report was generated using AI-powered market research technology.</p>
            <p>For questions or additional analysis, please contact your research team.</p>
        </div>
    </div>
    
    <script>
        // Define the function immediately when script loads
        function downloadPDF() {
            const element = document.getElementById('report-content');
            
            // Show loading state
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '⏳ Generating PDF...';
            btn.disabled = true;
           
           // Wait for fonts and images to load
           setTimeout(function() {
               // First, ensure the element is visible and has content
               if (!element || element.offsetHeight === 0 || element.offsetWidth === 0) {
                   alert('Report content not found. Please refresh the page and try again.');
                   btn.innerHTML = originalText;
                   btn.disabled = false;
                   return;
               }
               
               // Ensure the element is visible and has content
               const rect = element.getBoundingClientRect();
               if (rect.width === 0 || rect.height === 0) {
                   alert('Report content is not visible. Please scroll to the report and try again.');
                   btn.innerHTML = originalText;
                   btn.disabled = false;
                   return;
               }
               
               // Force a reflow to ensure content is rendered
               element.style.display = 'none';
               element.offsetHeight; // Trigger reflow
               element.style.display = 'block';
               
               // Ensure all content is visible and expanded
               element.style.height = 'auto';
               element.style.minHeight = '100vh';
               element.style.overflow = 'visible';
               
               // Wait a bit more for any dynamic content to render
               setTimeout(function() {
               
               const opt = {
                   margin: [0.5, 0.5, 0.5, 0.5],
                   filename: 'AI_Trade_Report.pdf',
                   image: { type: 'jpeg', quality: 0.98 },
                   html2canvas: { 
                       scale: 1.2,
                       useCORS: true,
                       allowTaint: true,
                       backgroundColor: '#ffffff',
                       logging: false,
                       letterRendering: true,
                       width: element.scrollWidth,
                       height: element.scrollHeight,
                       scrollX: 0,
                       scrollY: 0,
                       windowWidth: element.scrollWidth,
                       windowHeight: element.scrollHeight
                   },
                   jsPDF: { 
                       unit: 'in', 
                       format: 'a4', 
                       orientation: 'portrait',
                       compress: true
                   },
                   pagebreak: { mode: ['css', 'legacy'] }
               };
              
              // Debug: Log element dimensions
              console.log('Element dimensions:', {
                  width: element.offsetWidth,
                  height: element.offsetHeight,
                  scrollWidth: element.scrollWidth,
                  scrollHeight: element.scrollHeight,
                  rect: element.getBoundingClientRect()
              });
              
              // Try the main PDF generation
              html2pdf().set(opt).from(element).save().then(function() {
                  btn.innerHTML = originalText;
                  btn.disabled = false;
              }).catch(function(error) {
                  console.error('PDF generation failed:', error);
                  
                  // Fallback: Try with simpler options
                  const simpleOpt = {
                      margin: 0.5,
                      filename: 'AI_Trade_Report.pdf',
                      image: { type: 'jpeg', quality: 0.8 },
                      html2canvas: { 
                          scale: 1,
                          backgroundColor: '#ffffff',
                          width: element.scrollWidth,
                          height: element.scrollHeight,
                          useCORS: true,
                          scrollX: 0,
                          scrollY: 0
                      },
                      jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
                  };
                  
                  html2pdf().set(simpleOpt).from(element).save().then(function() {
                      btn.innerHTML = originalText;
                      btn.disabled = false;
                  }).catch(function(fallbackError) {
                      console.error('Fallback PDF generation also failed:', fallbackError);
                      alert('PDF generation failed. Please use the Print button and save as PDF from your browser instead.');
                      btn.innerHTML = originalText;
                      btn.disabled = false;
                  });
              });
          }, 500);
      }, 1000);
  }
  
  // Also make it available on window object
  window.downloadPDF = downloadPDF;
  
  // Save report function
  function saveReport() {
      const btn = event.target.closest('.action-btn');
      const originalText = btn.innerHTML;
      
      // Show loading state
      btn.innerHTML = '⏳ Saving...';
      btn.disabled = true;
      
      // Get report data
      const reportTitle = document.querySelector('h1').textContent || 'AI Trade Report';
      const reportContent = document.getElementById('report-content').innerHTML;
      const currentUrl = window.location.pathname;
      const filename = currentUrl.split('/').pop();
      
      // Extract report metadata from URL or page
      const brand = document.querySelector('.summary-item:nth-child(1) .item-value')?.textContent || 'Unknown Brand';
      const product = document.querySelector('.summary-item:nth-child(2) .item-value')?.textContent || 'Unknown Product';
      const budget = document.querySelector('.summary-item:nth-child(3) .item-value')?.textContent || 'Unknown Budget';
      const enterpriseSize = document.querySelector('.summary-item:nth-child(4) .item-value')?.textContent || 'Unknown Size';
      
      // Prepare data for API
      const reportData = {
          title: reportTitle,
          brand: brand,
          product: product,
          budget: budget,
          enterprise_size: enterpriseSize,
          ai_model: 'gpt-5',
          language: 'en',
          content: reportContent,
          file_path: filename
      };
      
      // Send to database
      fetch('/save-report', {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json',
          },
          body: JSON.stringify(reportData)
      })
      .then(response => response.json())
      .then(data => {
          if (data.status === 'success') {
              btn.innerHTML = '✅ Saved!';
              btn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
              
              setTimeout(() => {
                  btn.innerHTML = originalText;
                  btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
                  btn.disabled = false;
              }, 2000);
          } else {
              throw new Error(data.message || 'Failed to save report');
          }
      })
      .catch(error => {
          console.error('Error saving report:', error);
          btn.innerHTML = '❌ Error';
          btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
          
          setTimeout(() => {
              btn.innerHTML = originalText;
              btn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
              btn.disabled = false;
          }, 3000);
      });
  }
  
  // Return to main page function
  function returnToMain() {
      if (confirm('Are you sure you want to return to the main page? Your current report will be lost.')) {
          window.location.href = '/';
      }
  }
  
  // Make functions available globally
  window.saveReport = saveReport;
  window.returnToMain = returnToMain;
 
          // Hide header when printing
  window.addEventListener('beforeprint', function() {
      const header = document.querySelector('.report-header');
      if (header) header.style.display = 'none';
  });
  
  window.addEventListener('afterprint', function() {
      const header = document.querySelector('.report-header');
      if (header) header.style.display = 'block';
  });
  
  // Ensure function is available when DOM is ready
  document.addEventListener('DOMContentLoaded', function() {
      // Function should be available now
      if (typeof downloadPDF === 'function') {
          console.log('downloadPDF function is ready');
      } else {
          console.error('downloadPDF function not properly defined');
      }
  });
  
  // Also try to make it available immediately
  if (typeof downloadPDF === 'function') {
      console.log('downloadPDF function loaded successfully');
  }
    </script>
</body>
</html>