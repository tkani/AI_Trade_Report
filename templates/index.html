<!DOCTYPE html>
<html lang="en" id="html-lang">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>AI Trade Report - Professional Market Analysis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/static/css/style.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <!-- Language Selection Modal -->
    <div id="language-modal" class="language-modal">
      <div class="language-modal-content">
        <div class="language-header">
          <h2 class="language-title">Select Language / Seleziona Lingua</h2>
          <p class="language-subtitle">
            Choose your preferred language / Scegli la tua lingua preferita
          </p>
        </div>
        <div class="language-options">
          <button class="language-btn" data-lang="en">
            <span class="flag">🇬🇧</span>
            <span class="lang-name">English</span>
            <span class="lang-desc">Professional Market Analysis</span>
          </button>
          <button class="language-btn" data-lang="it">
            <span class="flag">🇮🇹</span>
            <span class="lang-name">Italiano</span>
            <span class="lang-desc">Analisi di Mercato Professionale</span>
          </button>
        </div>
      </div>
    </div>
    <!-- Navigation Header -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container-fluid">
        <!-- Left side - Logo and Brand -->
        <div class="navbar-brand d-flex align-items-center">
          <img
            src="/static/logo_trade_on_chain.png"
            alt="AI Trade Report"
            class="brand-logo-img me-2"
            style="height: 40px; width: auto;"
          />
          <img
            src="/static/logo2.png"
            alt="AI Trade Report"
            class="brand-logo-img me-2"
            style="height: 40px; width: auto; border-radius: 9px;"
          />
          <span class="brand-text fw-bold" data-translate="brand_name"
            >AI Trade Report</span
          >
        </div>
        
        <!-- Right side - Navigation Links -->
        <div class="navbar-nav ms-auto">
          <button id="toggle-saved-reports" class="btn btn-outline-primary me-2 saved-reports-toggle">
            <i class="bi bi-folder me-1"></i>
            <span data-translate="saved_reports_nav">Saved Reports</span>
          </button>
          <a href="/profile" class="btn btn-outline-secondary me-2">
            <i class="bi bi-person me-1"></i>
            <span data-translate="profile_nav">Profile</span>
          </a>
          <a href="/logout" class="btn btn-outline-danger">
            <i class="bi bi-box-arrow-right me-1"></i>
            <span data-translate="logout_nav">Logout</span>
          </a>
        </div>
      </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
      <div class="hero-background">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
      </div>
      <div class="hero-content">
        <div class="hero-badge">
          <span class="badge-icon">🚀</span>
          <span class="badge-text" data-translate="powered_by"
            >Powered by GPT-5</span
          >
        </div>
        <h1 class="hero-title">
          <span data-translate="hero_title">Professional Market Analysis</span>
          <span class="title-highlight" data-translate="hero_subtitle"
            >in Minutes</span
          >
        </h1>
        <p class="hero-description" data-translate="hero_description">
          Generate comprehensive trade reports with AI-powered insights,
          competitive analysis, and strategic recommendations for your business
          expansion.
        </p>
        {% if user %}
        <div class="welcome-message">
          <p>
            Welcome back,
            <strong>{{ user.name }} {{ user.surname }}</strong> from
            <strong>{{ user.company_name }}</strong>!
          </p>
        </div>
        {% endif %}
      </div>
    </section>

    <!-- Main Form Section -->
    <section class="form-section">
      <div class="container">
        <div class="form-card">
          <div class="form-header">
            <h2 class="form-title" data-translate="form_title">
              Create Your Market Analysis
            </h2>
            <p class="form-subtitle" data-translate="form_subtitle">
              Enter your business details to generate a professional report
            </p>
          </div>

          <form id="report-form" class="professional-form">
            <input
              type="hidden"
              name="language"
              id="language-input"
              value="en"
            />
            <input type="hidden" name="ai_model" id="ai_model" value="gpt-5" />
            <div class="form-grid">
              <div class="form-group">
                <label class="form-label">
                  <span class="label-icon">🏢</span>
                  <span data-translate="brand_label">Brand Name</span>
                </label>
                <div class="input-wrapper">
                  <textarea
                    name="brand"
                    class="form-textarea brand-input"
                    data-placeholder-en="Enter your brand name"
                    data-placeholder-it="Inserisci il nome del tuo brand"
                    placeholder="Enter your brand name"
                    rows="2"
                    required
                  ></textarea>
                  <div class="input-focus-line"></div>
                </div>
              </div>

              <div class="form-group">
                <label class="form-label">
                  <span class="label-icon">📦</span>
                  <span data-translate="product_label">Product/Service</span>
                </label>
                <select
                  name="product"
                  id="product-select"
                  class="form-control select2-multiple"
                  data-placeholder-en="Search and select your products or services"
                  data-placeholder-it="Cerca e seleziona i tuoi prodotti o servizi"
                  multiple
                  required
                ></select>
                <div class="input-focus-line"></div>
                <div class="model-info">
                  <span class="info-icon">📦</span>
                  <span class="info-text" data-translate="product_info"
                    >Select your products or services for market analysis</span
                  >
                </div>
              </div>

              <div class="form-group">
                <label class="form-label">
                  <span class="label-icon">💰</span>
                  <span data-translate="budget_label">Investment Budget</span>
                </label>
                <input
                  type="text"
                  name="budget"
                  class="form-input"
                  data-placeholder-en="e.g., €100,000 or $50,000 (optional)"
                  data-placeholder-it="es. €100.000 o $50.000 (opzionale)"
                  placeholder="e.g., €100,000 or $50,000 (optional)"
                />
                <div class="input-focus-line"></div>
              </div>

              <div class="form-group">
                <label class="form-label">
                  <span class="label-icon">🏢</span>
                  <span data-translate="enterprise_size_label"
                    >Enterprise Size</span
                  >
                </label>
                <div class="select-wrapper">
                  <select
                    name="enterprise_size"
                    id="enterprise_size"
                    class="form-select"
                  >
                    <option
                      value=""
                      disabled
                      selected
                      data-text-en="Select enterprise size"
                      data-text-it="Seleziona dimensione azienda"
                    >
                      Select enterprise size
                    </option>
                    <option
                      value="small"
                      data-text-en="Small Enterprise"
                      data-text-it="Piccola Impresa"
                    >
                      Small Enterprise
                    </option>
                    <option
                      value="medium"
                      data-text-en="Medium Enterprise"
                      data-text-it="Media Impresa"
                    >
                      Medium Enterprise
                    </option>
                    <option
                      value="large"
                      data-text-en="Big Enterprise"
                      data-text-it="Grande Impresa"
                    >
                      Big Enterprise
                    </option>
                  </select>
                  <div class="select-arrow">▼</div>
                </div>
                <div class="model-info">
                  <span class="info-icon">📊</span>
                  <span class="info-text" data-translate="enterprise_size_info"
                    >Choose your company size for tailored analysis</span
                  >
                </div>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">
                <span class="label-icon">💡</span>
                <span data-translate="other_info_label">Other Information</span>
              </label>
              <div class="input-wrapper">
                <textarea
                  name="other_info"
                  id="other_info"
                  class="form-textarea"
                  rows="3"
                  placeholder="Enter any special questions or additional information you'd like the AI to consider in the analysis..."
                  data-translate-placeholder="other_info_placeholder"
                ></textarea>
                <div class="input-focus-line"></div>
              </div>
            </div>

            <button type="submit" class="submit-button">
              <span class="button-text" data-translate="generate_button"
                >Generate Report</span
              >
              <span class="button-icon">→</span>
              <div class="button-shine"></div>
            </button>
          </form>
        </div>
      </div>
    </section>

    <!-- Saved Reports Modal -->
    <div class="modal fade" id="savedReportsModal" tabindex="-1" aria-labelledby="savedReportsModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="savedReportsModalLabel">
              <span class="title-icon">📁</span>
              <span data-translate="saved_reports_title">Your Saved Reports</span>
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          
          <div class="modal-body">
            <!-- Reports Table with Scroll -->
            <div class="table-responsive" style="max-height: 500px; overflow-y: auto;">
              <table class="table table-hover table-striped" id="reports-table">
                <thead class="table-dark sticky-top">
                  <tr>
                    <th class="sortable" data-sort="brand" style="cursor: pointer;">
                      <span>Brand Name</span>
                      <span class="sort-indicator">↕</span>
                    </th>
                    <th class="sortable" data-sort="product" style="cursor: pointer;">
                      <span>Product Service</span>
                      <span class="sort-indicator">↕</span>
                    </th>
                    <th class="sortable" data-sort="enterprise_size" style="cursor: pointer;">
                      <span>Enterprise Size</span>
                      <span class="sort-indicator">↕</span>
                    </th>
                    <th class="sortable" data-sort="created_at" style="cursor: pointer;">
                      <span>Date</span>
                      <span class="sort-indicator">↕</span>
                    </th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="reports-table-body">
                  <!-- Reports will be loaded here dynamically -->
                </tbody>
              </table>
            </div>
            
            <!-- Pagination -->
            <nav aria-label="Reports pagination" id="pagination-container" style="display: none;">
              <ul class="pagination justify-content-center">
                <li class="page-item" id="prev-page">
                  <a class="page-link" href="#" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                  </a>
                </li>
                <div class="pagination-numbers" id="pagination-numbers"></div>
                <li class="page-item" id="next-page">
                  <a class="page-link" href="#" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                  </a>
                </li>
              </ul>
            </nav>
            
            <!-- Empty States -->
            <div id="no-reports-message" class="text-center py-5" style="display: none;">
              <div class="mb-3">
                <i class="bi bi-file-earmark-text" style="font-size: 3rem; color: #6c757d;"></i>
              </div>
              <h5 data-translate="no_reports_title">No Saved Reports Yet</h5>
              <p class="text-muted" data-translate="no_reports_description">
                Generate your first report to see it saved here for easy access.
              </p>
            </div>
            
            <div id="auth-required-message" class="text-center py-5" style="display: none;">
              <div class="mb-3">
                <i class="bi bi-lock" style="font-size: 3rem; color: #6c757d;"></i>
              </div>
              <h5>Authentication Required</h5>
              <p class="text-muted">Please log in to view your saved reports.</p>
              <a href="/login" class="btn btn-primary">Log In</a>
            </div>
            
            <div id="loading-reports" class="text-center py-5" style="display: none;">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <p class="mt-2">Loading your saved reports...</p>
            </div>
          </div>
          
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Enhanced Splash Screen -->
    <div id="splash-screen">
      <div class="loading-content">
        <div class="loading-spinner"></div>
        <h3 class="loading-title" data-translate="loading_title">
          Generating Your Report
        </h3>
        <p class="loading-description" data-translate="loading_description">
          Our AI is analyzing market data, competitive landscape, and strategic
          opportunities for your business expansion.
        </p>
        <div class="loading-steps">
          <div class="step active" data-translate="step_1">
            🔍 Market Research
          </div>
          <div class="step" data-translate="step_2">📊 Data Analysis</div>
          <div class="step" data-translate="step_3">📝 Report Generation</div>
        </div>
      </div>
    </div>
    <script src="/static/js/main.js"></script>
  </body>
</html>
